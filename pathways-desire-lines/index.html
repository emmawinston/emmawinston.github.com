<!DOCTYPE HTML>
<html>

<!-- HEADER -->

<!-- Borksy 4.4 -->
<!-- Bitsy 7.2 -->
<head>

<meta charset="UTF-8">

<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">

<title>pathways, desire lines</title>

<script type="text/bitsyGameData" id="exportedGameData">


# BITSY VERSION 7.2

! ROOM_FORMAT 1

PAL 0
NAME vintage
77,40,43
225,207,178
182,56,63
152,101,105

ROOM 0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,a,a,a,a,a,a,a,a,a,a,a,a,a,a,0
0,a,0,0,0,0,0,0,0,0,0,0,0,0,a,0
0,a,0,0,0,0,0,0,0,0,0,0,0,0,a,0
0,a,0,0,0,0,0,0,0,0,0,0,0,0,a,0
0,a,0,0,0,0,0,0,0,0,0,0,0,0,a,0
0,a,0,0,0,0,0,0,0,0,0,0,0,0,a,0
0,a,0,0,0,0,0,0,0,0,0,0,0,0,a,0
0,a,0,0,0,0,0,0,0,0,0,0,0,0,a,0
0,a,0,0,0,0,0,0,0,0,0,0,0,0,a,0
0,a,0,0,0,0,0,0,0,0,0,0,0,0,a,0
0,a,0,0,0,0,0,0,0,0,0,0,0,0,a,0
0,a,0,0,0,0,0,0,0,0,0,0,0,0,a,0
0,a,0,0,0,0,0,0,0,0,0,0,0,0,a,0
0,a,a,a,a,a,a,a,a,a,a,a,a,a,a,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME example room
PAL 0

ROOM 1
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,2,3,4,3,4,5,4,6,4,4,4,7,4,8,0
0,9,b,c,d,e,f,g,h,i,j,k,1j,p,n,0
0,o,p,q,r,s,p,t,u,v,w,x,p,1k,10,0
0,11,12,13,14,15,16,17,18,19,1a,1b,12,12,1c,0
0,1d,1e,1e,1f,1e,1e,1g,1e,1e,1e,1e,1e,1e,1h,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME myflat 0
ITM 5y 4,8
ITM 5z 8,8
ITM 60 9,8
ITM 61 10,8
EXT 11,9 1 11,9 DLG v
EXT 11,9 1 11,9
EXT 13,8 2 8,13 FX wave DLG y
EXT 6,9 1 6,9 DLG w
EXT 6,9 1 6,9
EXT 3,9 1 3,9 DLG 3w
EXT 3,9 1 3,9
PAL 0

ROOM 2
0,0,3y,3z,40,41,41,41,41,41,41,42,43,44,45,0
0,46,47,47,48,49,4a,4b,4c,4d,4e,4f,47,4g,4h,0
4i,4j,4k,47,4l,4m,12,4n,4o,4p,4q,4r,47,4s,4t,4u
4v,4w,4x,47,4y,4z,12,50,51,52,53,54,47,55,56,57
58,59,47,47,5a,p,p,p,p,p,5b,5c,47,5d,5e,5f
47,59,47,47,47,47,47,47,47,47,47,47,47,5g,5h,5f
47,5i,7g,5j,5j,5j,5j,ut,5j,uw,uv,5k,5l,5m,5n,5f
47,5o,5p,5q,7n,5s,7p,12,12,12,12,5t,5u,5v,5w,5f
47,5x,5y,5z,60,61,12,62,63,64,12,65,66,67,68,5f
47,7m,6a,6b,6c,uz,12,6d,6e,6f,12,7j,6g,6h,6i,5f
6j,vc,12,12,12,12,12,6k,6l,6m,6n,12,12,uu,7k,6p
6q,12,vb,6r,7f,7f,6s,7j,7l,ux,12,6t,6u,6v,7h,6w
6x,7h,7i,6y,6z,70,2z,uy,12,12,12,71,72,73,12,74
75,7j,12,76,77,78,12,12,12,12,12,79,7a,7b,va,7c
7d,1e,1e,1e,1e,1e,1e,1e,1e,1e,1e,1e,1e,1e,1e,7e
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME albany
PAL 0

ROOM 3
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,7q,7r,0,0,0,0,0,0,0
0,0,0,0,0,7s,0,7t,0,0,7u,0,0,0,0,0
0,0,0,0,0,7v,7w,7x,7y,7z,80,81,82,0,0,0
83,83,83,84,85,86,87,88,89,87,8a,8b,8c,83,83,83
0,0,0,0,0,0,0,8d,8e,0,0,0,0,0,0,0
0,0,0,0,0,0,0,8f,8g,0,0,0,0,0,0,0
0,0,93,8h,0,0,0,8i,8j,0,0,0,0,0,0,0
0,0,0,8k,8l,0,0,8m,8n,0,0,0,0,0,0,0
0,0,0,0,8o,0,81,8p,8q,94,0,0,0,0,0,0
0,0,0,0,8r,0,8s,8p,8p,94,0,0,0,0,0,0
0,0,0,0,8t,8u,8v,8p,8p,8w,0,0,0,0,0,0
0,0,0,0,0,8x,8y,8p,8p,8z,0,0,0,0,0,0
0,0,0,0,0,90,91,8p,8p,8g,0,0,0,0,0,0
0,0,0,0,0,0,8m,8p,8p,92,0,0,0,0,0,0
NAME sunset
EXT 7,14 3 7,14 DLG 3j
EXT 7,12 3 7,12 DLG 1d
EXT 8,12 3 8,12 DLG 1d
EXT 8,12 3 8,12
EXT 7,12 3 7,12
EXT 8,14 3 8,14 DLG 3j
EXT 7,10 c 3,5 DLG 1r
EXT 8,10 c 3,5 DLG 1r
PAL 0

ROOM 4
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,9q,9r,9r,9r,9r,9r,9r,9r,9r,9s,9r,9t,0,0
0,0,9u,9v,9w,6s,9x,9y,9z,a0,a1,a2,12,a3,0,0
0,0,9u,a4,a5,a6,a7,a8,a9,aa,ab,a2,ac,ad,0,0
0,0,9u,ae,af,a6,ag,ah,ai,aj,ak,a2,al,am,0,0
0,0,9u,an,ao,ap,aq,ar,as,at,au,a2,av,a3,0,0
0,0,aw,az,az,az,az,vx,az,az,az,b1,b2,a3,0,0
0,0,9u,12,1j,vy,b4,bs,b6,vw,1j,1j,b9,a3,0,0
0,0,9u,12,vz,1j,bb,bc,bd,1j,vv,1j,fg,bg,0,0
0,0,9u,1j,12,1j,be,bl,bj,1j,1j,12,12,a3,0,0
0,0,bm,bn,bn,bn,bn,bn,bn,bn,bn,bn,bn,bo,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME u3a
PAL 0

ROOM 5
rx,14r,14s,sl,0,ty,tz,rx,0,14x,14z,us,0,vg,153,0
0,vm,14t,14u,14v,0,14w,112,0,14y,0,150,0,0,us,0
14q,0,114,115,116,0,0,0,ty,0,0,151,117,0,118,0
119,0,11a,11b,11c,11d,0,ty,0,0,11e,0,11f,11g,0,0
0,0,11h,11i,11j,11k,11l,11m,152,0,11n,0,0,0,158,159
14p,119,14i,15h,0,11o,11p,11q,11r,11s,11t,11u,11v,11w,11x,0
0,11y,14i,11z,120,15f,121,122,123,124,125,126,127,128,129,0
14o,0,14i,14h,12a,12b,12c,12d,12e,12f,12g,12h,12i,12j,12k,0
0,12l,12m,12n,0,0,12o,12p,12q,12r,12s,12t,12u,12v,12w,0
14n,12x,12y,12z,130,131,132,0,0,133,0,0,0,134,135,0
0,137,138,139,13a,0,13b,13c,13d,13e,13f,13g,13h,13i,13j,155
13k,13l,13m,13n,13o,0,0,0,13p,13q,13r,13s,0,0,157,156
13t,13u,1j,1j,13v,13w,13x,13y,0,13z,0,15k,140,0,141,142
0,143,144,145,146,147,148,0,0,0,0,0,0,0,12a,0
0,149,0,15a,0,15b,0,14a,0,14b,15m,0,0,14k,14l,0
0,0,14c,0,13x,14d,0,0,14e,0,0,13z,0,0,14f,0
NAME titlescreen
EXT 10,12 1 2,9 FX fade_b DLG 3y
EXT 11,12 1 2,9 FX fade_b DLG 3y
EXT 11,13 1 2,9 FX fade_b DLG 3y
EXT 9,14 1 2,9 FX fade_b DLG 3y
EXT 9,12 1 2,9 FX fade_b DLG 3y
EXT 11,14 1 2,9 FX fade_b DLG 3y
EXT 10,14 1 2,9 FX fade_b DLG 3y
EXT 9,13 1 2,9 FX fade_b DLG 3y
PAL 0

ROOM 8
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,d5,0,0,0,0,0,0,0,0,d6,0,0,0,0
0,0,d7,d8,d9,da,db,dc,dd,de,df,dg,0,0,0,0
0,0,0,dh,di,dj,dk,dl,dm,dn,do,dg,dp,dq,0,0
0,0,0,dr,ds,dt,du,dv,dw,dx,dy,dg,dz,e0,0,0
0,0,0,e1,e2,e3,e4,e5,e6,e7,e8,dg,e9,0,0,0
0,0,ea,eb,ec,ed,ee,ef,eg,ee,eh,ei,ej,94,0,0
0,0,94,ek,el,em,en,wb,we,eo,wc,eq,er,94,0,0
0,0,94,0,es,wa,et,eu,ev,ew,0,wd,ey,ez,0,0
0,0,94,0,f0,f1,f2,f2,f2,f2,f2,f2,f3,94,0,0
0,0,94,94,94,94,94,94,94,94,94,94,94,94,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME lgbtq
PAL 0

ROOM 9
1j,1j,1j,1j,1j,1j,1j,1j,1j,1j,1j,1j,1j,1j,1j,1j
1j,1j,1j,1j,1j,1j,1j,1j,1j,1j,1j,1j,1j,1j,1j,1j
1j,kw,n7,n7,n7,n7,n7,n7,n7,n7,n7,n7,n8,n9,na,1j
1j,bi,1j,1j,1j,nb,nc,nd,ne,nf,ng,1j,nh,ni,nj,1j
1j,nk,fi,fi,fi,nl,nm,nn,no,np,nq,fi,nr,ns,nt,1j
1j,nu,nv,nw,nx,ny,nz,o0,o1,o2,o3,o4,o5,o6,o7,1j
1j,o8,o9,oa,ob,oc,od,oe,of,og,oh,oi,oj,ok,ol,1j
1j,om,on,oo,op,oq,or,os,ot,ou,ov,ow,ox,oy,oz,1j
1j,rc,p0,p1,0,p3,p4,p5,p6,p7,p8,p9,pa,pb,pc,1j
1j,rc,pd,pe,pf,pg,ph,pi,pj,pk,pl,pm,ms,mt,mu,1j
1j,rc,94,pn,po,pp,94,94,pq,pr,ps,pt,pu,pv,lq,1j
1j,rc,0,0,0,0,0,0,pw,px,py,pz,q0,q1,q2,1j
1j,rc,ra,q3,94,94,q4,q5,ra,ra,ra,q6,q7,q8,q9,1j
1j,qa,qb,qc,qd,qe,qf,qg,qh,qi,qj,qk,ql,qm,l6,1j
1j,qn,qo,qp,qq,qr,qs,qt,qu,qv,1j,qw,qx,qy,qz,1j
1j,mv,r0,r1,r2,jc,r3,r4,n1,r5,r6,r7,r8,r9,lq,1j
NAME newsflash
EXT 8,11 a 2,3 FX tunnel DLG 3n
PAL 0

ROOM a
wj,wh,wl,wg,wh,wl,wj,wk,wi,wl,wg,wh,wl,wi,wg,wh
p2,rf,rf,rf,rf,rf,rf,rg,rh,rf,rf,rf,rf,rf,rf,ri
rj,rk,rl,rm,rn,ro,rp,rq,rr,rs,rs,rs,rs,rs,rt,ru
rj,rv,rw,cp,cp,cp,ry,cp,cp,rz,cp,cp,cp,s0,s1,ru
rj,s2,bi,s3,s4,1j,a6,s5,s6,2p,s7,s8,s9,mu,sa,ru
rj,s2,sb,sc,sd,se,a6,sf,sg,2p,sh,si,sj,sk,sa,ru
rj,s2,1i,sm,sn,109,so,sm,sn,sp,111,sr,ss,st,sa,ru
rj,s2,bi,su,sv,1j,a6,sw,sx,2p,1j,sy,sz,ca,sa,ru
rj,s2,t0,t1,t2,fi,t3,t1,t2,t4,t5,t6,t7,t8,sa,ru
rj,s2,bi,t9,ta,tb,a6,tc,td,2p,1j,uo,uq,ca,sa,ru
rj,s2,bi,tg,th,1j,ti,tj,tk,tl,1j,up,ur,ca,sa,ru
rj,to,tp,tq,tr,ts,tt,tu,tv,tw,tx,tx,tx,u0,u1,ru
u2,u3,u3,u3,u3,u4,u5,u5,u5,u5,u6,u3,u3,u3,u3,u7
wh,wj,wg,wk,wj,u8,u9,u9,u9,u9,ua,wk,wi,wh,wg,wj
wg,ub,uc,uc,uc,ud,ue,uf,uf,uf,ug,uh,uh,uh,ui,wh
wi,uj,uk,uk,uk,uk,ul,um,um,um,um,um,um,um,un,wg
NAME zoom
ITM 2x 3,4
ITM 2z 4,4
ITM 3a 7,4
ITM 3b 8,4
ITM 3f 3,5
ITM 3g 4,5
ITM 3i 7,5
ITM 3j 8,5
ITM 3q 11,6
ITM 3r 12,6
ITM 3w 11,7
ITM 3x 12,7
ITM 3y 3,8
ITM 4a 4,8
ITM 4b 10,8
ITM 4c 11,8
ITM 4d 12,8
ITM 4o 7,10
ITM 4q 9,10
ITM 4z 7,11
ITM 5a 8,11
ITM 5f 2,5
ITM 3u 7,7
ITM 3v 8,7
ITM 3n 3,6
ITM 3s 3,7
ITM 3t 4,7
ITM 5g 7,6
ITM 5h 8,6
ITM 5i 7,8
ITM 5j 8,8
ITM 4p 8,10
ITM 4i 8,9
ITM 4n 6,10
ITM 4h 7,9
ITM 3o 4,6
ITM 3 11,9
ITM 6 12,10
ITM 5 12,9
ITM 4 11,10
ITM 3h 5,5
PAL 0

ROOM b
rb,rd,re,v0,v1,v2,v3,v4,v2,v5,v2,v4,v6,v2,v7,v8
v9,w0,1j,w1,w2,w3,w4,w5,w6,w7,w8,w9,wm,1j,wn,wo
wp,wq,wr,ws,wt,wu,wv,ww,wx,wy,wz,x0,x1,x2,cf,x3
x4,x5,4a,4a,x6,x7,x8,x9,4a,xa,4a,4a,xb,4a,xc,xd
fv,xe,xf,xg,xh,xi,1j,2m,xj,xk,xl,1j,xm,1j,1j,xo
1j,1j,xp,xq,se,xr,xs,xt,xt,xt,1j,xu,xv,xw,xx,xy
be,xz,y0,y1,y2,1j,2p,y3,y3,y3,38,y4,y5,y5,y6,1j
38,1j,1j,y7,1j,y8,2p,y9,y9,ya,yb,yc,yd,yd,ye,yf
yg,yh,1r,y7,yi,1j,2p,yj,yj,yj,1j,yk,yl,yl,ym,1j
1j,fg,yn,y7,yo,yp,yq,yr,yr,yr,ys,yt,10z,10z,yu,1j
yv,1j,yw,yx,yy,ys,1j,yz,z0,fg,z1,1j,z2,1j,1j,z3
1j,1j,z4,z5,z6,z7,2p,z8,z8,z8,z9,za,zb,zb,zc,zd
f8,ze,zf,zg,zh,zi,zj,zk,y9,y9,1j,yc,zl,zm,zn,1j
1j,zo,zp,zq,zr,zs,zt,yj,yj,yj,yg,yk,yl,zu,zv,zw
y2,zx,zy,zz,100,101,2p,y3,y3,y3,1j,102,y5,y5,y6,1j
103,1j,zd,zd,1j,104,105,1j,106,1j,107,1j,38,108,yp,106
NAME chords
ITM 5m 8,4
ITM 5n 12,4
ITM 5q 7,10
ITM 5r 8,10
ITM 5s 12,10
PAL 0

ROOM c
10t,10r,10s,10r,10s,10t,10v,10r,10t,10s,10v,10v,10t,10v,10r,10s
p2,rf,rf,rf,rf,rf,rf,rg,rh,rf,rf,rf,rf,rf,rf,ri
rj,rk,rl,rm,rn,ro,rp,rq,rr,rs,rs,rs,rs,rs,rt,ru
rj,rv,109,109,109,109,109,109,109,109,109,109,109,109,s1,ru
rj,s2,1j,1j,10b,10c,10d,10e,10f,10g,10h,10f,a6,1j,sa,ru
rj,s2,1j,1j,10k,10n,10q,10l,v2,10p,10q,v2,a6,1j,sa,ru
rj,s2,1j,1j,10k,10o,10q,10l,v2,10n,10q,v2,a6,1j,sa,ru
rj,s2,1j,1j,10k,10n,10q,10l,v2,10p,10q,v2,a6,1j,sa,ru
rj,s2,1j,1j,10k,10p,10q,10l,v2,10o,10q,v2,a6,1j,sa,ru
rj,s2,1j,1j,10k,10o,10q,10l,v2,10n,10q,v2,a6,1j,sa,ru
rj,s2,1j,1j,1j,1j,1j,1j,1j,1j,1j,1j,1j,1j,sa,ru
rj,to,110,110,110,110,110,110,110,110,110,110,110,110,u1,ru
u2,u3,u3,u3,u3,u4,u5,u5,u5,u5,u6,u3,u3,u3,u3,u7
10t,10r,10s,10r,10v,u8,u9,u9,u9,u9,10u,10r,10t,10s,10r,10s
10s,ub,uc,uc,uc,ud,ue,uf,uf,uf,ug,uh,uh,uh,ui,10r
10r,uj,uk,uk,uk,uk,ul,um,um,um,um,um,um,um,un,10v
NAME surveyno
ITM 5t 6,7
ITM 5t 6,8
ITM 5t 6,9
ITM 5t 6,5
ITM 5t 6,6
PAL 0

ROOM d
10t,10r,10s,10r,10s,10t,10v,10r,10t,10s,10v,10v,10t,10v,10r,10s
p2,rf,rf,rf,rf,rf,rf,rg,rh,rf,rf,rf,rf,rf,rf,ri
rj,rk,rl,rm,rn,ro,rp,rq,rr,rs,rs,rs,rs,rs,rt,ru
rj,rv,109,109,109,109,109,109,109,109,109,109,109,109,s1,ru
rj,s2,1j,1j,10b,10c,10d,10e,10f,10g,10h,10f,a6,1j,sa,ru
rj,s2,1j,1j,10k,10n,10q,10l,v2,10p,10q,v2,a6,1j,sa,ru
rj,s2,1j,1j,10k,10o,10q,10l,v2,10n,10q,v2,a6,1j,sa,ru
rj,s2,1j,1j,10k,10n,10q,10l,v2,10p,10q,v2,a6,1j,sa,ru
rj,s2,1j,1j,10k,10p,10q,10l,v2,10o,10q,v2,a6,1j,sa,ru
rj,s2,1j,1j,10k,10o,10q,10l,v2,10n,10q,v2,a6,1j,sa,ru
rj,s2,1j,1j,1j,1j,1j,1j,1j,1j,1j,1j,1j,1j,sa,ru
rj,to,110,110,110,110,110,110,110,110,110,110,110,110,u1,ru
u2,u3,u3,u3,u3,u4,u5,u5,u5,u5,u6,u3,u3,u3,u3,u7
10t,10r,10s,10r,10v,u8,u9,u9,u9,u9,10u,10r,10t,10s,10r,10s
10s,ub,uc,uc,uc,ud,ue,uf,uf,uf,ug,uh,uh,uh,ui,10r
10r,uj,uk,uk,uk,uk,ul,um,um,um,um,um,um,um,un,10v
NAME surveyyes
ITM 5v 10,5
ITM 5v 10,6
ITM 5v 10,7
ITM 5v 10,8
ITM 5v 10,9
PAL 0

ROOM e
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,2,3,4,3,4,5,4,6,4,4,4,7,4,8,0
0,9,b,c,d,e,f,g,h,i,j,k,1j,p,n,0
0,o,p,q,r,s,p,t,u,v,w,x,p,10x,10,0
0,11,12,13,14,15,16,17,18,19,1a,1b,12,12,1c,0
0,1d,1e,1e,1f,1e,1e,1g,1e,1e,1e,1e,1e,1e,1h,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME myflat 1
ITM 5w 4,8
PAL 0

ROOM f
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,10y,10y,10y,10y,10y,10y,10y,10y,10y,10y,10y,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,0,10y,0,0,0,0,10y,0,0,10y,0,0
0,0,10y,0,0,10y,0,0,0,0,10y,0,0,10y,0,0
0,0,10y,0,0,10y,0,0,0,0,10y,0,0,10y,0,0
0,0,10y,0,0,10y,0,0,0,0,10y,0,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,10y,10y,10y,10y,10y,10y,10y,10y,10y,10y,10y,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME space
EXT 7,12 g 8,13 FX fade_b DLG 3p
EXT 8,12 g 8,13 FX fade_b DLG 3p
EXT 9,12 g 8,13 FX fade_b DLG 3p
EXT 9,13 g 8,13 FX fade_b DLG 3p
EXT 7,14 g 8,13 FX fade_b DLG 3p
EXT 8,14 g 8,13 FX fade_b DLG 3p
EXT 9,14 g 8,13 FX fade_b DLG 3p
EXT 7,13 g 8,13 FX fade_b DLG 3p
PAL 0

ROOM g
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,10y,10y,0,10y,10y,10y,10y,10y,10y,10y,10y,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,0,10y,0,0,0,0,10y,0,0,10y,0,0
0,0,10y,0,0,10y,0,0,0,0,10y,0,0,10y,0,0
0,0,10y,0,0,10y,0,0,10y,0,10y,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,10y,0,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,10y,10y,10y,10y,10y,10y,10y,10y,10y,10y,10y,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME space1
EXT 7,12 h 8,13 FX fade_b
EXT 8,12 h 8,13 FX fade_b
EXT 9,12 h 8,13 FX fade_b
EXT 9,13 h 8,13 FX fade_b
EXT 7,14 h 8,13 FX fade_b
EXT 8,14 h 8,13 FX fade_b
EXT 9,14 h 8,13 FX fade_b
EXT 7,13 h 8,13 FX fade_b
PAL 0

ROOM h
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,10y,10y,0,10y,10y,10y,10y,10y,10y,10y,10y,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,0,10y,0,0,0,0,0,10y,0,10y,0,0
0,0,10y,0,0,10y,0,0,10y,0,10y,0,0,10y,0,0
0,0,10y,0,0,10y,0,0,10y,0,10y,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,10y,0,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,10y,10y,10y,10y,10y,10y,10y,10y,10y,10y,10y,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME space2
EXT 7,12 i 8,13 FX fade_b
EXT 8,12 i 8,13 FX fade_b
EXT 9,12 i 8,13 FX fade_b
EXT 9,13 i 8,13 FX fade_b
EXT 7,14 i 8,13 FX fade_b
EXT 8,14 i 8,13 FX fade_b
EXT 9,14 i 8,13 FX fade_b
EXT 7,13 i 8,13 FX fade_b
PAL 0

ROOM i
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,10y,10y,0,10y,10y,10y,10y,10y,10y,10y,10y,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,0,10y,0,0,0,0,0,10y,0,10y,0,0
0,0,10y,0,0,10y,0,0,10y,0,10y,0,0,10y,0,0
0,0,10y,0,0,10y,0,10y,10y,0,10y,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,10y,0,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,10y,10y,0,10y,10y,10y,10y,10y,10y,10y,10y,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME space3
EXT 7,12 j 8,13 FX fade_b
EXT 8,12 j 8,13 FX fade_b
EXT 9,12 j 8,13 FX fade_b
EXT 9,13 j 8,13 FX fade_b
EXT 7,14 j 8,13 FX fade_b
EXT 8,14 j 8,13 FX fade_b
EXT 9,14 j 8,13 FX fade_b
EXT 7,13 j 8,13 FX fade_b
PAL 0

ROOM j
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,10y,10y,0,10y,10y,10y,10y,10y,10y,0,10y,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,0,10y,0,0,0,0,0,10y,0,10y,0,0
0,0,10y,0,0,10y,0,10y,10y,0,10y,0,0,10y,0,0
0,0,10y,0,0,10y,0,10y,10y,0,10y,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,10y,0,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,10y,10y,0,10y,10y,10y,10y,10y,10y,10y,10y,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME space4
EXT 7,12 k 8,13 FX fade_b DLG 3q
EXT 8,12 k 8,13 FX fade_b DLG 3q
EXT 9,12 k 8,13 FX fade_b DLG 3q
EXT 9,13 k 8,13 FX fade_b DLG 3q
EXT 7,14 k 8,13 FX fade_b DLG 3q
EXT 8,14 k 8,13 FX fade_b DLG 3q
EXT 9,14 k 8,13 FX fade_b DLG 3q
EXT 7,13 k 8,13 FX fade_b DLG 3q
PAL 0

ROOM k
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,10y,10y,0,10y,10y,10y,10y,10y,10y,0,10y,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,0,10y,0,0,0,0,0,10y,0,10y,0,0
0,0,10y,0,0,10y,0,10y,10y,0,10y,0,0,10y,0,0
0,0,0,0,0,10y,0,10y,10y,0,10y,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,10y,0,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,0,0,0,0,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,10y,10y,0,10y,10y,10y,10y,10y,10y,10y,10y,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME space5
EXT 7,12 l 8,13 FX fade_b
EXT 8,12 l 8,13 FX fade_b
EXT 9,12 l 8,13 FX fade_b
EXT 9,13 l 8,13 FX fade_b
EXT 7,14 l 8,13 FX fade_b
EXT 8,14 l 8,13 FX fade_b
EXT 9,14 l 8,13 FX fade_b
EXT 7,13 l 8,13 FX fade_b
PAL 0

ROOM l
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,10y,10y,0,10y,10y,10y,10y,0,10y,0,10y,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,10y,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,0,10y,0,0,0,0,0,10y,0,10y,0,0
0,0,10y,0,0,10y,0,10y,10y,0,10y,0,0,10y,0,0
0,0,0,0,0,10y,0,10y,10y,0,10y,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,10y,0,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,0,0,0,0,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,10y,10y,0,10y,10y,10y,10y,10y,10y,10y,10y,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME space6
EXT 7,12 m 8,13 FX fade_b
EXT 8,12 m 8,13 FX fade_b
EXT 9,12 m 8,13 FX fade_b
EXT 9,13 m 8,13 FX fade_b
EXT 7,14 m 8,13 FX fade_b
EXT 8,14 m 8,13 FX fade_b
EXT 9,14 m 8,13 FX fade_b
EXT 7,13 m 8,13 FX fade_b
PAL 0

ROOM m
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,10y,10y,0,10y,10y,10y,10y,0,10y,0,10y,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,10y,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,0,10y,0,0,0,0,0,10y,0,10y,0,0
0,0,10y,0,0,10y,0,10y,10y,0,10y,0,0,10y,0,0
0,0,0,0,0,10y,0,10y,10y,0,10y,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,10y,0,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,0,10y,0,0,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,10y,10y,0,10y,10y,10y,10y,10y,10y,10y,10y,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME space7
EXT 7,12 n 8,13 FX fade_b
EXT 8,12 n 8,13 FX fade_b
EXT 9,12 n 8,13 FX fade_b
EXT 9,13 n 8,13 FX fade_b
EXT 7,14 n 8,13 FX fade_b
EXT 8,14 n 8,13 FX fade_b
EXT 9,14 n 8,13 FX fade_b
EXT 7,13 n 8,13 FX fade_b
PAL 0

ROOM n
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,10y,10y,0,10y,10y,10y,10y,0,10y,0,10y,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,0,10y,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,0,10y,0,0,0,0,0,10y,0,10y,0,0
0,0,10y,0,0,10y,0,10y,10y,0,10y,0,0,10y,0,0
0,0,0,0,0,10y,0,10y,10y,0,10y,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,10y,0,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,0,10y,0,0,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,10y,10y,0,10y,10y,10y,10y,10y,10y,10y,10y,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME space8
EXT 7,12 o 8,13 FX fade_b DLG 3r
EXT 8,12 o 8,13 FX fade_b DLG 3r
EXT 9,12 o 8,13 FX fade_b DLG 3r
EXT 9,13 o 8,13 FX fade_b DLG 3r
EXT 7,14 o 8,13 FX fade_b DLG 3r
EXT 8,14 o 8,13 FX fade_b DLG 3r
EXT 9,14 o 8,13 FX fade_b DLG 3r
EXT 7,13 o 8,13 FX fade_b DLG 3r
PAL 0

ROOM o
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,10y,10y,0,10y,10y,10y,10y,0,10y,0,10y,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,10y,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,0,10y,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,0,10y,0,0,0,0,0,10y,0,10y,0,0
0,0,10y,0,0,10y,0,10y,10y,0,10y,0,0,10y,0,0
0,0,0,0,0,10y,0,10y,10y,0,10y,0,0,0,0,0
0,0,10y,0,10y,0,0,0,0,0,10y,0,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,0,10y,0,0,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,10y,10y,0,10y,10y,10y,10y,10y,10y,10y,10y,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME space9
EXT 7,12 p 8,13 FX fade_b
EXT 8,12 p 8,13 FX fade_b
EXT 9,12 p 8,13 FX fade_b
EXT 9,13 p 8,13 FX fade_b
EXT 7,14 p 8,13 FX fade_b
EXT 8,14 p 8,13 FX fade_b
EXT 9,14 p 8,13 FX fade_b
EXT 7,13 p 8,13 FX fade_b
PAL 0

ROOM p
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,10y,10y,0,10y,10y,10y,10y,0,10y,0,10y,10y,0,0
0,0,10y,10y,0,0,0,0,0,0,0,0,10y,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,0,10y,0,10y,0,0
0,0,0,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,10y,0,10y,0,0
0,0,10y,0,0,10y,0,10y,10y,0,10y,0,0,10y,0,0
10y,0,0,0,0,10y,0,10y,10y,0,10y,0,0,0,0,0
0,0,10y,0,10y,0,0,0,0,0,10y,0,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,0,10y,0,0,0,0
0,0,10y,0,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,10y,10y,0,10y,10y,10y,10y,10y,10y,10y,10y,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME space10
EXT 7,12 q 8,13 FX fade_b
EXT 8,12 q 8,13 FX fade_b
EXT 9,12 q 8,13 FX fade_b
EXT 9,13 q 8,13 FX fade_b
EXT 7,14 q 8,13 FX fade_b
EXT 8,14 q 8,13 FX fade_b
EXT 9,14 q 8,13 FX fade_b
EXT 7,13 q 8,13 FX fade_b
PAL 0

ROOM q
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,10y,10y,0,10y,10y,10y,10y,0,10y,0,10y,10y,0,0
0,0,10y,10y,0,0,0,0,0,0,0,0,10y,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,0,10y,0,10y,0,0
0,0,0,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,10y,0,10y,0,0
0,0,10y,0,0,10y,0,10y,10y,0,10y,0,0,10y,0,0
10y,0,0,0,0,10y,0,10y,10y,0,10y,0,0,0,0,0
0,0,10y,0,10y,0,0,0,0,0,10y,0,0,10y,0,0
0,0,10y,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,0,10y,0,0,0,0
0,0,10y,10y,0,0,0,0,0,0,0,0,0,10y,0,0
0,0,10y,10y,10y,0,10y,10y,10y,0,10y,10y,10y,10y,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME space11
EXT 7,12 r 8,13 FX fade_b DLG 3s
EXT 8,12 r 8,13 FX fade_b DLG 3s
EXT 9,12 r 8,13 FX fade_b DLG 3s
EXT 9,13 r 8,13 FX fade_b DLG 3s
EXT 7,14 r 8,13 FX fade_b DLG 3s
EXT 8,14 r 8,13 FX fade_b DLG 3s
EXT 9,14 r 8,13 FX fade_b DLG 3s
EXT 7,13 r 8,13 FX fade_b DLG 3s
PAL 0

ROOM r
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,10y,10y,0,10y,10y,10y,10y,0,10y,0,10y,10y,0,0
0,0,10y,10y,0,0,0,0,0,0,0,0,10y,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,0,10y,0,10y,0,0
0,0,0,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,0,0,0,0,0,0,0,10y,0,10y,0,0
0,0,10y,0,0,10y,0,10y,10y,0,10y,0,0,10y,0,0
10y,0,0,0,0,10y,0,10y,10y,0,10y,0,0,0,0,0
0,0,10y,0,10y,0,0,0,0,0,10y,0,0,10y,0,0
0,0,0,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,0,10y,0,0,0,0
0,0,10y,10y,0,0,0,0,0,0,0,0,10y,10y,0,0
0,0,10y,10y,10y,0,10y,10y,10y,0,10y,10y,10y,10y,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME space12
EXT 7,12 s 8,13 FX fade_b
EXT 8,12 s 8,13 FX fade_b
EXT 9,12 s 8,13 FX fade_b
EXT 9,13 s 8,13 FX fade_b
EXT 7,14 s 8,13 FX fade_b
EXT 8,14 s 8,13 FX fade_b
EXT 9,14 s 8,13 FX fade_b
EXT 7,13 s 8,13 FX fade_b
PAL 0

ROOM s
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,10y,10y,0,10y,10y,10y,10y,0,10y,0,10y,10y,0,0
0,0,10y,10y,0,0,0,0,0,0,0,0,10y,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,0,10y,0,10y,0,0
0,0,0,0,0,10y,10y,10y,10y,10y,10y,0,0,0,0,0
0,0,10y,0,0,0,0,0,0,0,0,10y,0,10y,0,0
0,0,10y,0,0,10y,0,10y,10y,0,10y,0,0,10y,0,0
10y,0,0,0,0,10y,0,10y,10y,0,10y,10y,0,0,0,0
0,0,10y,0,10y,0,0,0,0,0,10y,0,0,10y,0,0
0,0,0,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,0,10y,0,0,0,0
0,0,10y,10y,0,0,0,0,0,0,0,0,10y,10y,0,0
0,0,10y,10y,10y,0,10y,10y,10y,0,10y,10y,10y,10y,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME space13
EXT 7,12 t 8,13 FX fade_b
EXT 8,12 t 8,13 FX fade_b
EXT 9,12 t 8,13 FX fade_b
EXT 9,13 t 8,13 FX fade_b
EXT 7,14 t 8,13 FX fade_b
EXT 8,14 t 8,13 FX fade_b
EXT 9,14 t 8,13 FX fade_b
EXT 7,13 t 8,13 FX fade_b
PAL 0

ROOM t
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,10y,10y,0,10y,10y,0,10y,0,10y,0,10y,10y,0,0
0,0,10y,10y,0,0,0,0,0,0,0,0,10y,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,0,10y,0,10y,0,0
0,0,0,0,0,10y,10y,10y,10y,10y,10y,0,0,0,0,0
0,0,10y,0,0,0,0,0,0,0,0,10y,0,10y,0,0
0,0,10y,0,0,10y,0,10y,10y,0,10y,0,0,10y,0,0
10y,0,0,0,10y,10y,0,10y,10y,0,10y,10y,0,0,0,0
0,0,10y,0,10y,0,0,0,0,0,10y,0,0,10y,0,0
0,0,0,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,0,10y,0,0,0,0
0,0,10y,10y,0,0,0,0,0,0,0,0,10y,10y,0,0
0,0,10y,10y,10y,0,10y,10y,10y,0,10y,10y,10y,10y,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME space14
EXT 7,12 u 8,13 FX fade_b DLG 3t
EXT 8,12 u 8,13 FX fade_b DLG 3t
EXT 9,12 u 8,13 FX fade_b DLG 3t
EXT 9,13 u 8,13 FX fade_b DLG 3t
EXT 7,14 u 8,13 FX fade_b DLG 3t
EXT 8,14 u 8,13 FX fade_b DLG 3t
EXT 9,14 u 8,13 FX fade_b DLG 3t
EXT 7,13 u 8,13 FX fade_b DLG 3t
PAL 0

ROOM u
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10y
0,0,10y,10y,0,10y,10y,0,10y,0,10y,0,10y,10y,0,0
0,0,10y,10y,0,0,0,0,0,0,0,0,10y,10y,0,0
0,0,10y,0,10y,0,0,0,10y,0,0,10y,0,10y,0,0
0,0,0,0,0,10y,0,10y,0,10y,10y,0,0,0,0,0
0,0,10y,0,0,0,0,0,0,0,0,10y,0,10y,0,0
0,0,10y,0,0,10y,0,10y,10y,0,10y,0,0,10y,0,0
10y,0,0,0,10y,10y,0,10y,10y,0,10y,10y,0,0,0,0
0,0,10y,0,10y,0,0,0,0,0,10y,0,0,10y,0,0
0,0,0,0,0,10y,10y,10y,10y,10y,10y,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,0,10y,0,0,0,0
0,0,10y,10y,0,0,0,0,0,0,0,0,10y,10y,0,0
0,0,10y,10y,10y,0,10y,10y,10y,0,10y,10y,10y,10y,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME space15
EXT 7,12 v 8,13 FX fade_b
EXT 8,12 v 8,13 FX fade_b
EXT 9,12 v 8,13 FX fade_b
EXT 9,13 v 8,13 FX fade_b
EXT 7,14 v 8,13 FX fade_b
EXT 8,14 v 8,13 FX fade_b
EXT 9,14 v 8,13 FX fade_b
EXT 7,13 v 8,13 FX fade_b
PAL 0

ROOM v
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10y
0,0,10y,10y,0,10y,10y,0,10y,0,10y,0,10y,10y,0,0
0,0,10y,10y,0,0,0,0,0,0,0,0,10y,10y,0,0
0,0,10y,0,10y,0,0,0,10y,0,0,10y,0,10y,0,0
0,0,0,0,0,10y,0,10y,0,10y,10y,0,0,0,0,0
0,0,10y,0,0,0,0,0,0,0,0,10y,0,10y,0,0
0,0,10y,0,0,10y,0,10y,10y,0,10y,0,0,10y,0,0
10y,0,0,0,10y,10y,0,10y,10y,0,10y,10y,0,0,0,0
0,0,10y,0,10y,0,0,0,0,0,10y,0,0,10y,0,0
0,0,0,0,0,10y,10y,10y,0,10y,10y,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,0,10y,0,0,0,0
0,0,10y,10y,0,0,0,0,0,0,0,0,10y,10y,0,0
0,0,10y,10y,10y,0,10y,10y,10y,0,10y,10y,10y,10y,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,10y,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME space16
EXT 7,12 w 8,13 FX fade_b DLG 3u
EXT 8,12 w 8,13 FX fade_b DLG 3u
EXT 9,12 w 8,13 FX fade_b DLG 3u
EXT 9,13 w 8,13 FX fade_b DLG 3u
EXT 7,14 w 8,13 FX fade_b DLG 3u
EXT 8,14 w 8,13 FX fade_b DLG 3u
EXT 9,14 w 8,13 FX fade_b DLG 3u
EXT 7,13 w 8,13 FX fade_b DLG 3u
PAL 0

ROOM w
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10y
0,0,10y,10y,0,10y,10y,0,10y,0,10y,0,10y,10y,0,0
0,0,10y,10y,0,0,0,0,0,0,0,0,10y,10y,0,0
0,0,10y,0,10y,0,0,0,10y,0,0,10y,0,10y,0,0
0,0,0,0,0,10y,0,10y,0,10y,10y,0,0,0,0,0
0,0,10y,0,0,0,0,0,0,0,0,10y,0,10y,0,0
0,0,10y,0,0,10y,0,10y,10y,0,10y,0,0,10y,0,0
10y,0,0,0,10y,10y,0,10y,10y,0,10y,10y,0,0,0,0
0,0,10y,0,10y,0,0,0,0,0,10y,0,0,10y,0,0
0,0,0,0,0,10y,0,10y,0,10y,10y,0,0,10y,0,0
0,0,10y,0,10y,0,0,0,0,0,0,10y,0,0,0,0
0,0,10y,10y,0,0,0,0,0,0,0,0,10y,10y,0,0
0,0,10y,10y,10y,0,10y,10y,10y,0,10y,10y,10y,10y,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,10y,0,0,0,0,0,0,0,0,0,0,0,10y,0,0
NAME space17
EXT 7,12 x 8,7 FX fade_b
EXT 8,12 x 8,7 FX fade_b
EXT 9,12 x 8,7 FX fade_b
EXT 7,14 x 8,7 FX fade_b
EXT 8,14 x 8,7 FX fade_b
EXT 9,14 x 8,7 FX fade_b
EXT 7,13 x 8,7 FX fade_b
EXT 9,13 x 8,7
PAL 0

ROOM x
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME penultimate
EXT 9,6 b 5,8 FX fade_b DLG 3v
EXT 7,6 b 5,8 FX fade_b DLG 3v
EXT 7,7 b 5,8 FX fade_b DLG 3v
EXT 7,8 b 5,8 FX fade_b DLG 3v
EXT 8,8 b 5,8 FX fade_b DLG 3v
EXT 9,8 b 5,8 FX fade_b DLG 3v
EXT 9,7 b 5,8 FX fade_b DLG 3v
EXT 8,6 b 5,8 FX fade_b
PAL 0

ROOM y
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME outro
EXT 7,11 y 8,11 FX fade_b DLG 44
EXT 9,10 y 8,11 FX fade_b DLG 44
EXT 7,10 y 8,11 FX fade_b DLG 44
EXT 8,10 y 8,11 FX fade_b DLG 44
EXT 7,12 y 8,11 FX fade_b DLG 44
EXT 8,12 y 8,11 FX fade_b DLG 44
EXT 9,12 y 8,11 FX fade_b DLG 44
EXT 9,11 y 8,11 FX fade_b DLG 44
PAL 0

TIL 1
01110000
01111000
11111000
11111000
11111000
11110000
11110000
01111100
NAME albany 1

TIL 2
00000000
00000000
01110111
01110111
01110111
01110111
01110111
01110111
NAME myflat (1,6)

TIL 3
00000000
00000000
11111111
11111111
11111111
11111111
10000000
10110110
NAME myflat (2,6)

TIL 4
00000000
00000000
11111111
11111111
11111111
11111111
11111111
11111111
NAME myflat (3,6)

TIL 5
00000000
00000000
11111111
11111111
11111111
11111111
00000001
01101101
NAME myflat (6,6)

TIL 6
00000000
00000000
11011111
11011111
10101111
01110111
00000111
11111111
NAME myflat (8,6)

TIL 7
00000000
00000000
11111011
11111011
11110101
11101110
11100000
11111111
NAME myflat (12,6)

TIL 8
00000000
00000000
11011100
11011100
11011100
11011100
11011100
11011100
NAME myflat (14,6)

TIL 9
01110111
01110111
01110111
01110111
01110111
01110111
01110111
01110111
NAME myflat (1,7)

TIL 10
11011100
11011100
11011100
11011100
11011100
11011100
11011100
00011100
NAME myflat (14,8)
WAL true

TIL 11
01110111
01101111
01101111
01101111
01011111
01011111
01011111
00111111
NAME myflat (1,9)
WAL true

TIL 12
11111111
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME myflat (2,9)
WAL false

TIL 13
11101100
11101101
11111101
11111111
11111111
11111111
11111111
11111111
NAME myflat (3,9)

TIL 14
00010111
11010111
11011111
11111111
11111111
10000000
10111111
11011111
NAME myflat (4,9)

TIL 15
11101111
10000011
11111111
11111111
11111111
00000000
11111111
11111111
NAME myflat (5,9)

TIL 16
11111111
11111111
11111111
11111111
11111111
00000000
11111111
11111111
NAME myflat (6,9)

TIL 17
11111010
11111000
11111011
11111111
11111111
00011111
11011111
11101111
NAME myflat (7,9)

TIL 18
00100010
00000000
11111110
11111111
11111111
11111111
11111111
11111111
NAME myflat (8,9)

TIL 19
10101010
10000000
10111110
11111111
11111111
11111111
11111111
11111111
NAME myflat (9,9)

TIL 20
00001111
00011111
00001111
00001111
00001111
00001111
00001111
00001111
NAME albany 15

TIL 21
11110000
11110000
11110000
11110000
11110000
11110000
11110000
11110000
NAME albany 16

TIL 22
11111110
11111110
11111100
11111101
11111001
11100010
10100000
11000100
NAME albany 17

TIL 23
01000001
01000001
10000011
10000011
00000111
00000111
00001111
00001111
NAME albany 18

TIL 24
11111110
11111110
11111110
11111100
11111000
11111001
11110000
11100000
NAME albany 19

TIL 25
01111111
11111111
11111111
11111111
11111111
11111011
11111111
11111111
NAME albany 20

TIL 26
11111110
01111110
01111110
11111110
11111110
01111100
01111110
11111110
NAME albany 21

TIL 27
00000011
00000011
00000011
00000011
00000001
00000001
00000011
00000011
NAME albany 22

TIL 28
11111100
11111100
11111100
11111100
11111100
11111100
11111100
11111100
NAME albany 23

TIL 29
11111111
11111111
11111111
11111111
11111110
11111100
11111000
11110001
NAME albany 24

TIL 30
00111111
00111111
00111111
00111111
00111111
00111111
00111111
00111111
NAME albany 51

TIL 31
11111111
11111110
11111111
11111110
11111111
11111110
11111111
11111111
NAME albany 52

TIL 32
00000001
00000111
00001111
00011111
00111111
01111111
11111111
11111111
NAME albany 53

TIL 33
11111111
11111111
11111111
11111111
11000111
11111000
11111111
11111111
NAME albany 54

TIL 34
11111111
11111111
11111111
11111111
11001111
00000011
00000001
11100000
NAME albany 55

TIL 35
11111111
11111111
11111111
11111111
11111111
11111111
11111111
11011111
NAME albany 56

TIL 36
00000001
00000001
00000000
00000001
00000001
00000000
00000000
00000001
NAME albany 57

TIL 37
11111111
11111111
11111111
11111111
01111111
11111111
11111111
11111111
NAME albany 58

TIL 38
11111111
11111111
11111111
11111111
11111111
11111101
11111111
11111111
NAME albany 59

TIL 39
11111111
11111111
11001001
11000000
11000000
11000000
11001000
11001000
NAME albany 60

TIL 40
00010101
10101010
01010101
00000000
11111111
11111111
00000000
10111111
NAME albany 87

TIL 41
01010101
10101010
01010101
00000000
11111111
11111111
00000000
11111111
NAME albany 88

TIL 42
01010000
10101010
01010101
00000000
11111111
11111111
00000000
11111100
NAME albany 89

TIL 43
00000000
00000000
01000000
00101000
01010101
00101010
01010101
10101010
NAME albany 90

TIL 44
00000000
00000000
00000000
00000000
00000000
10100000
01010100
10101010
NAME albany 91

TIL 45
00000000
00000000
00000000
00000000
00000000
00000000
00000000
10000000
NAME albany 92

TIL 46
00000001
00000010
00000001
00001010
00010001
00001010
00010001
00101010
NAME albany 93

TIL 47
01010101
10101010
01010101
10101010
01010101
10101010
01010101
10101010
NAME albany 94
WAL true

TIL 48
00111111
10111111
00111111
10111111
00111111
10111111
00111110
10111111
NAME albany 95

TIL 49
11111111
11111000
11111111
11111111
11111111
00001111
00000111
00001111
NAME albany 96

TIL 50
00000000
11111111
00001000
11111111
00000010
11111111
00001000
11111111
NAME albany 123

TIL 51
00100000
11111111
00001001
11111111
00000100
11111111
00001000
11111111
NAME albany 124

TIL 52
01000000
11111111
00000011
11111111
00010001
11111111
00100000
11111111
NAME albany 125

TIL 53
01111111
11111000
11111010
11111000
11111010
11111000
01111010
11111000
NAME albany 126

TIL 54
11111101
00001100
10101101
00001100
10101101
00001100
10101101
00001100
NAME albany 127

TIL 55
00001000
10001000
00000111
10000000
01000000
10101010
01010101
10101010
NAME albany 128

TIL 56
10001010
10000101
00001010
00000101
00001010
10010101
01001010
10010101
NAME albany 129

TIL 57
10100000
01010000
10101000
01010000
10101000
01010100
10101010
01010100
NAME albany 130
WAL true

TIL 58
01010101
00101010
01010101
10101010
01010101
10101010
01010101
10101010
NAME albany 131
WAL true

TIL 59
01010001
10101010
01010001
10101010
01010001
10101010
01010001
10101010
NAME albany 132
WAL true

TIL 60
11111111
11111111
11111111
11011111
10001111
10001111
10001111
10001111
NAME albany 159
WAL true

TIL 61
10111111
10111111
10111111
10111111
01111111
01111111
01111111
01111111
NAME albany 160
WAL false

TIL 62
11111111
11111111
11111111
11111111
11111111
11111111
11000000
11011111
NAME albany 161
WAL true

TIL 63
11000001
10000000
10010100
11000001
10000000
01000001
00000000
01111111
NAME albany 162
WAL true

TIL 64
11111111
11111111
11111111
11111111
11111111
01111111
00000001
10111101
NAME albany 163
WAL true

TIL 65
11111110
11111110
11111110
11111110
11111111
11111111
11111111
11111111
NAME albany 164
WAL false

TIL 66
10111111
10111111
10111111
10000000
00011111
00100000
00101111
00101111
NAME albany 165
WAL true

TIL 67
00011111
00011111
11111111
00000000
11111111
00000000
11111111
11111111
NAME albany 166
WAL true

TIL 68
01111010
01111001
01111010
00000001
11111000
00000101
11110100
11110101
NAME albany 167
WAL true

TIL 69
00111111
10111111
00111111
01111111
01111111
01111111
01111111
01111111
NAME albany 168
WAL false

TIL 70
11111111
11111110
11111110
11111110
11111110
00111110
10111101
00111101
NAME albany 195
WAL true

TIL 71
10111110
11011110
11011110
11011111
11011111
11011111
11011101
11011101
NAME albany 196
WAL true

TIL 72
00111111
00111111
00111111
11111111
11111111
11111111
01111111
01111111
NAME albany 197
WAL true

TIL 73
11111011
11111011
11111101
10111101
00011101
00011101
00011101
00011101
NAME albany 198
WAL true

TIL 74
11001010
11010101
11001010
11010101
11101010
11100101
11101010
11100101
NAME albany 199
WAL true

TIL 75
01010111
10100111
01001111
10101111
01001111
10101111
01001111
10101111
NAME albany 200
WAL true

TIL 76
11011111
11011111
10111111
10111111
10000000
10101111
10001111
11111111
NAME albany 201
WAL false

TIL 77
11111111
11111110
11111111
11111111
00000000
11111111
11111111
11111111
NAME albany 202
WAL false

TIL 78
01111101
00111101
11111011
11111011
00000011
11101011
11100011
11111111
NAME albany 203
WAL false

TIL 79
11101100
11101111
11101111
11100000
11101011
11100011
11111111
11111111
NAME albany 204
WAL false

TIL 80
11000000
10000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME sunset 11

TIL 81
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000001
NAME sunset 12
WAL true

TIL 82
00000000
00000000
00000000
00000000
00000000
00000000
00000000
11100000
NAME sunset 13

TIL 83
00000000
00000000
00000000
00000000
00000000
11111111
00000000
00000000
NAME sunset 14

TIL 84
00011000
00011111
00011111
00011111
00000000
11111111
00000000
00000000
NAME sunset 15

TIL 85
00000000
10000000
11111000
11111110
00000000
11111111
00000000
00000000
NAME sunset 16

TIL 86
00000011
00000111
00001111
00011111
00111111
11111111
00000000
00000000
NAME sunset 17

TIL 87
11111111
11111111
11111111
11111111
11111111
11111111
00000000
00000000
NAME sunset 18

TIL 88
11111111
11111111
11111111
11111111
11111111
11111111
00000000
00000011
NAME sunset 19

TIL 89
11111111
11111111
11111111
11111111
11111111
11111111
00000000
10000000
NAME sunset 20

TIL 90
00001000
00001010
00000000
00000000
00000001
00000001
00000001
00000000
NAME sunset 47
WAL false

TIL 91
10000000
00101110
11000000
00111011
00000000
01101110
00000000
00111011
NAME sunset 48
WAL true

TIL 92
00000000
11100000
00000000
10110000
00000000
11101000
00000000
10111000
NAME sunset 49
WAL true

TIL 93
00011000
10011000
10011000
01111100
00111110
00111101
00111100
00100100
>
00011000
01011000
10011000
01111100
00111110
00111101
00111100
00100100
NAME sunset wave

TIL 94
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
WAL true

TIL 95
00000001
00000010
10000110
11000100
11001000
10000000
10000000
00100000
NAME u3a 1

TIL 96
01111111
11111111
11111111
11111111
11111111
11111001
11111111
11111111
NAME u3a 2

TIL 97
11111110
01111110
01111100
11111100
11111110
01111100
01111110
11111110
NAME u3a 3

TIL 98
11111111
11111111
11111111
11111111
11111110
11111100
11111000
01110001
NAME u3a 4

TIL 99
11000000
11000000
11000000
01000000
11000000
11000001
11000001
11000011
NAME u3a 5

TIL 100
11111111
11111111
11111110
11111100
11111001
11000011
00011111
11111111
NAME chords (4,14)

TIL 101
10111111
00111111
01111111
11111111
11111111
11111111
11011111
11111111
NAME chords (5,14)

TIL 102
10111111
10000000
10111111
10111111
10111111
10111111
10111111
10000000
NAME chords (11,14)

TIL 103
11111111
11111111
11111111
11111110
11111111
11111111
11111111
11111111
NAME chords (0,15)

TIL 104
11111111
11111111
11111111
11110111
11101011
11110111
11111111
11111111
NAME chords (5,15)

TIL 105
11111111
11111111
11111111
11111111
11111111
11111111
11111101
11111111
>
11111111
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME chords (6,15)

TIL 106
11111111
11111111
11111111
11111111
11111111
01111111
11111111
11111111
NAME chords (8,15)

TIL 107
11111111
11111111
11111111
11101111
11111111
11111111
11111111
11111111
NAME chords (10,15)

TIL 108
11111111
11111111
11111111
11110111
11111111
11111111
11111111
11111111
NAME chords (13,15)

TIL 109
00000000
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME surveytop

TIL 110
11111111
11111111
11111111
11111111
11111111
11111111
00000000
10101010
NAME surveybottom
WAL true

TIL 111
00000000
11111111
11111111
11100001
11101101
11101101
11001001
11001001
>
00000000
11111111
11000011
11011011
11011011
10010011
10010011
11111111
NAME notes

TIL 112
00000000
00000000
00000000
00000000
00000000
00000000
10000000
00000001
>
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000001
NAME titlescreen (7,1)

TIL 113
00101000
00010000
00000000
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (9,1)

TIL 114
11100000
01000000
00000000
00000000
00000000
00000000
00000111
00011110
NAME titlescreen (2,2)

TIL 115
00000000
00000000
00000000
00000000
00000000
00000000
00000000
11100000
NAME titlescreen (3,2)

TIL 116
00000000
00000000
00000000
00000000
00000000
00000000
00001000
00001000
NAME titlescreen (4,2)

TIL 117
00000000
00000000
00000000
00000000
00000000
00001000
00000000
00000000
NAME titlescreen (12,2)

TIL 118
00000000
00000000
00000000
00000010
00000101
00000010
00000000
00000000
NAME titlescreen (14,2)

TIL 119
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
>
00000000
00000000
00000000
00000000
00000100
00000000
00000000
00000000
NAME titlescreen (0,3)

TIL 120
00000001
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (4,6)

TIL 121
110111111
00011111
00011111
00011111
00011111
00000000
00000000
00000000
NAME titlescreen (6,6)

TIL 122
11011110
11011110
11111111
11111111
11111111
00000000
00000000
00000000
NAME titlescreen (7,6)

TIL 123
11011101
11011101
11111111
11111111
11111111
00000000
00000000
00000011
NAME titlescreen (8,6)

TIL 124
11011010
11011010
11111111
11111111
11111111
00000000
00011010
11110101
NAME titlescreen (9,6)

TIL 125
01001011
11101011
11111111
111111111
11111111
00000000
10101010
01010101
NAME titlescreen (10,6)

TIL 126
01110111
01110111
11111111
11111111
11111111
00000000
10101010
01010101
NAME titlescreen (11,6)

TIL 127
11101101
00011001
11111111
11111111
11111111
00000000
10101010
01010101
NAME titlescreen (12,6)

TIL 128
11110000
11110000
11110000
11110000
11110000
00000000
11100000
00000000
NAME titlescreen (13,6)

TIL 129
00000000
00000000
00000001
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (14,6)

TIL 130
00000000
00000000
10000000
10000000
10000000
10000000
10000000
10000000
NAME titlescreen (4,9)

TIL 131
00000000
00000000
00010000
00111000
00010000
00000000
00000000
00000000
NAME titlescreen (5,9)

TIL 132
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (6,9)

TIL 133
00000000
00000000
00000000
00000000
01000000
10100000
01000000
00000000
NAME titlescreen (9,9)

TIL 134
000001110
01101111
01011111
00111111
00000000
00000000
00000000
00000000
NAME titlescreen (13,9)

TIL 135
11111000
11111100
11111110
111111111
00000000
00000000
00000000
00000000
NAME titlescreen (14,9)

TIL 136
00000000
00000000
00000000
10000000
00000000
00000000
00000000
00000000
NAME titlescreen (15,9)

TIL 137
00001111
00001111
00001111
00001111
00001111
00001111
00011111
00011111
NAME titlescreen (1,10)

TIL 138
11000000
11000000
11000000
11100000
11110000
11111111
11111111
11111111
NAME titlescreen (2,10)

TIL 139
00011111
00011111
00011111
00111111
01111111
11111111
11111111
11111111
NAME titlescreen (3,10)

TIL 140
00000000
00000000
00000000
00000000
00000000
00000000
00100000
00000000
>
00000100
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (12,12)

TIL 141
10000000
00000000
00000000
00000000
00000000
00000001
00000000
00000000
NAME titlescreen (14,12)

TIL 142
00000000
00000000
00000000
01000000
01000000
11110000
01000000
01000000
NAME titlescreen (15,12)

TIL 143
00000001
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (1,13)

TIL 144
11111111
00011111
00000000
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (2,13)

TIL 145
11111000
10000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (3,13)

TIL 146
10000000
00000000
00000000
00100000
00000000
00000000
00000000
00000000
>
10000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (4,13)

TIL 147
00000000
00000000
00000001
00000010
00000001
00000000
00000000
00000000
NAME titlescreen (5,13)

TIL 148
00000000
00000000
00000000
10000000
00000000
00000000
00000000
00000000
NAME titlescreen (6,13)

TIL 149
00010000
00111000
00010000
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (1,14)

TIL 150
00000000
00000000
00000000
00000010
00000000
00000000
00000000
00000000

TIL 151
00000000
00000000
00000000
01000000
11100000
01000000
00000000
00000000

TIL 152
10000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 153
00000000
00000000
00000000
00000000
00000000
00000100
00000000
00000000

TIL 154
11000000
10000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 155
00000000
00000000
00000000
00000000
00000000
00000000
00000000
10000000

TIL 156
01000000
10000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 157
00000001
00000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 158
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00010000

TIL 159
00000000
00000000
00000000
00001000
00000000
00000000
00000000
00000000

TIL a
11111111
10000001
10000001
10011001
10011001
10000001
10000001
11111111
NAME block

TIL b
10110110
10110110
10000000
10110110
10110110
10110110
10000000
11111111
NAME myflat (2,7)

TIL c
11111111
11111111
11111111
11111111
11111111
11111111
11100000
11101111
NAME myflat (3,7)
WAL true

TIL d
10110110
10110110
10000000
10110110
10110110
10110110
00000000
10111111
NAME myflat (4,7)
WAL true

TIL e
11111111
11111111
11111111
11111111
11111111
11111111
11111111
11101111
NAME myflat (5,7)

TIL f
01101101
01101101
00000001
01101101
01101101
01101101
00000001
11111111
NAME myflat (6,7)

TIL g
11111111
11111111
11111000
11111010
11111010
11111000
11111010
11111010
NAME myflat (7,7)
WAL true

TIL h
11111111
11111111
00000000
10100010
10101010
00000000
10010000
10010110
NAME myflat (8,7)
WAL true

TIL i
11111111
11111111
11111111
10000000
10101000
10101010
10000000
10100010
NAME myflat (9,7)
WAL true

TIL j
11111111
11111111
10000000
10101010
10101010
10000000
10001000
10001000
NAME myflat (10,7)
WAL true

TIL k
11111111
11111111
00001111
00101111
10101111
00001111
10101111
10101111
NAME myflat (11,7)
WAL true

TIL l
11111111
11111111
11111111
11111111
11111111
11111111
11111000
11111000
NAME myflat (12,7)

TIL m
11111111
11111111
11111111
11111111
11111111
11111111
00000011
00000011
NAME myflat (13,7)

TIL n
11011100
11011100
11011100
11011100
11011100
11011100
11011100
11011100
NAME myflat (14,7)
WAL true

TIL o
01110111
01110111
01110111
01110111
01110111
01110111
01110111
01110000
NAME myflat (1,8)
WAL true

TIL p
11111111
11111111
11111111
11111111
11111111
11111111
11111111
00000000
NAME myflat (2,8)
WAL true

TIL q
11101111
11101111
11100000
11000000
10111101
10000001
11101101
00000001
NAME myflat (3,8)

TIL r
10111111
10111111
00111111
00000011
11011101
11000001
11010111
11000000
NAME myflat (4,8)

TIL s
11010111
10111011
10000011
11101111
11101111
11101111
11101111
00000000
NAME myflat (5,8)
WAL true

TIL t
11111000
11111000
11111011
11111000
11111010
11111010
11111000
00000010
NAME myflat (7,8)
WAL true

TIL u
00000000
01010000
01010100
00000000
10001010
10101010
00000000
00101010
NAME myflat (8,8)

TIL v
10100010
10000000
10101010
10101010
10000000
10001110
10000000
00101000
NAME myflat (9,8)

TIL w
10101010
10000000
10010100
10010101
10000000
10111000
10000000
00100101
NAME myflat (10,8)

TIL x
10101111
00001111
00101111
10101111
00001111
01101111
00001111
01000000
NAME myflat (11,8)
WAL true

TIL y
11111000
11111000
11111000
11111000
11111011
11111011
11111011
00000011
NAME myflat (12,8)
WAL true

TIL z
00000011
00000011
00000011
00000011
00000011
11000011
11110011
11111000
NAME myflat (13,8)
WAL false

TIL 1a
10100101
10000000
10111111
11111111
11111111
11111111
11111111
11111111
NAME myflat (10,9)

TIL 1b
01001111
00001111
11101111
11111111
11111111
11111111
11111111
11111111
NAME myflat (11,9)

TIL 1c
11011100
11011100
11101100
11101100
11101100
11110100
11110100
11111000
NAME myflat (14,9)
WAL true

TIL 1d
00111111
00111111
01111111
00000000
00000000
00000000
00000000
00000000
NAME myflat (1,10)
WAL true

TIL 1e
11111111
11111111
11111111
00000000
00000000
00000000
00000000
00000000
NAME myflat (2,10)
WAL true

TIL 1f
11011111
11101111
11101111
00000000
00000000
00000000
00000000
00000000
NAME myflat (4,10)
WAL true

TIL 1g
11101111
11110111
11110111
00000000
00000000
00000000
00000000
00000000
NAME myflat (7,10)
WAL true

TIL 1h
11111000
11111000
11111100
00000000
00000000
00000000
00000000
00000000
NAME myflat (14,10)
WAL true

TIL 1j
11111111
11111111
11111111
11111111
11111111
11111111
11111111
11111111

TIL 1k
00000000
00000000
00000000
00000000
01000000
01110000
01111100
01111110
NAME door

TIL 1n
00000111
00000011
00000011
00000011
00000011
00000011
00000011
00000011
NAME albany 2

TIL 1o
11110000
11110000
11111100
11111000
11111000
11111100
11111000
11111000
NAME albany 3

TIL 1p
00001111
00001111
00001111
00001111
00001111
00001111
00001111
00001111
NAME albany 4

TIL 1q
11100000
11100000
11100000
11100000
11100000
11100000
11100000
11100000
NAME albany 5

TIL 1r
11111111
11111111
11111111
11111111
11111111
11111111
11111111
01111111
NAME albany 6

TIL 1s
00000001
00000011
10000110
11000100
11001000
10010000
10000000
00100000
NAME albany 7

TIL 1t
00000111
00001111
00001111
00011111
00111111
01111111
01111111
11111111
NAME albany 8

TIL 1u
00000000
11111101
11111111
11111111
11111111
11111111
11111111
11111111
NAME albany 9

TIL 1v
11111111
00011111
11100111
11111111
11111111
11111111
11111111
11111111
NAME albany 10

TIL 1w
11111111
11111111
11111111
11111111
11111111
11110000
11110000
11111111
NAME albany 11

TIL 1x
01111100
01111100
11111100
11111100
11111100
11111100
11111110
11111110
NAME albany 12

TIL 1y
00000011
00000011
00000011
00000011
00000011
00000011
00000011
00000011
NAME albany 13

TIL 1z
11111000
11111000
11111100
11111100
11111100
11111000
11111000
11111100
NAME albany 14

TIL 2a
11001100
10001000
10011000
00110000
01100000
01000000
11000000
10000000
NAME albany 25

TIL 2b
00011111
00011111
00111111
00111111
01111111
01111111
11111111
11111111
NAME albany 26

TIL 2c
11000000
11000000
11000000
01000000
11000000
11000001
11000011
11000011
NAME albany 27

TIL 2d
11110111
00100011
00000011
00000011
00000011
00000011
10000111
10001111
NAME albany 28

TIL 2e
01111110
01111110
11111100
01111100
01111110
01111110
01111110
01111110
NAME albany 29

TIL 2f
00000011
00000011
00000001
00000001
00000001
00000001
00000001
00000001
NAME albany 30

TIL 2g
11111100
11111100
11111100
11111110
11111110
11111100
11111110
11111110
NAME albany 31

TIL 2h
00001111
00001111
00001111
00000111
00001111
00001111
00001111
00001111
NAME albany 32

TIL 2i
11110000
11110000
11110000
11110000
11110000
11111000
11110000
11110000
NAME albany 33

TIL 2j
01110001
01000100
00000000
00000000
00000000
00000000
00100000
00000000
NAME albany 34

TIL 2k
00000001
00000011
00000011
00000111
00001111
00001111
00011111
00111111
NAME albany 35

TIL 2l
10001111
10001111
11111111
11111111
11111111
11111111
11111111
11111111
NAME albany 36

TIL 2m
10111111
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME albany 37

TIL 2n
01111110
01111111
01111111
01111110
01111110
01111110
01111110
01111110
NAME albany 38

TIL 2o
00000001
00000001
00000001
00000001
00000001
00000001
00000001
00000001
NAME albany 39

TIL 2p
11111110
11111110
11111110
11111110
11111110
11111110
11111110
11111110
NAME albany 40

TIL 2q
11110000
11110000
11110000
11111000
11111000
11111000
11110000
11110000
NAME albany 41

TIL 2r
00000000
00000000
00000100
00011000
00110000
01100000
01000000
00000000
NAME albany 42

TIL 2s
00000000
00000000
00000000
00000000
00000000
00000111
00001111
00111111
NAME albany 43

TIL 2t
01111111
01111111
01111111
01111111
11110111
11100111
11101111
11111111
NAME albany 44

TIL 2u
00111110
00111111
01111111
01111111
01111111
01111111
01111111
01111111
NAME albany 45

TIL 2v
11111110
11111110
11111110
11111110
11111110
11111110
11111110
11111111
NAME albany 46

TIL 2w
00001111
00000111
00001111
00001011
00000111
00011111
00111111
01111111
NAME albany 47

TIL 2x
11111000
01111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME albany 48

TIL 2y
00000000
00000000
11100000
11111111
11111111
11111111
11111111
11111111
NAME albany 49

TIL 2z
01111111
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME albany 50

TIL 3a
11111111
11111111
11111111
01111111
00011111
00011111
00001111
00001111
NAME albany 61

TIL 3b
11111000
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME albany 62

TIL 3c
01101111
00011111
11100000
11111000
11111110
11111110
11111111
11111111
NAME albany 63

TIL 3d
11111111
11111111
11111111
01111111
00111111
00000111
00000000
00000000
NAME albany 64

TIL 3e
00111111
00111111
00111111
00111111
00111111
00111111
00111111
00011111
NAME albany 65

TIL 3f
10000000
00000000
00000000
10000000
00000000
00000000
00000000
10000000
NAME albany 66

TIL 3g
00000011
00000111
00001111
00001111
00011111
00111111
01111111
11111111
NAME albany 67

TIL 3h
11000000
11100000
11110000
11111000
11111111
11111111
11111111
11111111
NAME albany 68

TIL 3i
00000111
00001111
00001111
00111111
11011111
11111111
11111111
11111111
NAME albany 69

TIL 3j
11111111
11111111
11111111
11111111
11111110
11111100
11111111
11111111
NAME albany 70

TIL 3k
00000000
00000000
00000000
00000000
00000000
00000000
11000000
11111000
NAME albany 71

TIL 3l
00011111
00011111
00011111
00011111
00011111
00011111
00111111
00111111
NAME albany 72

TIL 3m
10000000
10000001
00000011
10000111
10001111
10111111
00111111
01111111
NAME albany 73

TIL 3n
11011111
10011111
10011111
00011111
00001111
00000001
10000000
10000000
NAME albany 74

TIL 3o
11110000
10110000
11100000
11000000
01000001
10000001
00000011
00000011
NAME albany 75

TIL 3p
00111111
00111111
01111111
01111111
01111111
01111111
00111111
01101111
NAME albany 76

TIL 3q
11000000
11100000
11110000
11111000
11111000
11111100
11111110
11111110
NAME albany 77

TIL 3r
00000001
00000001
00000001
00000000
00000001
00000001
00000001
00000001
NAME albany 78

TIL 3s
00000000
00000000
00000000
00000000
00000001
00000001
00000011
00000111
NAME albany 79

TIL 3t
00011111
00111111
01111111
11111111
11111111
11111111
11111111
11111111
NAME albany 80

TIL 3u
00000001
10000001
10000001
10000001
10000011
10000011
10000011
00000111
NAME albany 81

TIL 3v
00001111
00011111
00111111
00111111
01111111
11111111
11111111
11111111
NAME albany 82

TIL 3w
00000111
00001111
10001110
10011100
10111110
10111110
11111110
11111110
NAME albany 83

TIL 3x
11111111
11111110
11111100
11111110
11111110
11111100
11111110
11111110
NAME albany 84

TIL 3y
00000000
00000000
00000000
00000000
00000001
00000010
00010101
10101010
NAME albany 85

TIL 3z
00000000
00000000
00000101
00101010
01010100
10101010
01010100
10101010
NAME albany 86

TIL 4a
11111111
00000000
11111111
11111111
11111111
11111111
11111111
11111111
NAME albany 97

TIL 4b
11111111
00000000
11111111
11111111
11111111
11111111
00000000
11111111
NAME albany 98

TIL 4c
11111111
00000000
11111111
11111111
11111111
11111111
00100000
11111111
NAME albany 99

TIL 4d
11111111
00000000
11111111
11111111
11111111
11111111
01000000
11111111
NAME albany 100

TIL 4e
11111111
00011111
11111111
11111111
11111111
11111111
01111000
11111010
NAME albany 101

TIL 4f
11111101
11111100
11111101
11111100
11111101
11111100
00001101
10101100
NAME albany 102

TIL 4g
01010101
10101010
01010101
10101010
01010101
10101010
01010101
10000000
NAME albany 103
WAL true

TIL 4h
01000000
10000000
01000000
10010000
01001000
10010000
01001000
00010100
NAME albany 104

TIL 4i
00000000
00000000
00000000
00000000
00000001
00000000
00000001
00000010
NAME albany 105

TIL 4j
01010000
00100000
01010000
10100001
01010001
10100000
01010000
10100000
NAME albany 106
WAL false

TIL 4k
00000001
00000000
11100001
00010000
00010001
11100000
00000001
00000000
NAME albany 107

TIL 4l
00111110
10111111
00111111
10111111
00111111
10111110
00111100
10111100
NAME albany 108

TIL 4m
00000111
00001111
00001111
00001111
00001111
00000111
00000011
00000011
NAME albany 109

TIL 4n
00001000
11111111
00000010
11111111
00001000
11111111
11111111
11111111
NAME albany 110

TIL 4o
00001001
11111111
00000100
11111111
00001000
11111111
11111111
11111111
NAME albany 111

TIL 4p
00000011
11111111
00010001
11111111
00100000
11111111
11111111
11111111
NAME albany 112

TIL 4q
11111000
11111010
11111000
11111010
01111000
11111010
11111000
11111111
NAME albany 113

TIL 4r
00001101
10101100
00001101
10101100
00001101
10101100
00001101
11111100
NAME albany 114

TIL 4s
00000000
10000111
00001000
10001000
00000111
10000000
00000000
10000111
NAME albany 115

TIL 4t
00001010
00000101
10001010
10000101
00001010
00000101
00001010
00000101
NAME albany 116

TIL 4u
00000000
00000000
00000000
00000000
10000000
01000000
10000000
01000000
NAME albany 117

TIL 4v
00000101
00000010
00000101
00001010
00010101
00001010
00010101
00101010
NAME albany 118

TIL 4w
01010000
10100001
01010001
10100000
01010000
10101000
01010001
10101010
NAME albany 119

TIL 4x
11100001
00010000
00010001
11100000
00000001
00000010
01010101
10101010
NAME albany 120

TIL 4y
00111100
10111110
00111110
10111100
00111100
10111100
00111110
10111111
NAME albany 121

TIL 4z
00000011
01100111
01100111
00000011
00000011
00000011
00000111
00001111
NAME albany 122

TIL 5a
00111111
10111111
00111111
10111111
00111111
10111111
00111111
10000000
NAME albany 133
WAL true

TIL 5b
11111010
11111000
11111111
11111111
11111111
11111111
11111111
00000000
NAME albany 134
WAL true

TIL 5c
10101101
00001100
11111101
11111100
11111101
11111100
11111101
00000000
NAME albany 135

TIL 5d
01010101
10100000
01010011
10100011
01010001
10100101
01010101
10100101
NAME albany 136
WAL true

TIL 5e
01001010
00000101
11101010
11100101
11100010
11110101
11110010
11110101
NAME albany 137
WAL true

TIL 5f
10101010
01010101
10101010
01010101
10101010
01010101
10101010
01010101
NAME albany 138
WAL true

TIL 5g
01010101
10100101
01010101
10101010
01010010
10101010
01010010
10101000
NAME albany 139
WAL true

TIL 5h
11111010
11111001
11111010
11111001
11111100
11111101
11111100
11111101
NAME albany 140
WAL true

TIL 5i
01010001
10101010
01010000
10101011
01010000
10100111
01010111
10100111
NAME albany 141
WAL false

TIL 5j
01010101
10101010
00000000
11111111
00000000
11111111
11111111
11111111
NAME albany 142
WAL true

TIL 5k
01010100
10101000
00000000
11111100
00000000
11111100
11111101
11111101
NAME albany 143
WAL true

TIL 5l
00000000
11111111
11111111
11111111
11111111
11111111
01111111
01110101
NAME albany 144
WAL true

TIL 5m
00000000
11111100
11101100
11000100
11000100
11000100
11000100
11111101
NAME albany 145
WAL true

TIL 5n
11111110
01111110
00000000
01111110
01111110
01111110
01111110
01111110
NAME albany 146
WAL true

TIL 5o
01010111
10101111
01001111
10101111
01001111
10101111
01001111
10011111
NAME albany 147
WAL true

TIL 5p
11111111
11111111
11111111
11111100
11111101
11111101
11111101
11111011
NAME albany 148
WAL true

TIL 5q
11111111
11111111
11111111
00000000
11111111
11101111
11000111
11000111
NAME albany 149
WAL true

TIL 5r
11111111
11111111
11111111
00000000
11111111
11111111
11111111
11111111
NAME albany 150
WAL true

TIL 5s
11110000
11011010
11100000
00010000
11010000
11010000
11010000
10110110
>
11110000
11111010
11000000
00010000
11010000
11010000
11010000
10101110
NAME albany 151
WAL false

TIL 5t
11111101
11111101
11111101
11111101
11111101
11111101
11111110
11111110
NAME albany 152
WAL true

TIL 5u
01110001
01110101
01110001
01111111
01111111
01111111
01111111
10111111
NAME albany 153
WAL true

TIL 5v
11110101
11100001
11100010
11100010
11100010
10111110
00011110
00011110
NAME albany 154
WAL true

TIL 5w
00000000
11110101
11110010
11110101
11110010
11110101
11110010
11111001
NAME albany 155
WAL true

TIL 5x
01011111
10011111
01011111
10011111
01011111
10111111
00111111
10111111
NAME albany 156
WAL true

TIL 5y
11111011
11111011
11111011
11111011
11110111
11110111
11110111
11110111
NAME albany 157
WAL true

TIL 5z
11000111
11000111
11111111
11111111
11111111
01011111
00011111
00011111
NAME albany 158
WAL true

TIL 6a
11101111
11101111
11100000
11101011
11100011
11111111
11111111
11111111
NAME albany 169

TIL 6b
11111111
11111111
00000000
11111111
11111111
11111111
11111111
11111111
NAME albany 170
WAL false

TIL 6c
11111110
11111110
00000000
11111010
11111000
11111111
11111111
11111111
NAME albany 171
WAL false

TIL 6d
11011111
11011101
11011100
11101101
11101100
11101111
11101111
11101111
NAME albany 172
WAL true

TIL 6e
11111111
01111111
01111111
01111111
01111110
11111100
11111100
11111100
NAME albany 173
WAL true

TIL 6f
11111101
11111101
11111101
11111101
11111110
01111110
01111110
01111110
NAME albany 174
WAL true

TIL 6g
00101111
00101111
10101111
10100000
10011111
10000000
11111111
11111111
NAME albany 175

TIL 6h
11111111
11111111
11111111
00000000
11111111
00000000
11111111
11111111
NAME albany 176

TIL 6i
11110100
11110101
11110100
00000100
11111000
00000000
11111110
11111110
NAME albany 177
WAL false

TIL 6j
01010101
10101010
01010100
10101010
01010100
10101010
01010100
10101001
NAME albany 178
WAL true

TIL 6k
11101111
11101111
11110111
11110111
11110111
11110000
11110101
11110001
NAME albany 179

TIL 6l
11111100
11111111
11111111
11111111
11111111
00000000
11111111
11111111
NAME albany 180

TIL 6m
01111110
11111110
11111111
11111111
11111111
00000000
11111101
11111100
NAME albany 181
WAL false

TIL 6n
11111111
11111111
01111111
01111111
01111111
01111111
01111111
01111111
NAME albany 182

TIL 6o
11111110
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME albany 183
WAL false

TIL 6p
10101010
01010101
00101010
01010101
00101010
01010101
00101010
10010101
NAME albany 184
WAL true

TIL 6q
01010101
10101001
01010101
10101001
01010101
10101001
01010011
10101011
NAME albany 185
WAL true

TIL 6r
11111111
11111111
11111111
11111111
11111111
11110000
11110111
11110111
NAME albany 186
WAL true

TIL 6s
11111111
11111111
11111111
11111111
11111111
01111111
01111111
01111111
NAME albany 187
WAL false

TIL 6t
11111111
11110001
11101010
11100000
10000000
10110111
10110111
10111010
NAME albany 188
WAL true

TIL 6u
11111111
11000111
10000010
10101010
00000000
10111111
01011111
00111111
>
11111111
11000111
10000001
10101010
00000000
10111111
01011111
00111111
NAME albany 189
WAL true

TIL 6v
11111111
11111111
11111111
11111111
00000011
11111011
11111011
11111011
NAME albany 190
WAL true

TIL 6w
10101010
10010101
10101010
10010101
10101010
10010101
11001010
11010101
NAME albany 191
WAL true

TIL 6x
01010011
10101011
01010011
10101011
01010111
10100111
01010111
10100111
NAME albany 192
WAL true

TIL 6y
11110111
11101111
11101111
11101111
11101111
11101111
11011111
11011111
NAME albany 193
WAL true

TIL 6z
10111111
00011111
00011111
00011111
00011111
11111110
11111110
11111110
NAME albany 194
WAL true

TIL 7a
01111111
11111111
11111111
00000000
11111111
11111111
11111111
11111111
NAME albany 205
WAL false

TIL 7b
11111110
11111110
11111110
00000000
11111010
11111000
11111111
11111111
NAME albany 206

TIL 7c
11101010
11100101
11110010
11110101
11110010
11110101
11110010
11110101
NAME albany 207
WAL true

TIL 7d
01011111
10011111
01011111
00000000
00000000
00000000
00000000
00000000
NAME albany 208

TIL 7e
11111010
11111001
11111010
00000000
00000000
00000000
00000000
00000000
NAME albany 209

TIL 7f
11111111
11111111
11111111
11111111
11111111
00000000
11111111
11111111
WAL true

TIL 7g
01000001
10000000
00101000
10000001
01000010
01000010
11000011
11011011
>
01000001
10000000
00010100
10000001
01000010
01000010
11000011
11011101
NAME wall
WAL false

TIL 7h
11000011
10010101
11000011
11000010
10000001
01000011
11000011
11011011
>
11000011
10101001
11000011
11000001
00000010
11000011
11000011
10111011
NAME sprite-rev-2

TIL 7i
11000011
10000001
10100101
10000001
11000011
10000001
01000010
11011011
>
11000011
10000001
10100101
10000001
11000011
00000000
11000011
11011101
NAME sprite-rev-1

TIL 7j
11000011
10000001
11101011
11000001
10000010
01000011
11000011
11011101
>
11000011
10101001
11000011
00000011
11000001
11000010
11000011
11011011
NAME sprite-rev-3

TIL 7k
11000010
10101001
11000011
11000011
00000001
11000010
11011011
11011011
>
11000010
10010101
11000011
11000001
00000010
11000011
11011011
11011101
NAME sprite-rev-4

TIL 7l
11000011
10100101
10000001
11000011
00000001
11000010
11011011
11011101
>
11000011
10100101
10000001
11000011
10000001
01000010
11011011
11011011
NAME sprite-rev-5

TIL 7m
00100111
01000011
01011011
01000011
00000000
01000011
01011011
01011101
>
00100111
01000011
01011011
01000011
00000001
01000010
01011011
01011011
NAME sprite-rev-6

TIL 7n
11000011
10100101
10000001
00000000
10111101
01111101
01111011
11111111
NAME u3

TIL 7p
11111111
11111111
11111111
01111111
10111111
11111111
11111111
11111111
>
11111111
11111111
11111111
01111111
10111111
11111111
11111111
11111111
NAME arm
WAL false

TIL 7q
00000000
00000000
00000111
00001111
00001111
00000111
00000111
00000111
NAME sunset 1

TIL 7r
00000000
00000000
10000000
10000000
10000000
10000000
10000000
00000000
NAME sunset 2

TIL 7s
00010000
00110000
01111000
11111000
11111100
01111100
00111100
00011110
NAME sunset 3

TIL 7t
00000111
00000011
00000011
00000011
00000001
00000001
00000000
00000000
NAME sunset 4

TIL 7u
00000000
00000000
00011000
00111100
00111110
01111100
11111000
11100000
NAME sunset 5

TIL 7v
00000110
00000011
00000001
00000000
00000000
00000000
00000000
00000001
NAME sunset 6

TIL 7w
00000000
00000000
00000000
00000001
00001111
00111111
01111111
11111111
NAME sunset 7

TIL 7x
00000000
00000000
00111111
11111111
11111111
11111111
11111111
11111111
NAME sunset 8

TIL 7y
00000000
00000000
11111000
11111111
11111111
11111111
11111111
11111111
NAME sunset 9

TIL 7z
00000001
00000001
00000010
00000000
11100000
11111000
11111100
11111111
NAME sunset 10

TIL 8a
10000000
11000000
11100000
11110000
11111000
11111111
00000000
00000000
NAME sunset 21

TIL 8b
00000111
00011111
01111111
11111000
00000000
11111111
00000000
00000000
NAME sunset 22

TIL 8c
11100000
11110000
11000000
00000000
00000000
11111111
00000000
00000000
NAME sunset 23

TIL 8d
00000000
00000110
00000000
00000011
00000000
00000110
00000000
00001011
NAME sunset 24
WAL true

TIL 8e
00000000
11000000
00000000
10000000
00000000
11000000
00000000
10000000
NAME sunset 25
WAL true

TIL 8f
00000000
00001110
00000000
00001011
00000000
00001110
00000000
00011011
NAME sunset 26
WAL true

TIL 8g
00000000
11100000
00000000
10100000
00000000
11100000
00000000
10110000
NAME sunset 27
WAL true

TIL 8h
00000000
00000000
00000000
00000000
00000000
00100000
00000000
00001000
NAME sunset 28
WAL true

TIL 8i
00000000
00001110
00000000
00111011
00000000
00101110
00000000
00111011
NAME sunset 29
WAL true

TIL 8j
00000000
11100000
00000000
10110000
00000000
11100000
00000000
10111000
NAME sunset 30
WAL true

TIL 8k
00000000
00000100
00000000
00000000
00000000
00000000
00000000
00000010
NAME sunset 31
WAL true

TIL 8l
00000000
00000000
00000000
10000000
00000000
00000000
00000000
00000000
NAME sunset 32
WAL true

TIL 8m
00000000
01101110
00000000
00111011
00000000
01101110
00000000
10111011
NAME sunset 33
WAL true

TIL 8n
00000000
11101000
00000000
10111000
00000000
11101100
00000000
10111000
NAME sunset 34
WAL true

TIL 8o
00010000
00000000
10010000
10101000
00000000
00000000
01000100
00000000
NAME sunset 35
WAL true

TIL 8p
00000000
11101110
00000000
10111011
00000000
11101110
00000000
10111011
NAME sunset 36
WAL false

TIL 8q
00000000
11101100
00000000
10111000
00000000
11101110
00000000
10111010
NAME sunset 37
WAL false

TIL 8r
00000000
00100110
00000000
00100000
00000000
00010000
00010101
00000000
NAME sunset 38
WAL true

TIL 8s
00000000
00000000
00000000
00000011
00000000
00000000
00000000
00000001
NAME sunset 39
WAL true

TIL 8t
00000100
00000000
00000100
00000110
00000101
00000001
00000000
00000000
NAME sunset 40
WAL true

TIL 8u
00000000
00000000
00000000
10000000
01000000
11000000
00010000
10100000
NAME sunset 41
WAL true

TIL 8v
00000000
00000110
00000000
00000111
00000000
00000110
00000000
00000011
NAME sunset 42
WAL true

TIL 8w
00000000
10000000
00000000
10000000
00000000
10000000
00000000
10000000
NAME sunset 43
WAL true

TIL 8x
00000000
10001000
00011000
00001110
00000000
00100010
00000010
00001010
NAME sunset 44
WAL false

TIL 8y
00000000
00000110
00000000
00001011
00000000
00011110
00000000
00111011
NAME sunset 45
WAL true

TIL 8z
00000000
11000000
00000000
10000000
00000000
11000000
00000000
10100000
NAME sunset 46
WAL true

TIL 9a
11110011
00100011
00000011
00000011
00000011
00000011
10000111
10001111
NAME u3a 6

TIL 9b
11111100
11111100
11111100
11111110
11111100
11111100
11111110
11111110
NAME u3a 7

TIL 9c
01110001
01000100
00000000
00000000
00000000
00000000
00000000
00000000
NAME u3a 8

TIL 9d
10111111
11110111
11111111
11111111
11111111
11111111
11111111
11111111
NAME u3a 9

TIL 9e
00000000
00000000
00000100
00011000
00110000
01000000
01000000
00000000
NAME u3a 10

TIL 9f
00111110
00111110
01111111
01111111
01111111
01111111
01111111
01111111
NAME u3a 11

TIL 9g
00000001
00000001
00000000
00000001
00000001
00000001
00000001
00000000
NAME u3a 12

TIL 9h
11111110
11111110
11111111
11111110
11111111
11111110
11111111
11111111
NAME u3a 13

TIL 9i
01101111
00011111
11100000
11110000
11111110
11111110
11111111
11111111
NAME u3a 14

TIL 9j
11111111
11111111
11111111
11111111
11111110
11111100
11111101
11111111
NAME u3a 15

TIL 9k
10000000
10000001
00000011
10000111
10001111
10111111
00111111
00111111
NAME u3a 16

TIL 9l
11110000
10110000
11100000
11000000
01000000
00000001
00000001
00000001
NAME u3a 17

TIL 9m
00111111
00111111
00111111
01111111
01111111
01111111
00111111
01101111
NAME u3a 18

TIL 9n
00000001
00000001
00000001
00000000
00000000
00000001
00000000
00000001
NAME u3a 19

TIL 9o
00000001
00000001
10000001
10000001
10000011
10000011
10000011
00000111
NAME u3a 20

TIL 9p
00000111
00001111
00001110
10011100
10111100
10111110
11111110
11111110
NAME u3a 21

TIL 9q
00000000
00000000
00000000
00000000
00000000
00011111
00011111
00011111
NAME u3a 22

TIL 9r
00000000
00000000
00000000
00000000
00000000
11111111
11111111
11111111
NAME u3a 23

TIL 9s
00000000
00000000
00000000
00000000
00000000
11110111
11110111
11110111
NAME u3a 24

TIL 9t
00000000
00000000
00000000
00000000
00000000
11111000
11111000
11111000
NAME u3a 25

TIL 9u
00011111
00011111
00011111
00011111
00011111
00011111
00011111
00011111
NAME u3a 26
WAL true

TIL 9v
11111111
11111111
11111111
11111111
11111111
11000000
11011111
11011111
NAME u3a 27

TIL 9w
11111111
11111111
11111111
11111111
11111111
00000000
10100011
10011101
NAME u3a 28

TIL 9x
11111111
11111111
11111111
11111111
11111111
00000000
01111110
00000110
NAME u3a 29

TIL 9y
11111111
11111111
11111111
11111111
11111111
00000001
11111101
11111101
NAME u3a 30

TIL 9z
11111111
11111111
11111111
11111111
11111111
11111100
11111101
11111101
NAME u3a 31

TIL a0
11111111
11111111
11111111
11111111
11111111
00000000
11111011
10001011
NAME u3a 32

TIL a1
11111111
11111111
11111111
11111111
11111111
00000111
11110111
00010111
NAME u3a 33

TIL a2
11110111
11110111
11110111
11110111
11110111
11110111
11110111
11110111
NAME u3a 34
WAL true

TIL a3
11111000
11111000
11111000
11111000
11111000
11111000
11111000
11111000
NAME u3a 35
WAL true

TIL a4
11010001
11001110
11011110
11011110
11001010
11010001
11011011
11000000
NAME u3a 36

TIL a5
10111101
10010101
10100011
10110111
10110111
10000001
00111110
00000000
NAME u3a 37

TIL a6
01111111
01111111
01111111
01111111
01111111
01111111
01111111
01111111
NAME u3a 38

TIL a7
01111010
01111010
01111010
01011010
01011010
00000110
01011100
00000000
NAME u3a 39

TIL a8
11010101
11101101
11111101
11111101
11100101
00011001
11111101
00000001
>
11111101
11000101
11111101
11111101
11100101
00011001
11111101
00000001
NAME u3a 40

TIL a9
11111100
11111101
11111101
11111101
11111100
11111101
11111101
11111100
NAME u3a 41

TIL aa
01110010
11111010
11111010
11011010
01010010
10001011
11011011
00000000
>
01110010
11111010
11111010
11011010
01010010
10001011
11011011
00000000
NAME u3a 42

TIL ab
11100111
11110111
11110111
10110111
10110111
00000111
10110111
00000111
NAME u3a 43

TIL ac
10011111
10100111
10111001
10110110
10101001
10101110
10101110
10101110
NAME u3a 44

TIL ad
11111000
11111000
11111000
01111000
10111000
10111000
10111000
10111000
NAME u3a 45

TIL ae
11011001
11011011
11000111
11011111
11011111
11011111
11011111
11000000
NAME u3a 46

TIL af
10111111
10111111
10111111
10111111
10111111
10111111
10111111
00000000
NAME u3a 47

TIL ag
01010110
01010110
00001110
01111110
01111110
01111110
01111110
00000000
NAME u3a 48

TIL ah
11111101
11111101
11111101
11111101
11111101
11111101
11111101
00000001
NAME u3a 49

TIL ai
11111101
11111100
11111101
11111101
11111101
11111101
11111101
11111100
NAME u3a 50

TIL aj
00011011
11100000
11111011
11111011
11111011
11111011
11111011
00000000
NAME u3a 51

TIL ak
10110111
00110111
10000111
11110111
11110111
11110111
11110111
00000111
NAME u3a 52

TIL al
10110010
11001100
11110011
11111100
11111111
11111111
11111111
11111111
NAME u3a 53

TIL am
10111000
10111000
10111000
10111000
00111000
11111000
11111000
11111000
NAME u3a 54

TIL an
11011111
11000000
11111111
11111111
11111111
11111111
11111111
11111111
NAME u3a 55
WAL true

TIL ao
10111111
00000000
11111111
11111111
11111111
11111111
11111111
11111111
NAME u3a 56
WAL true

TIL ap
01111111
01111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME u3a 57
WAL true

TIL aq
01111110
00000000
11111111
11111111
11111111
11111111
11111111
11111111
NAME u3a 58
WAL true

TIL ar
11111101
00000001
11111111
11111111
11111111
11111111
11111111
11111111
NAME u3a 59
WAL true

TIL as
11111101
11111100
11111111
11111111
11111111
11111111
11111111
11111111
NAME u3a 60
WAL true

TIL at
11111011
00000000
11111111
11111111
11111111
11111111
11111111
11111111
NAME u3a 61
WAL true

TIL au
11110111
00000111
11111111
11111111
11111111
11111111
11111111
11111111
NAME u3a 62
WAL true

TIL av
11011111
10100111
10111001
10111110
10111110
10111110
10111110
10111110
NAME u3a 63
WAL true

TIL aw
00011111
00011111
00011111
00000000
00011111
00011111
00011111
00011111
NAME u3a 64
WAL true

TIL ax
11111111
11111111
11111111
00000000
11111111
11111111
10000011
10000011
NAME u3a 65

TIL ay
11111111
10000011
10000011
00000000
10000011
10000011
10111011
10111011
NAME u3a 66

TIL az
11111111
11111111
11111111
00000000
11111111
11111111
11111111
11111111
NAME u3a 67

TIL b1
11110111
11110111
11110111
00000111
11110111
11111011
11111101
11111110
NAME u3a 69

TIL b2
10111110
10111110
10111110
10111110
10111010
10111110
10111110
10111110
NAME u3a 70

TIL b4
11111111
11111111
11111111
11111111
11111100
11110011
11101111
11011000
NAME u3a 72

TIL b5
10111011
11111111
11111111
00000000
11111111
11110001
11110101
01110001
NAME u3a 73

TIL b6
11111111
11111111
11111111
00111111
11001111
11110011
11111101
11111110
NAME u3a 74

TIL b9
00111110
10111110
11011110
11101110
11110110
11110110
11111010
11111100
NAME u3a 77

TIL bb
11011011
11011000
11011111
11100111
11110011
11110100
11110111
11110111
NAME u3a 79

TIL bc
01111111
01111110
11111110
11111111
11111111
11111111
00000000
01111111
NAME u3a 80

TIL bd
11111110
11100110
11111110
11111101
11110001
11001101
00111101
10111101
NAME u3a 81

TIL be
11110111
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME u3a 82

TIL bf
11111111
11111111
11111111
11111111
01111111
01111111
01111111
01111111
NAME u3a 83

TIL bg
11111000
01111000
10111000
11011000
11101000
11110000
11111000
11111000
NAME u3a 84
WAL true

TIL bj
10111101
10111111
10111111
11111111
11111111
11111111
11111111
11111111
NAME u3a 87

TIL bl
01111111
01111111
01111111
11111111
11111111
11111111
11111111
11111111
NAME u3a 89

TIL bm
00011111
00011111
00011111
00011111
00000000
00000000
00000000
00000000
NAME u3a 90

TIL bn
11111111
11111111
11111111
11111111
00000000
00000000
00000000
00000000
NAME u3a 91
WAL true

TIL bo
11111000
11111000
11111000
11111000
00000000
00000000
00000000
00000000
NAME u3a 92

TIL bp
10000001
10000001
10000001
10000001
10000001
10000001
10111101
10111101

TIL bs
11111111
11111111
11111111
00000000
11111111
11110001
11110101
01110001

TIL bt
10000001
10000001
10000001
00000000
10000001
10000001
10111101
10111101

TIL bv
11111111
11111111
11111111
11111111
11111000
11111011
11111010
11111010
NAME survey 1

TIL bw
11111111
11111111
11111111
11111111
00000000
11111111
00100010
10101010
NAME survey 2

TIL bx
11111111
11111111
11111111
11111111
00000000
11111111
00111111
10111101
NAME survey 3

TIL by
11111111
11111111
11111111
11111111
00000000
11111111
11111011
00001011
NAME survey 4

TIL bz
11111111
11111111
11111111
11111111
00000000
11111111
11111111
10000100
NAME survey 5

TIL c0
11111111
11111111
11111111
11111111
00000000
11111111
11111011
01011011
NAME survey 6

TIL c1
11111111
11111111
11111111
11111111
00000000
11111111
11111111
10000010
NAME survey 7

TIL c2
11111111
11111111
11111111
11111111
00000000
11111111
11111111
10000001
NAME survey 8

TIL c3
11111111
11111111
11111111
11111111
00000000
11111111
11111111
11111111
NAME survey 9

TIL c4
11111111
11111111
11111111
11111111
00011111
11011111
11011111
11011111
NAME survey 10

TIL c5
11111010
11111011
11111000
11111011
11111011
11111011
11111011
11111011
NAME survey 11

TIL c6
00100010
11111111
00000000
11111111
11111111
11111111
11111111
11111111
NAME survey 12

TIL c7
00111111
11111111
00000000
11111111
11111111
11111111
11111111
11111111
NAME survey 13

TIL c8
11111011
11111111
00000000
11111111
11111111
11111111
11111111
11111111
NAME survey 14

TIL c9
11011111
11011111
00011111
01011111
01011111
01011111
01011111
01011111
NAME survey 15

TIL ca
11111011
11111011
11111011
11111011
11111011
11111011
11111011
11111011
NAME survey 16

TIL cb
11110000
11110111
11110111
11110111
11110111
11110111
11110111
11110111
NAME survey 17

TIL cd
00001111
11101111
11101111
11101111
11101111
11101111
11101111
11101111
NAME survey 19

TIL ce
01011111
01011111
01011111
01011111
01011111
01011111
01011111
01011111
NAME survey 20

TIL cf
11101111
11101111
11101111
11101111
11101111
11101111
11101111
11101111
NAME survey 21

TIL cg
11110111
11110111
11110000
11111111
11111111
11111111
11111111
11111111
NAME survey 22

TIL ch
11101111
11101111
00001111
11111111
11111111
11111111
11111111
11111111
NAME survey 23

TIL ci
11111111
11110000
11110101
11110010
11110000
11110111
11110111
11110111
NAME survey 24

TIL cj
11111111
00000000
01010101
10101010
00000000
11111111
11111111
11111111
NAME survey 25

TIL ck
11111111
00000000
01010101
10100010
00000000
11110111
11110111
11110111
NAME survey 26

TIL cl
11111111
00000000
01010101
10001010
00000000
11011111
11011111
11011111
NAME survey 27

TIL cm
11111111
00001111
01001111
10101111
00001111
11101111
11101111
11101111
NAME survey 28

TIL cn
11111011
11111011
11111011
11111000
11111111
11111111
11111111
11111111
NAME survey 29

TIL co
11110000
11110111
11110111
00000000
11111111
11111111
11111111
11111111
NAME survey 30

TIL cp
00000000
11111111
11111111
00000000
11111111
11111111
11111111
11111111
NAME survey 31

TIL cq
00000000
11110111
11110111
00000000
11111111
11111111
11111111
11111111
NAME survey 32

TIL cr
00000000
11011111
11011111
00000000
11111111
11111111
11111111
11111111
NAME survey 33

TIL cs
00001111
11101111
11101111
00000000
11111111
11111111
11111111
11111111
NAME survey 34

TIL ct
01011111
01011111
01011111
00011111
11111111
11111111
11111111
11111111
NAME survey 35

TIL cu
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00011111

TIL cv
00011111
00000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL cw
00000000
00000000
00000000
10000000
11000000
11100000
11110000
11111100

TIL cx
11111000
11110000
11100000
11000000
10000000
00000000
00000000
00000000

TIL cy
11111111
11111000
11100000
11001000
11000100
10000000
10001000
10000000

TIL cz
11111111
00011111
00000111
00010011
00100011
00000001
00010001
00000001

TIL d0
00000001
00000001
11100001
00010011
00010011
00000111
00011111
11111111

TIL d1
10000000
10000000
10000111
11001000
11001000
11100000
11111000
11111111

TIL d4
00111110
10111110
11011110
11101110
11110110
11111010
11111100
11111110

TIL d5
00000000
00000000
00000000
00000000
00000000
00001000
00000100
00010011
NAME quke 1

TIL d6
00000000
00000000
00000000
00000000
00000000
00001000
00001000
00001000
NAME quke 2

TIL d7
00010000
00001000
00001000
00000100
00000010
00000010
00000001
00000000
NAME quke 3

TIL d8
10000000
01000000
00100000
00010000
00001100
00111111
00100001
10100000
NAME quke 4

TIL d9
00000000
00000000
00000000
00000000
00000000
11111111
01000000
11000000
NAME quke 5

TIL da
00000000
00000000
00000000
00000000
00000000
10000000
10000000
10000000
NAME quke 6

TIL db
00000000
00000000
00000000
00000000
00000000
11111111
10000001
10000001
NAME quke 7

TIL dc
00000000
00000000
00000000
00000000
00000000
11111110
00000010
00000010
NAME quke 8

TIL dd
00000000
00000000
00000000
00000000
00000000
00000011
00000010
00000010
NAME quke 9

TIL de
00000000
00000000
00000000
00000000
00000000
11111111
00000100
01000100
NAME quke 10

TIL df
00000000
00000000
00000000
00000000
00000000
11111000
00001000
00001000
NAME quke 11

TIL dg
00001000
00001000
00001000
00001000
00001000
00001000
00001000
00001000
NAME quke 12
WAL true

TIL dh
10100100
01100000
01100000
00100010
00110000
00110010
00101000
00111111
>
10100100
01100000
01100000
00101010
00110000
00110000
00101000
00111111
NAME quke 13

TIL di
01001000
01110000
01001010
01000100
01001010
01000001
01000000
11111111
NAME quke 14

TIL dj
10000000
10000000
10000000
10000000
10000000
10000000
11000000
10100000
NAME quke 15

TIL dk
10000001
10100101
10000001
10000001
10010001
10000001
10000001
11111111
NAME quke 16

TIL dl
00000010
00001010
00000010
00000010
00100010
00000010
00000010
11111110
>
00000010
00001010
00000010
00000010
00100010
00000010
00000010
11111110
NAME quke 17

TIL dm
00000010
00000010
00000010
00000010
00000010
00000010
00000010
00000011
NAME quke 18

TIL dn
11100101
01000100
00000100
00000100
01000100
00000100
00000100
11111111
NAME quke 19

TIL do
00101000
00001000
00001000
00001000
10001000
00001000
00001000
11111000
>
00001000
00001000
00001000
00101000
10001000
00001000
00001000
11111000
NAME quke 20

TIL dp
01100000
01011000
01000110
01001001
01010110
01010001
01010001
01010001
NAME quke 21

TIL dq
00000000
00000000
00000000
10000000
01000000
01000000
01000000
01000000
NAME quke 22

TIL dr
00100100
00100010
00100011
00101001
00100000
00100000
00100100
00100000
NAME quke 23

TIL ds
01000000
01000000
01010000
01000000
11000000
11000000
01000010
01100000
NAME quke 24

TIL dt
10010000
10001000
10000100
10000011
10000000
10000000
10000000
10000000
NAME quke 25

TIL du
10000001
10000001
10100001
10000001
10000101
11000001
10100001
10010001
>
10000001
10000011
10100001
10000001
10000001
11000001
10100001
10010001
NAME quke 26

TIL dv
00000010
00000010
00000010
00010010
00000010
00000010
00101010
00000010
>
00000010
00000010
00001010
00000010
00000010
00000010
00101010
00000010
NAME quke 27

TIL dw
00000010
00000010
00000010
00000010
00000010
00000010
00000010
00000010
NAME quke 28

TIL dx
00000100
00000100
00010100
01000100
00000100
00000100
01000100
00000100
NAME quke 29

TIL dy
00001000
00001000
10001000
00001000
01001000
00001000
10001000
00001000
NAME quke 30

TIL dz
01001101
00110011
00001100
00000011
00000000
00000000
00000000
00000000
NAME quke 31

TIL e0
01000000
01000000
01000000
01000000
11000000
00000000
00000000
00000000
NAME quke 32

TIL e1
00100000
00111111
00000000
00000000
00000000
00000000
00000000
00000000
NAME quke 33
WAL true

TIL e2
01100000
11111111
00010000
00001000
00000100
00000100
00000010
00000010
NAME quke 34
WAL true

TIL e3
10000000
10000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME quke 35
WAL true

TIL e4
10001001
11111111
00000001
00000000
00000000
00000000
00000000
00000000
NAME quke 36
WAL true

TIL e5
00000010
11111110
00000000
10000000
01000000
00100000
00011000
00000100
NAME quke 37
WAL true

TIL e6
00000010
00000011
00000000
00000000
00000000
00000000
00000000
00000000
NAME quke 38
WAL true

TIL e7
00000100
11111111
00000000
00000000
00000000
00000000
00000000
00000000
NAME quke 39
WAL true

TIL e8
00001000
11111000
00000000
00000000
00000000
00000000
00000000
00000000
NAME quke 40
WAL true

TIL e9
00100000
01011000
01000110
01000001
01000001
01000001
01000001
01000001
NAME quke 41
WAL true

TIL ea
00000000
00000000
00000000
00011111
00000000
00000000
00000000
00000000
NAME quke 42
WAL true

TIL eb
00000000
00000000
00000000
11111111
10010000
01001000
01001000
00100100
NAME quke 43

TIL ec
00000001
00000000
00000000
11111111
00000000
00000000
00000000
00000000
NAME quke 44

TIL ed
00000000
10000000
10000000
11111111
00100000
00100000
00010000
00010000
NAME quke 45

TIL ee
00000000
00000000
00000000
11111111
00000000
00000000
00000000
00000000
NAME quke 46

TIL ef
00000010
00000001
00000000
11111111
00000000
00000000
00000000
11111111
NAME quke 47

TIL eg
00000000
00000000
10000000
11111111
00010000
00001000
00000100
11111010
NAME quke 48

TIL eh
00000000
00000000
00000000
11111111
00010000
00001000
00000100
00000100
NAME quke 49

TIL ei
00001000
00001000
00001000
11111000
00001000
00000100
00000010
00000001
NAME quke 50

TIL ej
01000001
01000001
01000001
01000001
01000101
01000001
01000001
01000001
NAME quke 51

TIL ek
00010010
00010010
00001001
00000100
00000100
00000010
00000001
00000001
NAME quke 52
WAL false

TIL el
00000000
00000000
00000000
10000000
10000000
01000000
00100000
00010000
NAME quke 53

TIL em
00001000
00000100
00000100
00000010
00000001
00000001
00000000
00000000
NAME quke 54

TIL en
00000111
00001111
00011111
00111111
01111111
01111111
11111111
11111111
NAME quke 55

TIL eo
10000000
11000000
11100000
11110000
11110000
11110000
11110000
11110000
NAME quke 56

TIL ep
00000010
00000001
00000000
00000000
00000000
00000000
00000000
00000000
NAME quke 57

TIL eq
00000000
00000000
10000000
01000000
01000000
00100000
00010000
00001000
NAME quke 58

TIL er
11000001
01000001
00100001
00010001
00001001
00001001
00000101
00000011
NAME quke 59

TIL es
10010000
01001000
00100100
00100100
00010010
00001001
00001001
00000100
NAME quke 60

TIL et
01111111
00111111
00111111
00011111
00001111
00000111
00000000
00000000
NAME quke 61

TIL eu
11111111
11111111
11111111
11111111
11111111
11111111
00111111
00000000
NAME quke 62

TIL ev
11111111
11111111
11111111
11111111
11111111
11111110
11100000
00000000
NAME quke 63

TIL ew
11110000
11100000
11100000
11000000
10000000
00000000
00000000
00000000
NAME quke 64

TIL ex
00000100
00000010
00000010
00000001
00000000
00000000
00000000
00000000
NAME quke 65

TIL ey
00000001
00000000
00000000
00000000
10000000
01000000
00100000
00100000
NAME quke 66

TIL ez
00000000
10000000
01000000
00100000
00010000
00001000
00000000
00000000
NAME quke 67
WAL true

TIL f0
00000010
00000010
00000001
00000000
00000000
00000000
00000000
00000000
NAME quke 68

TIL f1
01000000
01000000
01111111
11000000
11000000
01111111
00000000
00000000
NAME quke 69

TIL f2
00000000
00000000
11111111
00000000
00000000
11111111
00000000
00000000
NAME quke 70

TIL f3
00010000
00001000
11111000
00001000
00001000
11111000
00000000
00000000
NAME quke 71

TIL f4
11111111
11111111
11111111
11101111
11110111
11111111
11110111
11111111
NAME angrytopleft

TIL f5
11111111
11111111
11111111
11110111
11101111
11111111
11101111
11111111
NAME angrytopright

TIL f6
11111111
11111111
11111000
11110111
11110111
11111111
11111111
11111111
NAME angrybottomleft

TIL f7
11111111
11111111
00011111
11101111
11101111
11111111
11111111
11111111
NAME angrybottomright

TIL f8
11111111
11111111
11111111
11111111
11111111
11111111
11110111
11111111
NAME happytopleft

TIL f9
11111111
11111111
11111111
11111111
11111111
11111111
11101111
11111111
NAME happytopright

TIL fa
11111111
11111111
11110111
11110111
11111000
11111111
11111111
11111111
NAME happybottomleft

TIL fb
11111111
11111111
11101111
11101111
00011111
11111111
11111111
11111111
NAME happybottomright

TIL fc
11111111
11100111
11111111
11111111
11111111
11111111
11111111
11111111
NAME albspaceman

TIL fd
11110110
11111011
11100111
01011111
10111111
11111111
11111111
11111111

TIL fe
11111011
11111101
11111110
11111111
11111111
11111111
11111111
11111111

TIL fg
11111110
11111111
11111111
11111111
11111111
11111111
11111111
11111111

TIL fh
11111111
11111111
11111111
11111111
11111111
11111111
10000000
10111111
NAME newsflash (1,1)

TIL fi
11111111
11111111
11111111
11111111
11111111
11111111
00000000
11111111
NAME newsflash (2,1)

TIL fj
11111111
11111111
11111111
11111111
11111111
11111111
00000111
11110111
NAME newsflash (14,1)

TIL fk
10111111
10111111
10111111
10111111
10111111
10111111
10111111
10111111
NAME newsflash (1,2)

TIL fl
11111111
11111111
11111111
11111111
11111110
11111111
11111111
11111111
NAME newsflash (4,2)

TIL fm
11111111
11111111
11111111
11111111
00001111
10001111
10000111
10000011
NAME newsflash (5,2)

TIL fn
11111111
11111111
11111111
11111111
00011111
01111110
01111001
01111001
NAME newsflash (6,2)

TIL fo
11111111
11111111
11111111
11111111
11111111
00011100
11111100
11111100
NAME newsflash (7,2)

TIL fp
11111111
11111111
11111111
11111111
11111111
11111110
11111110
11111110
NAME newsflash (8,2)

TIL fq
11111111
11111111
11111111
11111111
11111111
01111000
01110011
01110011
NAME newsflash (9,2)

TIL fr
11111111
11111111
11111111
11111111
11111111
00011111
11101111
11111111
NAME newsflash (10,2)

TIL fs
10000000
10000000
10000000
10011111
10011111
10000000
10011111
10000000
NAME newsflash (12,2)

TIL ft
00000000
00000000
00000000
11111111
11111111
00000000
11111100
00000000
NAME newsflash (13,2)

TIL fu
00110111
00110111
00110111
00110111
00110111
00110111
00110111
00110111
NAME newsflash (14,2)

TIL fv
11111111
11111111
11111111
11111111
11111111
11111111
11111110
11111111
NAME newsflash (4,3)

TIL fw
10011000
10011110
10011111
10011111
10011111
10011111
00011100
11111111
NAME newsflash (5,3)

TIL fx
01111001
01111001
01111000
01111001
01111001
01111001
00011110
11111111
NAME newsflash (6,3)

TIL fy
11111100
11111100
00011100
11111100
11111100
11111100
00011111
11111111
NAME newsflash (7,3)

TIL fz
11111110
11111110
11111110
11111110
11101110
11101110
00010001
11111111
NAME newsflash (8,3)

TIL g0
01110011
01110000
01111111
01111111
01111111
01110111
11111000
11111111
NAME newsflash (9,3)

TIL g1
11111111
00111111
11001111
11001111
11001111
11001111
00011111
11111111
NAME newsflash (10,3)

TIL g2
10011111
10000000
10000000
10000000
10000000
10000000
10011110
10000000
NAME newsflash (12,3)

TIL g3
11111111
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME newsflash (13,3)

TIL g4
10111111
10111111
10110000
10111111
10110000
10111111
10111111
10111111
NAME newsflash (1,4)

TIL g5
11111111
11111111
00000000
11111111
00000000
11111111
11111111
11111111
NAME newsflash (2,4)

TIL g6
10000000
11111111
00000000
11111111
00000000
11111111
11111111
11111111
NAME newsflash (12,4)

TIL g7
00000000
11111111
00000000
11111111
00000000
11111111
11111111
11111111
NAME newsflash (13,4)

TIL g8
00110111
11110111
00010111
11110111
00010111
11110111
11110111
11110111
NAME newsflash (14,4)

TIL g9
10111111
10110111
10110111
10111000
10111101
10111101
10111111
10111111
NAME newsflash (1,5)

TIL ga
11111111
01100110
01011010
11011010
11011010
11100111
11111111
11111111
NAME newsflash (2,5)

TIL gb
11111111
11011110
11011101
11011110
11011111
00111100
11111111
11111111
NAME newsflash (3,5)

TIL gc
11111111
00101101
11101101
01100001
10101101
01101101
11111111
11111111
NAME newsflash (4,5)

TIL gd
11111111
10011011
01101011
01101011
01101011
10011100
11111111
11111111
NAME newsflash (5,5)

TIL ge
11111111
01011110
01011110
01011110
01011110
11000010
11111111
11111111
NAME newsflash (6,5)

TIL gf
11111111
00111100
11011101
11011100
11011101
00111101
11111111
11111111
NAME newsflash (7,5)

TIL gg
11111111
01100011
10101101
01100011
11101011
11101101
11111111
11111111
NAME newsflash (8,5)

TIL gh
11111111
10011000
01101011
01101000
01101011
10011000
11111111
11111111
NAME newsflash (9,5)

TIL gi
11111111
11100110
01011010
11000010
01011010
11011010
11111111
11111111
NAME newsflash (10,5)

TIL gj
11111111
00110111
11010111
00110111
11010111
00110000
11111111
11111111
NAME newsflash (11,5)

TIL gk
11111111
10111011
10111011
11000111
11101111
11101111
11111111
11111111
NAME newsflash (12,5)

TIL gl
11111111
11001110
10111101
10100101
10110101
11001110
11111110
11111111
NAME newsflash (13,5)

TIL gm
11110111
01110111
10110111
10110111
10110111
01110111
11110111
11110111
NAME newsflash (14,5)

TIL gn
11101101
11101101
11100001
11101101
11101101
11111111
11111111
11111111
NAME newsflash (2,6)

TIL go
10011011
01101001
01101010
01101011
10011011
11111111
11111111
11111111
NAME newsflash (3,6)

TIL gp
10100001
00101111
10100011
10101111
10100001
11111111
11111111
11111111
NAME newsflash (4,6)

TIL gq
11100110
11011010
11000010
11011010
11011010
11111111
11111111
11111111
NAME newsflash (5,6)

TIL gr
11010001
01010110
10010110
11010110
11010001
11111111
11111111
11111111
NAME newsflash (6,6)

TIL gs
11110001
11101111
11110011
11111101
11100011
11111111
11111111
11111111
NAME newsflash (7,6)

TIL gt
00000110
11011101
11011100
11011101
11011101
11111111
11111111
11111111
NAME newsflash (8,6)

TIL gu
01101110
10101110
00110001
10111011
10111011
11111111
11111111
11111111
NAME newsflash (9,6)

TIL gv
11100000
11111011
11111011
11111011
11111011
11111111
11111111
11111111
NAME newsflash (10,6)

TIL gw
10110100
10110101
10000100
10110101
10110100
11111111
11111111
11111111
NAME newsflash (11,6)

TIL gx
00100011
11101101
01100011
11101011
00101101
11111111
11111111
11111111
NAME newsflash (12,6)

TIL gy
00001111
01111111
00011111
01111111
00001111
11111111
11111111
11111111
NAME newsflash (13,6)

TIL gz
10111111
10111100
10111100
10111100
10111100
10111100
10111100
10111100
NAME newsflash (1,7)

TIL h0
11111111
00000000
00000000
00000000
00000011
00001111
00011110
00011110
NAME newsflash (2,7)

TIL h1
11111111
00000000
00000000
00000000
10000000
11100000
01010000
10100000
NAME newsflash (3,7)

TIL h2
11111111
00000000
00000000
00000000
00000000
00000000
00000000
00000100
NAME newsflash (6,7)

TIL h3
11111111
00000000
00001000
00010100
00001000
00010100
00001000
00010101
NAME newsflash (8,7)

TIL h4
11111111
00000000
00100010
01000001
00100010
01000001
00100010
01010101
NAME newsflash (9,7)

TIL h5
11111111
00000000
00001000
00010000
00001000
00010000
00001000
01010101
NAME newsflash (10,7)

TIL h6
11111111
01111000
01111010
01111010
01111000
01111111
01111111
01111000
NAME newsflash (11,7)

TIL h7
11111111
00000000
11111000
00000011
00000000
11111111
11111111
00000000
NAME newsflash (12,7)

TIL h8
11111111
00000000
01000010
01011010
00000000
11111111
11111111
00010000
NAME newsflash (13,7)

TIL h9
10111100
10111100
10111100
10111100
10111100
10111100
10111100
10111100
NAME newsflash (1,8)

TIL ha
00111101
00111110
00111101
00011110
00011111
00001111
00000001
00000000
NAME newsflash (2,8)

TIL hb
01010000
10101000
01010000
10100000
01010000
10100000
11000000
00000000
NAME newsflash (3,8)

TIL hd
00000000
01100000
00000000
00000111
00111110
00000001
00000000
00000000
NAME newsflash (5,8)

TIL he
00000000
00000000
00111111
11111111
11111111
11111111
00111110
00000000
NAME newsflash (6,8)

TIL hf
00111100
01101111
11111111
11111111
11111111
11111111
11101111
00111110
NAME newsflash (7,8)

TIL hg
00001010
11110100
11101000
11110100
11101000
11110100
00001010
00010101
NAME newsflash (8,8)

TIL hh
10101010
01000001
00100010
01000001
00100011
01000001
10101010
11010101
NAME newsflash (9,8)

TIL hi
10101010
00010000
00001000
00010000
00001000
00010000
10101010
01010101
NAME newsflash (10,8)

TIL hj
01111111
01111000
01111111
01111000
01111111
01111000
01111111
01111000
NAME newsflash (11,8)

TIL hk
11111111
01000000
11111111
00010001
11111111
00000100
11111111
00001000
NAME newsflash (12,8)

TIL hl
11111111
10000001
11111111
00010000
11111111
00000001
11111111
01011111
NAME newsflash (13,8)

TIL hm
00000000
00000001
00000011
11111111
00011111
00000000
00010000
00000000
NAME newsflash (3,9)

TIL hn
00000000
11111110
11111011
11111111
11111111
00101111
00000000
00000000
NAME newsflash (4,9)

TIL ho
00000000
00000000
11100000
11111111
11100000
00000000
00000000
00000000
NAME newsflash (5,9)

TIL hp
00000000
01000000
00000000
10000000
00000000
00000000
00000000
00000000
NAME newsflash (6,9)

TIL hq
00001000
00011100
00001000
00011100
00001100
00011111
00011111
00011100
NAME newsflash (8,9)

TIL hr
00100010
01000001
01100010
01100011
01100010
11111111
11111111
01100011
NAME newsflash (9,9)

TIL hs
00001000
00010000
00001000
00010000
00001000
01010101
10101010
00010000
NAME newsflash (10,9)

TIL ht
01111111
01111111
01111000
01111011
01111011
01111011
01111011
01111011
NAME newsflash (11,9)

TIL hu
11111111
11111111
00000000
11111111
10011110
11101101
11110000
11100001
NAME newsflash (12,9)

TIL hv
11111111
11111111
00000000
11111110
11111110
10111110
01111110
00110110
NAME newsflash (13,9)

TIL hw
00011100
00011100
00011100
00011100
00011111
00010111
00010100
00010100
NAME newsflash (8,10)

TIL hx
01100011
01100011
01100011
01100011
11111111
11111111
01100011
01100011
NAME newsflash (9,10)

TIL hy
00001000
00010000
00001000
00010000
11101010
11110101
00011000
00010000
NAME newsflash (10,10)

TIL hz
01111011
01111011
01111011
01111011
01111011
01111010
01111011
01111011
NAME newsflash (11,10)

TIL i0
00000000
11000000
11000000
11000000
10000000
01100000
11110000
11001110
NAME newsflash (12,10)

TIL i1
10001110
00011110
00011110
00001110
00010110
00111110
00111110
11011110
NAME newsflash (13,10)

TIL i2
10111100
10111100
10111100
10111100
10111101
10111100
10111100
10111100
NAME newsflash (1,11)

TIL i3
00000000
00000000
00000000
00000000
11111111
00000000
00000000
00000000
NAME newsflash (2,11)

TIL i4
00000000
00000000
00000000
00000000
01011000
00000000
00000000
00000000
NAME newsflash (3,11)

TIL i5
00000000
00000000
00000000
00000000
00000001
00000000
00000000
00000000
NAME newsflash (5,11)

TIL i6
00000000
00000000
00000000
00000000
10100101
00000000
00000000
00000000
NAME newsflash (6,11)

TIL i7
00000000
00000000
00000000
00000000
10110111
00000000
00000000
00000000
NAME newsflash (7,11)

TIL i8
00010100
00010100
00010100
00010111
11111111
00000000
00000000
00000000
NAME newsflash (8,11)

TIL i9
01100011
01100011
01100011
11111111
11111111
00000000
00000000
00000000
NAME newsflash (9,11)

TIL ia
00011000
00011000
00011000
11111101
11111111
00000000
00000000
00000000
NAME newsflash (10,11)

TIL ib
01111011
01111011
01111000
01111111
11111111
01111000
01111111
01111000
NAME newsflash (11,11)

TIL ic
11111101
11111111
00000000
11111111
11111111
00000000
11111111
00010000
NAME newsflash (12,11)

TIL id
11111110
11111110
00000000
11111111
11111111
00001000
11111111
00100000
NAME newsflash (13,11)

TIL ie
11111111
00010001
11111111
00000000
11111111
01000000
11111111
10000001
NAME newsflash (12,12)

TIL if
11111111
00000000
11111111
00100011
11111111
01000000
11111111
00010001
NAME newsflash (13,12)

TIL ig
10111111
10111111
10111100
10111100
10111100
10111111
10111111
10111100
NAME newsflash (1,13)

TIL ih
11111111
11111111
11000100
01001110
01010100
11111111
11111111
11000100
NAME newsflash (2,13)

TIL ii
11111111
11111111
01000110
11101100
01101101
11111111
11111111
01010100
NAME newsflash (3,13)

TIL ij
11111111
11111111
01000100
01101101
01000101
11111111
11111111
11000101
NAME newsflash (4,13)

TIL ik
11111111
11111111
01111000
01111010
01111000
11111111
11111111
01000111
NAME newsflash (5,13)

TIL il
11111111
11111111
10001111
10101111
10101111
11111111
11111111
11111111
NAME newsflash (6,13)

TIL im
11111111
11111111
01010001
00011011
10110001
11111111
11111111
11111111
NAME newsflash (7,13)

TIL in
11111111
11111111
00010101
00110101
01010001
11111111
11111111
11111111
NAME newsflash (8,13)

TIL io
11111111
11111111
10011111
10111111
00111111
11111111
11111111
11111111
NAME newsflash (9,13)

TIL ip
11111111
11111000
11111111
11111000
11111111
11111000
11111111
11111000
NAME newsflash (11,13)

TIL iq
11111111
00000000
11111111
01000000
11111111
00010001
11111111
00000100
NAME newsflash (12,13)

TIL ir
11111111
00010000
11111111
10000001
11111111
00010000
11111111
00000001
NAME newsflash (13,13)

TIL is
10111100
10111100
10111111
10111111
10111100
10111111
10111100
10111111
NAME newsflash (1,14)

TIL it
11010101
01000100
11111111
11111111
00000100
11111111
00010000
11111111
NAME newsflash (2,14)

TIL iu
11001101
01010100
11111111
11111111
00000100
11111111
00000010
11111111
NAME newsflash (3,14)

TIL iv
01010100
01000100
11111111
11111111
00001011
11111111
00000011
11111111
NAME newsflash (4,14)

TIL iw
01010111
01010111
11111111
11111111
11000000
11111111
11000000
11111111
NAME newsflash (5,14)

TIL ix
11111111
11111111
11111111
11111111
00000001
11111111
00100000
11111111
NAME newsflash (6,14)

TIL iy
11111111
11111111
11111111
11111111
00000001
11111111
00100001
11111111
NAME newsflash (7,14)

TIL iz
11111111
11111111
11111111
11111111
11100000
11111111
11100000
11111111
NAME newsflash (8,14)

TIL j0
11111111
11111111
11111111
11111111
00010110
11111111
10000000
11111111
NAME newsflash (9,14)

TIL j1
11111111
11111111
11111111
11111111
00000000
11111111
00000000
11111111
NAME newsflash (10,14)

TIL j2
11111111
11111000
11111111
11111111
00111000
11111011
00111011
11111011
NAME newsflash (11,14)

TIL j3
11111111
00001000
11111111
11111111
00000000
11111111
11111111
11111111
NAME newsflash (12,14)

TIL j4
11111111
01011111
11111111
11111111
00000000
11111110
11111110
11111110
NAME newsflash (13,14)

TIL j5
10111100
10111111
10111100
10111111
10111100
10111111
10111100
10111111
NAME newsflash (1,15)

TIL j6
00001010
11111111
00000000
11111111
00000000
11111111
00000100
11111111
NAME newsflash (2,15)

TIL j7
00000010
11111111
00000100
11111111
00000000
11111111
00001000
11111111
NAME newsflash (3,15)

TIL j8
11000011
11111111
00000011
11111111
00000011
11111111
00000011
11111111
NAME newsflash (4,15)

TIL j9
11000000
11111111
11000000
11111111
11000000
11111111
11000000
11111111
NAME newsflash (5,15)

TIL ja
00000000
11111111
00000000
11111111
01000000
11111111
00010000
11111111
NAME newsflash (6,15)

TIL jb
10000001
11111111
00100001
11111111
00100001
11111111
00000001
11111111
NAME newsflash (7,15)

TIL jc
11100000
11111111
11100000
11111111
11100000
11111111
11100000
11111111
NAME newsflash (8,15)

TIL jd
10000001
11111111
00100000
11111111
00000010
11111111
01000000
11111111
NAME newsflash (9,15)

TIL je
00000100
11111111
01000001
11111111
00000010
11111111
01000000
11111111
NAME newsflash (10,15)

TIL jf
00111011
11111011
00111011
11111010
00111010
11111000
00111000
11111000
NAME newsflash (11,15)

TIL jg
11000000
11000000
00000000
00000111
00011111
00111111
01111111
01110111
NAME newsflash (12,15)

TIL jh
00000110
00000110
00000010
10000010
11000010
11100000
11110000
10110000
NAME newsflash (13,15)

TIL 1i
11000000
11011111
11011111
11011111
11011111
11011111
11011111
11011111
NAME newsflash (1,2)

TIL 1l
00000000
11111111
11111111
11111111
11111111
11111111
00000111
11000111
NAME newsflash (5,2)

TIL 1m
00000000
11111111
11111111
11111111
11111111
11111111
10001111
10111111
NAME newsflash (6,2)

TIL 7o
00000000
11111111
11111111
11111111
11111111
11111111
11111111
00001110
NAME newsflash (7,2)

TIL b0
00000000
11111111
11111111
11111111
11111111
11111111
11111111
01111111
NAME newsflash (8,2)

TIL b3
00000000
11111111
11111111
11111111
11111111
11111111
11111111
00111100
NAME newsflash (9,2)

TIL b7
00000000
11111111
11111111
11111111
11111111
11111111
11111111
00001111
NAME newsflash (10,2)

TIL b8
00000000
11111111
11000000
11000000
11000000
11001111
11001111
11000000
NAME newsflash (12,2)

TIL ba
00000000
11111111
00000000
00000000
00000000
11111111
11111111
00000000
NAME newsflash (13,2)

TIL bh
00000011
11111011
00011011
00011011
00011011
10011011
10011011
00011011
NAME newsflash (14,2)

TIL bi
11011111
11011111
11011111
11011111
11011111
11011111
11011111
11011111
NAME newsflash (1,3)

TIL bk
11000011
11000001
11001100
11001111
11001111
11001111
11001111
11001111
NAME newsflash (5,3)

TIL bq
10111100
10111100
00111100
00111100
10111100
10111100
10111100
10111100
NAME newsflash (6,3)

TIL br
11111110
11111110
11111110
11111110
00001110
11111110
11111110
11111110
NAME newsflash (7,3)

TIL bu
01111111
01111111
01111111
01111111
01111111
01111111
01110111
01110111
NAME newsflash (8,3)

TIL d2
00111001
00111001
00111001
00111000
00111111
00111111
00111111
00111011
NAME newsflash (9,3)

TIL d3
11110111
11111111
11111111
00011111
11100111
11100111
11100111
11100111
NAME newsflash (10,3)

TIL ff
11001111
11000000
11001111
11000000
11000000
11000000
11000000
11000000
NAME newsflash (12,3)

TIL hc
11111110
00000000
11111111
00000000
00000000
00000000
00000000
00000000
NAME newsflash (13,3)

TIL ji
00011011
00011011
10011011
00011011
00011011
00011011
00011011
00011011
NAME newsflash (14,3)

TIL jj
11011111
11011111
11011111
11011111
11011000
11011111
11011000
11011111
NAME newsflash (1,4)

TIL jk
00001110
11111111
11111111
11111111
00000000
11111111
00000000
11111111
NAME newsflash (5,4)

TIL jl
00001111
11111111
11111111
11111111
00000000
11111111
00000000
11111111
NAME newsflash (6,4)

TIL jm
10001000
11111111
11111111
11111111
00000000
11111111
00000000
11111111
NAME newsflash (8,4)

TIL jn
11111100
11111111
11111111
11111111
00000000
11111111
00000000
11111111
NAME newsflash (9,4)

TIL jo
11001111
11000000
11000000
11111111
00000000
11111111
00000000
11111111
NAME newsflash (12,4)

TIL jp
00000000
00000000
00000000
11111111
00000000
11111111
00000000
11111111
NAME newsflash (13,4)

TIL jq
00011011
00011011
00011011
11111011
00001011
11111011
00001011
11111011
NAME newsflash (14,4)

TIL jr
11011111
11011111
11011111
11011011
11011011
11011100
11011110
11011110
NAME newsflash (1,5)

TIL js
11111111
11111111
11111111
10110011
10101101
01101101
11101101
11110011
NAME newsflash (2,5)

TIL jt
11111111
11111111
11111111
01101111
01101110
01101111
01101111
10011110
NAME newsflash (3,5)

TIL ju
11111111
11111111
11111111
00010110
11110110
00110000
11010110
00110110
NAME newsflash (4,5)

TIL jv
11111111
11111111
11111111
11001101
10110101
10110101
10110101
11001110
NAME newsflash (5,5)

TIL jw
11111111
11111111
11111111
10101111
10101111
10101111
10101111
01100001
NAME newsflash (6,5)

TIL jx
11111111
11111111
11111111
00011110
01101110
01101110
01101110
00011110
NAME newsflash (7,5)

TIL jy
11111111
11111111
11111111
00110001
11010110
00110001
11110101
11110110
NAME newsflash (8,5)

TIL jz
11111111
11111111
11111111
11001100
10110101
10110100
10110101
11001100
NAME newsflash (9,5)

TIL k0
11111111
11111111
11111111
01110011
10101101
01100001
10101101
01101101
NAME newsflash (10,5)

TIL k1
11111111
11111111
11111111
00011011
01101011
00011011
01101011
00011000
NAME newsflash (11,5)

TIL k2
11111111
11111111
11111111
11011101
11011101
11100011
11110111
01110111
NAME newsflash (12,5)

TIL k3
11111111
11111111
11111111
11100111
11011110
11010010
11011010
11100111
NAME newsflash (13,5)

TIL k4
11111011
11111011
11111011
00111011
11011011
11011011
11011011
00111011
NAME newsflash (14,5)

TIL k5
11111111
11111111
11110110
11110110
11110000
11110110
11110110
11111111
NAME newsflash (2,6)

TIL k6
11111111
11111111
11001101
10110100
10110101
10110101
11001101
11111111
NAME newsflash (3,6)

TIL k7
11111111
11111111
11010000
10010111
01010001
11010111
11010000
11111111
NAME newsflash (4,6)

TIL k8
11111111
11111111
11110011
11101101
11100001
11101101
11101101
11111111
NAME newsflash (5,6)

TIL k9
11111111
11111111
01101000
00101011
01001011
01101011
01101000
11111111
NAME newsflash (6,6)

TIL ka
11111111
11111111
11111000
01110111
01111001
01111110
11110001
11111111
NAME newsflash (7,6)

TIL kb
11111111
11111111
10000011
11101110
11101110
11101110
11101110
11111111
NAME newsflash (8,6)

TIL kc
11111111
11111111
00110111
11010111
00011000
11011101
11011101
11111111
NAME newsflash (9,6)

TIL kd
11111111
11111111
01110000
01111101
11111101
11111101
11111101
11111111
NAME newsflash (10,6)

TIL ke
11111111
11111111
01011010
11011010
11000010
11011010
11011010
11111111
NAME newsflash (11,6)

TIL kf
11111111
11111111
00010001
11110110
00110001
11110101
00010110
11111111
NAME newsflash (12,6)

TIL kg
11111111
11111111
10000111
10111111
10001111
10111111
10000111
11111111
NAME newsflash (13,6)

TIL kh
01111011
11111011
11111011
11111011
11111011
11111011
11111011
11111011
NAME newsflash (14,6)

TIL ki
11011111
11011111
11011111
11011110
11011110
11011110
11011110
11011110
NAME newsflash (1,7)

TIL kj
11111111
11111111
11111111
00000000
00000000
00000000
00000001
00000111
NAME newsflash (2,7)

TIL kk
11111111
11111111
11111111
00000000
00000000
00000000
11000000
11110000
NAME newsflash (3,7)

TIL kl
11111111
11111111
11111111
00000000
00000000
00000000
00000000
00000000
NAME newsflash (4,7)

TIL km
11111111
11111111
11111111
00000000
00000100
00001010
00000100
00001010
NAME newsflash (8,7)

TIL kn
11111111
11111111
11111111
00000000
00010001
00100000
00010001
00100000
NAME newsflash (9,7)

TIL ko
11111111
11111111
11111111
00000000
00000100
10001000
00000100
10001000
NAME newsflash (10,7)

TIL kp
11111111
11111111
11111111
00111100
00111101
00111101
00111100
00111111
NAME newsflash (11,7)

TIL kq
11111111
11111111
11111111
00000000
01111100
00000001
00000000
11111111
NAME newsflash (12,7)

TIL kr
11111111
11111111
11111111
00000000
00100001
10101101
00000000
11111111
NAME newsflash (13,7)

TIL ks
11111011
11111011
11111011
01111011
01111011
01111011
01111011
11111011
NAME newsflash (14,7)

TIL kt
11011110
11011110
11011110
11011110
11011110
11011110
11011110
11011110
NAME newsflash (1,8)

TIL ku
00001111
00001111
00011110
00011111
00011110
00001111
00001111
00000111
NAME newsflash (2,8)

TIL kv
00101000
01010000
10101000
01010100
10101000
01010000
10101000
11010000
NAME newsflash (3,8)

TIL kx
00000000
00000000
00000000
00110000
00000000
00000011
00011111
00000000
NAME newsflash (5,8)

TIL ky
00000000
00000010
00000000
00000000
00011111
11111111
01111111
11111111
NAME newsflash (6,8)

TIL kz
00000000
00000000
00011110
00110111
11111111
11111111
11111111
11111111
NAME newsflash (7,8)

TIL l0
00000100
00001010
00000101
11111010
11110100
11111010
11110100
11111010
NAME newsflash (8,8)

TIL l1
00010001
10101010
01010101
00100000
00010001
00100000
00010001
00100000
NAME newsflash (9,8)

TIL l2
00000100
10101010
01010101
10001000
00000100
10001000
10000100
10001000
NAME newsflash (10,8)

TIL l3
00111111
10111100
00111111
00111100
00111111
00111100
00111111
00111100
NAME newsflash (11,8)

TIL l4
11111111
00000000
11111111
00100000
11111111
00001000
11111111
00000010
NAME newsflash (12,8)

TIL l5
11111111
00001000
11111111
01000000
11111111
10001000
11111111
00000000
NAME newsflash (13,8)

TIL l6
11111011
01111011
11111011
11111011
11111011
01111011
11111011
11111011
NAME newsflash (14,8)

TIL l7
11100000
00000000
00000000
00000000
00000001
01111111
00001111
00000000
NAME newsflash (3,9)

TIL l8
00000000
00000000
00000000
11111111
11111101
11111111
11111111
00010111
NAME newsflash (4,9)

TIL l9
00000000
00000000
00000000
00000000
11110000
11111111
11110000
10000000
NAME newsflash (5,9)

TIL la
00011111
00000000
00000000
00100000
00000000
11000000
00000000
00000000
NAME newsflash (6,9)

TIL lb
01110111
00011111
00000000
00000000
00000000
00000000
00000000
00000000
NAME newsflash (7,9)

TIL lc
10000101
00001010
00000100
00001110
00000100
00001110
00000110
00001111
NAME newsflash (8,9)

TIL ld
01010101
11101010
00010001
00100000
00110001
00110001
00110001
11111111
NAME newsflash (9,9)

TIL le
01010101
10101010
00000100
10001000
00000100
10001000
00000100
10101010
NAME newsflash (10,9)

TIL lf
00111111
10111100
00111111
00111111
00111100
00111101
00111101
10111101
NAME newsflash (11,9)

TIL lg
11111111
00000100
11111111
11111111
00000000
11111111
11001111
11110110
NAME newsflash (12,9)

TIL lh
11111111
00101111
11111111
11111111
00000000
11111111
01111111
11011111
NAME newsflash (13,9)

TIL li
11111011
11111011
11111011
11111011
01111011
01111011
01111011
01111011
NAME newsflash (14,9)

TIL lj
00001000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME newsflash (3,10)

TIL lk
00001111
00001110
00001110
00001110
00001110
00001110
00001111
00001011
NAME newsflash (8,10)

TIL ll
11111111
00110001
00110001
00110001
00110001
00110001
11111111
11111111
NAME newsflash (9,10)

TIL lm
11010101
10001000
10000100
10001000
10000100
10001000
11110101
11111010
NAME newsflash (10,10)

TIL ln
00111101
00111101
00111101
00111101
00111101
00111101
00111101
10111101
NAME newsflash (11,10)

TIL lo
11111000
11110000
10000000
11100000
11100000
11100000
11000000
00110000
NAME newsflash (12,10)

TIL lp
00111111
10011011
01000111
00001111
00001111
00000111
00001011
00011111
NAME newsflash (13,10)

TIL lq
01111011
01111011
01111011
01111011
01111011
01111011
01111011
01111011
NAME newsflash (14,10)

TIL lr
00000000
00000000
00000000
00000000
00000000
00000000
11111111
00000000
NAME newsflash (2,11)

TIL ls
00000000
00000000
00000000
00000000
00000000
00000000
10101100
00000000
NAME newsflash (3,11)

TIL lt
00000000
00000000
00000000
00000000
00000000
00000000
11010010
00000000
NAME newsflash (6,11)

TIL lu
00000000
00000000
00000000
00000000
00000000
00000000
11011011
00000000
NAME newsflash (7,11)

TIL lv
00001010
00001010
00001010
00001010
00001010
00001011
11111111
00000000
NAME newsflash (8,11)

TIL lw
00110001
00110001
00110001
00110001
00110001
11111111
11111111
00000000
NAME newsflash (9,11)

TIL lx
10001100
10001000
10001100
10001100
10001100
11111110
11111111
00000000
NAME newsflash (10,11)

TIL ly
00111101
00111101
00111101
00111101
00111100
10111111
11111111
00111100
NAME newsflash (11,11)

TIL lz
11111000
11100111
11111110
11111111
00000000
11111111
11111111
00000000
NAME newsflash (12,11)

TIL m0
00011111
01101111
11111111
11111111
00000000
11111111
11111111
00000100
NAME newsflash (13,11)

TIL m1
01111011
01111011
01111011
01111011
01111011
11111011
11111011
01111011
NAME newsflash (14,11)

TIL m2
00111111
00111100
00111111
00111100
00111111
00111100
00111111
00111100
NAME newsflash (11,12)

TIL m3
11111111
00001000
11111111
00001000
11111111
00000000
11111111
00100000
NAME newsflash (12,12)

TIL m4
11111111
00010000
11111111
10000000
11111111
00010001
11111111
00100000
NAME newsflash (13,12)

TIL m5
11111011
01111011
11111011
01111011
11111011
11111011
11111011
01111011
NAME newsflash (14,12)

TIL m6
11011110
11011110
11011111
11011111
11011110
11011110
11011110
11011111
NAME newsflash (1,13)

TIL m7
00000000
00000000
11111111
11111111
01100010
00100111
00101010
11111111
NAME newsflash (2,13)

TIL m8
00000000
00000000
11111111
11111111
00100011
01110110
00110110
11111111
NAME newsflash (3,13)

TIL m9
00000000
00000000
11111111
11111111
00100010
00110110
10100010
11111111
NAME newsflash (4,13)

TIL ma
00000000
00000000
11111111
11111111
00111100
10111101
10111100
11111111
NAME newsflash (5,13)

TIL mb
00000000
00000000
11111111
11111111
01000111
01010111
01010111
11111111
NAME newsflash (6,13)

TIL mc
00000000
00000000
11111111
11111111
10101000
10001101
11011000
11111111
NAME newsflash (7,13)

TIL md
00000000
00000000
11111111
11111111
10001010
10011010
10101000
11111111
NAME newsflash (8,13)

TIL me
00000000
00000000
11111111
11111111
11001111
11011111
10011111
11111111
NAME newsflash (9,13)

TIL mf
00111111
00111100
11111111
11111100
11111111
11111100
11111111
11111100
NAME newsflash (11,13)

TIL mg
11111111
01000000
11111111
00000000
11111111
00100000
11111111
00001000
NAME newsflash (12,13)

TIL mh
11111111
10001000
11111111
00001000
11111111
01000000
11111111
10001000
NAME newsflash (13,13)

TIL mi
11111011
11111011
11111011
01111011
11111011
11111011
11111011
01111011
NAME newsflash (14,13)

TIL mj
11011111
11011110
11011110
11011110
11011111
11011111
11011110
11011111
NAME newsflash (1,14)

TIL mk
11111111
01100010
01101010
00100010
11111111
11111111
00000010
11111111
NAME newsflash (2,14)

TIL ml
11111111
00101010
11100110
00101010
11111111
11111111
00000010
11111111
NAME newsflash (3,14)

TIL mm
11111111
01100010
10101010
00100010
11111111
11111111
00000101
11111111
NAME newsflash (4,14)

TIL mn
11111111
10100011
00101011
00101011
11111111
11111111
11100000
11111111
NAME newsflash (5,14)

TIL mo
11111111
11111111
11111111
11111111
11111111
11111111
10000000
11111111
NAME newsflash (7,14)

TIL mp
11111111
11111111
11111111
11111111
11111111
11111111
11110000
11111111
NAME newsflash (8,14)

TIL mq
11111111
11111111
11111111
11111111
11111111
11111111
00001011
11111111
NAME newsflash (9,14)

TIL mr
11111111
11111100
11111111
11111100
11111111
11111111
00011100
11111101
NAME newsflash (11,14)

TIL ms
11111111
00000010
11111111
00000100
11111111
11111111
00000000
11111111
NAME newsflash (12,14)

TIL mt
11111111
00000000
11111111
00101111
11111111
11111111
00000000
11111111
NAME newsflash (13,14)

TIL mu
11111011
11111011
11111011
11111011
11111011
11111011
01111011
01111011
NAME newsflash (14,14)

TIL mv
11011110
11011111
11011110
11011111
11011110
11011111
11011110
11011111
NAME newsflash (1,15)

TIL mw
00001000
11111111
00000101
11111111
00000000
11111111
00000000
11111111
NAME newsflash (2,15)

TIL mx
00000001
11111111
00000001
11111111
00000010
11111111
00000000
11111111
NAME newsflash (3,15)

TIL my
00000001
11111111
01100001
11111111
00000001
11111111
00000001
11111111
NAME newsflash (4,15)

TIL mz
00010000
11111111
00000000
11111111
00000000
11111111
00100000
11111111
NAME newsflash (6,15)

TIL n0
00010000
11111111
01000000
11111111
00010000
11111111
00010000
11111111
NAME newsflash (7,15)

TIL n1
11110000
11111111
11110000
11111111
11110000
11111111
11110000
11111111
NAME newsflash (8,15)

TIL n2
01000000
11111111
01000000
11111111
00010000
11111111
00000001
11111111
NAME newsflash (9,15)

TIL n3
00000000
11111111
10000010
11111111
00100000
11111111
00000001
11111111
NAME newsflash (10,15)

TIL n4
00011101
11111101
00011101
11111101
10011101
11111101
00011101
11111100
NAME newsflash (11,15)

TIL n5
11111111
11111111
11100000
11100000
10000000
00000011
00001111
00011111
NAME newsflash (12,15)

TIL n6
11111111
11111111
00000011
00000011
00000001
11000001
11100001
11110000
NAME newsflash (13,15)

TIL kw
11111111
11111111
11000000
11011111
11011111
11011111
11011111
11011111
NAME newsflash (1,2)

TIL n7
11111111
11111111
00000000
11111111
11111111
11111111
11111111
11111111
NAME newsflash (2,2)

TIL n8
11111111
11111111
00000000
11111111
11000000
11000000
11000000
11001111
NAME newsflash (12,2)

TIL n9
11111111
11111111
00000000
11111111
00000000
00000000
00000000
11111111
NAME newsflash (13,2)

TIL na
11111111
11111111
00000011
11111011
00011011
00011011
00011011
10011011
NAME newsflash (14,2)

TIL nb
00000111
11000111
11000011
11000001
11001100
11001111
11001111
11001111
NAME newsflash (5,3)

TIL nc
10001111
10111111
10111100
10111100
00111100
00111100
10111100
10111100
NAME newsflash (6,3)

TIL nd
11111111
00001110
11111110
11111110
11111110
11111110
00001110
11111110
NAME newsflash (7,3)

TIL ne
11111111
01111111
01111111
01111111
01111111
01111111
01111111
01111111
NAME newsflash (8,3)

TIL nf
11111111
00111100
00111001
00111001
00111001
00111000
00111111
00111111
NAME newsflash (9,3)

TIL ng
11111111
00001111
11110111
11111111
11111111
00011111
11100111
11100111
NAME newsflash (10,3)

TIL nh
11001111
11000000
11001111
11000000
11001111
11000000
11000000
11000000
NAME newsflash (12,3)

TIL ni
11111111
00000000
11111110
00000000
11111111
00000000
00000000
00000000
NAME newsflash (13,3)

TIL nj
10011011
00011011
00011011
00011011
10011011
00011011
00011011
00011011
NAME newsflash (14,3)

TIL nk
11011111
11011111
11011111
11011111
11011111
11011111
11011000
11011111
NAME newsflash (1,4)

TIL nl
11001111
11001111
00001110
11111111
11111111
11111111
00000000
11111111
NAME newsflash (5,4)

TIL nm
10111100
10111100
00001111
11111111
11111111
11111111
00000000
11111111
NAME newsflash (6,4)

TIL nn
11111110
11111110
00001111
11111111
11111111
11111111
00000000
11111111
NAME newsflash (7,4)

TIL no
01110111
01110111
10001000
11111111
11111111
11111111
00000000
11111111
NAME newsflash (8,4)

TIL np
00111111
00111011
11111100
11111111
11111111
11111111
00000000
11111111
NAME newsflash (9,4)

TIL nq
11100111
11100111
00001111
11111111
11111111
11111111
00000000
11111111
NAME newsflash (10,4)

TIL nr
11000000
11000000
11001111
11000000
11000000
11111111
00000000
11111111
NAME newsflash (12,4)

TIL ns
00000000
00000000
00000000
00000000
00000000
11111111
00000000
11111111
NAME newsflash (13,4)

TIL nt
00011011
00011011
00011011
00011011
00011011
11111011
00001011
11111011
NAME newsflash (14,4)

TIL nu
11011000
11011111
11011111
11011111
11011111
11011011
11011011
11011100
NAME newsflash (1,5)

TIL nv
00000000
11111111
11111111
11111111
11111111
10110011
10101101
01101101
NAME newsflash (2,5)

TIL nw
00000000
11111111
11111111
11111111
11111111
01101111
01101110
01101111
NAME newsflash (3,5)

TIL nx
00000000
11111111
11111111
11111111
11111111
00010110
11110110
00110000
NAME newsflash (4,5)

TIL ny
00000000
11111111
11111111
11111111
11111111
11001101
10110101
10110101
NAME newsflash (5,5)

TIL nz
00000000
11111111
11111111
11111111
11111111
10101111
10101111
10101111
NAME newsflash (6,5)

TIL o0
00000000
11111111
11111111
11111111
11111111
00011110
01101110
01101110
NAME newsflash (7,5)

TIL o1
00000000
11111111
11111111
11111111
11111111
00110001
11010110
00110001
NAME newsflash (8,5)

TIL o2
00000000
11111111
11111111
11111111
11111111
11001100
10110101
10110100
NAME newsflash (9,5)

TIL o3
00000000
11111111
11111111
11111111
11111111
01110011
10101101
01100001
NAME newsflash (10,5)

TIL o4
00000000
11111111
11111111
11111111
11111111
00011011
01101011
00011011
NAME newsflash (11,5)

TIL o5
00000000
11111111
11111111
11111111
11111111
11011101
11011101
11100011
NAME newsflash (12,5)

TIL o6
00000000
11111111
11111111
11111111
11111111
11100111
11011110
11010010
NAME newsflash (13,5)

TIL o7
00001011
11111011
11111011
11111011
11111011
00111011
11011011
11011011
NAME newsflash (14,5)

TIL o8
11011110
11011110
11011111
11011111
11011111
11011111
11011111
11011111
NAME newsflash (1,6)

TIL o9
11101101
11110011
11111111
11111111
11110110
11110110
11110000
11110110
NAME newsflash (2,6)

TIL oa
01101111
10011110
11111111
11111111
11001101
10110100
10110101
10110101
NAME newsflash (3,6)

TIL ob
11010110
00110110
11111111
11111111
11010000
10010111
01010001
11010111
NAME newsflash (4,6)

TIL oc
10110101
11001110
11111111
11111111
11110011
11101101
11100001
11101101
NAME newsflash (5,6)

TIL od
10101111
01100001
11111111
11111111
01101000
00101011
01001011
01101011
NAME newsflash (6,6)

TIL oe
01101110
00011110
11111111
11111111
11111000
01110111
01111001
01111110
NAME newsflash (7,6)

TIL of
11110101
11110110
11111111
11111111
10000011
11101110
11101110
11101110
NAME newsflash (8,6)

TIL og
10110101
11001100
11111111
11111111
00110111
11010111
00011000
11011101
NAME newsflash (9,6)

TIL oh
10101101
01101101
11111111
11111111
01110000
01111101
11111101
11111101
NAME newsflash (10,6)

TIL oi
01101011
00011000
11111111
11111111
01011010
11011010
11000010
11011010
NAME newsflash (11,6)

TIL oj
11110111
01110111
11111111
11111111
00010001
11110110
00110001
11110101
NAME newsflash (12,6)

TIL ok
11011010
11100111
11111111
11111111
10000111
10111111
10001111
10111111
NAME newsflash (13,6)

TIL ol
11011011
00111011
01111011
11111011
11111011
11111011
11111011
11111011
NAME newsflash (14,6)

TIL om
11011111
11011111
11011111
11011111
11011111
11011110
11011110
11011110
NAME newsflash (1,7)

TIL on
11110110
11111111
11111111
11111111
11111111
00000000
00000000
00000000
NAME newsflash (2,7)

TIL oo
11001101
11111111
11111111
11111111
11111111
00000000
00000000
00000000
NAME newsflash (3,7)

TIL op
11010000
11111111
11111111
11111111
11111111
00000000
00000000
00000000
NAME newsflash (4,7)

TIL oq
11101101
11111111
11111111
11111111
11111111
00000000
00000000
00000000
NAME newsflash (5,7)

TIL or
01101000
11111111
11111111
11111111
11111111
00000000
00000000
00000000
NAME newsflash (6,7)

TIL os
11110001
11111111
11111111
11111111
11111111
00000000
00000000
00000000
NAME newsflash (7,7)

TIL ot
11101110
11111111
11111111
11111111
11111111
00000000
00000100
00001010
NAME newsflash (8,7)

TIL ou
11011101
11111111
11111111
11111111
11111111
00000000
00010001
00100000
NAME newsflash (9,7)

TIL ov
11111101
11111111
11111111
11111111
11111111
00000000
00000100
10001000
NAME newsflash (10,7)

TIL ow
11011010
11111111
11111111
11111111
11111111
00111100
00111101
00111101
NAME newsflash (11,7)

TIL ox
00010110
11111111
11111111
11111111
11111111
00000000
01111100
00000001
NAME newsflash (12,7)

TIL oy
10000111
11111111
11111111
11111111
11111111
00000000
00100001
10101101
NAME newsflash (13,7)

TIL oz
11111011
11111011
11111011
11111011
11111011
01111011
01111011
01111011
NAME newsflash (14,7)

TIL p0
00000001
00000111
00001111
00001111
00011110
00011111
00011110
00001111
NAME newsflash (2,8)

TIL p1
11000000
11110000
00101000
01010000
10101000
01010100
10101000
01010000
NAME newsflash (3,8)

TIL p3
00000000
00000000
00000000
00000000
00000000
00110000
00000000
00000011
NAME newsflash (5,8)

TIL p4
00000000
00000000
00000000
00000010
00000000
00000000
00011111
11111111
NAME newsflash (6,8)

TIL p5
00000000
00000000
00000000
00000000
00011110
00110111
11111111
11111111
NAME newsflash (7,8)

TIL p6
00000100
00001010
00000100
00001010
00000101
11111010
11110100
11111010
NAME newsflash (8,8)

TIL p7
00010001
00100000
00010001
10101010
01010101
00100000
00010001
00100000
NAME newsflash (9,8)

TIL p8
00000100
10001000
00000100
10101010
01010101
10001000
00000100
10001000
NAME newsflash (10,8)

TIL p9
00111100
00111111
00111111
10111100
00111111
00111100
00111111
00111100
NAME newsflash (11,8)

TIL pa
00000000
11111111
11111111
00000000
11111111
00100000
11111111
00001000
NAME newsflash (12,8)

TIL pb
00000000
11111111
11111111
00001000
11111111
01000000
11111111
10001000
NAME newsflash (13,8)

TIL pc
01111011
11111011
11111011
01111011
11111011
11111011
11111011
01111011
NAME newsflash (14,8)

TIL pd
00001111
00000111
00000000
00000000
00000000
00000000
00000000
00000000
NAME newsflash (2,9)

TIL pe
10101000
11010000
11100000
00000000
00000000
00000000
00000001
01111111
NAME newsflash (3,9)

TIL pf
00000000
00000000
00000000
00000000
00000000
11111111
11111101
11111111
NAME newsflash (4,9)

TIL pg
00011111
00000000
00000000
00000000
00000000
00000000
11110000
11111111
NAME newsflash (5,9)

TIL ph
01111111
11111111
00011111
00000000
00000000
00100000
00000000
11000000
NAME newsflash (6,9)

TIL pi
11111111
11111111
01110111
00011111
00000000
00000000
00000000
00000000
NAME newsflash (7,9)

TIL pj
11110100
11111010
10000101
00001010
00000100
00001110
00000100
00001110
NAME newsflash (8,9)

TIL pk
00010001
00100000
01010101
11101010
00010001
00100000
00110001
00110001
NAME newsflash (9,9)

TIL pl
10000100
10001000
01010101
10101010
00000100
10001000
00000100
10001000
NAME newsflash (10,9)

TIL pm
00111111
00111100
00111111
10111100
00111111
00111111
00111100
00111101
NAME newsflash (11,9)

TIL pn
00001111
00000000
00001000
00000000
00000000
00000000
00000000
00000000
NAME newsflash (3,10)
WAL true

TIL po
11111111
00010111
00000000
00000000
00000000
00000000
00000000
00000000
NAME newsflash (4,10)
WAL true

TIL pp
11110000
10000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME newsflash (5,10)
WAL true

TIL pq
00000110
00001111
00001111
00001110
00001110
00001110
00001110
00001110
NAME newsflash (8,10)
WAL true

TIL pr
00110001
11111111
11111111
00110001
00110001
00110001
00110001
00110001
NAME newsflash (9,10)
WAL true

TIL ps
00000100
10101010
11010101
10001000
10000100
10001000
10000100
10001000
NAME newsflash (10,10)
WAL false

TIL pt
00111101
10111101
00111101
00111101
00111101
00111101
00111101
00111101
NAME newsflash (11,10)

TIL pu
11001111
11110110
11111000
11110000
10000000
11100000
11100000
11100000
NAME newsflash (12,10)

TIL pv
01111111
11011111
00111111
10011011
01000111
00001111
00001111
00000111
NAME newsflash (13,10)

TIL pw
00001111
00001011
00001010
00001010
00001010
00001010
00001010
00001011
NAME newsflash (8,11)

TIL px
11111111
11111111
00110001
00110001
00110001
00110001
00110001
11111111
NAME newsflash (9,11)
WAL true

TIL py
11110101
11111010
10001100
10001000
10001100
10001100
10001100
11111110
NAME newsflash (10,11)

TIL pz
00111101
10111101
00111101
00111101
00111101
00111101
00111100
10111111
NAME newsflash (11,11)

TIL q0
11000000
00110000
11111000
11100111
11111110
11111111
00000000
11111111
NAME newsflash (12,11)

TIL q1
00001011
00011111
00011111
01101111
11111111
11111111
00000000
11111111
NAME newsflash (13,11)

TIL q2
01111011
01111011
01111011
01111011
01111011
01111011
01111011
11111011
NAME newsflash (14,11)
WAL false

TIL q3
10101100
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME newsflash (3,12)
WAL true

TIL q4
11010010
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME newsflash (6,12)
WAL true

TIL q5
11011011
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME newsflash (7,12)
WAL true

TIL q6
11111111
00111100
00111111
00111100
00111111
00111100
00111111
00111100
NAME newsflash (11,12)
WAL true

TIL q7
11111111
00000000
11111111
00001000
11111111
00001000
11111111
00000000
NAME newsflash (12,12)

TIL q8
11111111
00000100
11111111
00010000
11111111
10000000
11111111
00010001
NAME newsflash (13,12)

TIL q9
11111011
01111011
11111011
01111011
11111011
01111011
11111011
11111011
NAME newsflash (14,12)
WAL false

TIL qa
11011110
11011110
11011110
11011110
11011111
11011111
11011110
11011110
NAME newsflash (1,13)
WAL true

TIL qb
00000000
00000000
00000000
00000000
11111111
11111111
01100010
00100111
NAME newsflash (2,13)
WAL true

TIL qc
00000000
00000000
00000000
00000000
11111111
11111111
00100011
01110110
NAME newsflash (3,13)
WAL true

TIL qd
00000000
00000000
00000000
00000000
11111111
11111111
00100010
00110110
NAME newsflash (4,13)
WAL true

TIL qe
00000000
00000000
00000000
00000000
11111111
11111111
00111100
10111101
NAME newsflash (5,13)
WAL true

TIL qf
00000000
00000000
00000000
00000000
11111111
11111111
01000111
01010111
NAME newsflash (6,13)
WAL true

TIL qg
00000000
00000000
00000000
00000000
11111111
11111111
10101000
10001101
NAME newsflash (7,13)
WAL true

TIL qh
00000000
00000000
00000000
00000000
11111111
11111111
10001010
10011010
NAME newsflash (8,13)
WAL true

TIL qi
00000000
00000000
00000000
00000000
11111111
11111111
11001111
11011111
NAME newsflash (9,13)
WAL true

TIL qj
00000000
00000000
00000000
00000000
11111111
11111111
11111111
11111111
NAME newsflash (10,13)
WAL true

TIL qk
00111111
00111100
00111111
00111100
11111111
11111100
11111111
11111100
NAME newsflash (11,13)

TIL ql
11111111
00100000
11111111
01000000
11111111
00000000
11111111
00100000
NAME newsflash (12,13)

TIL qm
11111111
00100000
11111111
10001000
11111111
00001000
11111111
01000000
NAME newsflash (13,13)

TIL qn
11011110
11011111
11011111
11011110
11011110
11011110
11011111
11011111
NAME newsflash (1,14)
WAL false

TIL qo
00101010
11111111
11111111
01100010
01101010
00100010
11111111
11111111
NAME newsflash (2,14)

TIL qp
00110110
11111111
11111111
00101010
11100110
00101010
11111111
11111111
NAME newsflash (3,14)

TIL qq
10100010
11111111
11111111
01100010
10101010
00100010
11111111
11111111
NAME newsflash (4,14)

TIL qr
10111100
11111111
11111111
10100011
00101011
00101011
11111111
11111111
NAME newsflash (5,14)

TIL qs
01010111
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME newsflash (6,14)

TIL qt
11011000
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME newsflash (7,14)

TIL qu
10101000
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME newsflash (8,14)

TIL qv
10011111
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME newsflash (9,14)

TIL qw
11111111
11111100
11111111
11111100
11111111
11111100
11111111
11111111
NAME newsflash (11,14)

TIL qx
11111111
00001000
11111111
00000010
11111111
00000100
11111111
11111111
NAME newsflash (12,14)

TIL qy
11111111
10001000
11111111
00000000
11111111
00101111
11111111
11111111
NAME newsflash (13,14)

TIL qz
11111011
01111011
11111011
11111011
11111011
11111011
11111011
11111011
NAME newsflash (14,14)
WAL false

TIL r0
00000010
11111111
00001000
11111111
00000101
11111111
00000000
11111111
NAME newsflash (2,15)

TIL r1
00000010
11111111
00000001
11111111
00000001
11111111
00000010
11111111
NAME newsflash (3,15)

TIL r2
00000101
11111111
00000001
11111111
01100001
11111111
00000001
11111111
NAME newsflash (4,15)

TIL r3
00000000
11111111
00010000
11111111
00000000
11111111
00000000
11111111
NAME newsflash (6,15)

TIL r4
10000000
11111111
00010000
11111111
01000000
11111111
00010000
11111111
NAME newsflash (7,15)

TIL r5
00001011
11111111
01000000
11111111
01000000
11111111
00010000
11111111
NAME newsflash (9,15)

TIL r6
00000000
11111111
00000000
11111111
10000010
11111111
00100000
11111111
NAME newsflash (10,15)

TIL r7
00011100
11111101
00011101
11111101
00011101
11111101
10011101
11111101
NAME newsflash (11,15)

TIL r8
00000000
11111111
11111111
11111111
11100000
11100000
10000000
00000011
NAME newsflash (12,15)

TIL r9
00000000
11111111
11111111
11111111
00000011
00000011
00000001
11000001
NAME newsflash (13,15)

TIL ra
11111111
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME newsflash ground
WAL true

TIL rc
11011110
11011110
11011110
11011110
11011110
11011110
11011110
11011110
NAME newsflash side
WAL true

TIL p2
11111111
11111111
11111110
11111100
11111001
11111010
11111001
11111010
NAME zoom (0,1)

TIL rf
11111111
11111111
00000000
10101010
01010101
10101010
01010101
10101010
NAME zoom (1,1)

TIL rg
11111111
11111111
00000000
10101010
01010101
10101010
01010100
10101010
NAME zoom (7,1)

TIL rh
11111111
11111111
00000000
10101010
01010101
00101010
00010101
00101010
NAME zoom (8,1)

TIL ri
11111111
11111111
01111111
10111111
01011111
10011111
01011111
10011111
NAME zoom (15,1)

TIL rj
11111001
11111010
11111001
11111010
11111001
11111010
11111001
11111010
NAME zoom (0,2)

TIL rk
01010101
10101010
01010000
10100111
01010110
10100110
01010110
10100111
NAME zoom (1,2)
WAL true

TIL rl
01010101
10101010
00000000
11111111
00100010
10101010
00100010
11111111
NAME zoom (2,2)
WAL true

TIL rm
01010101
10101010
00000000
11111111
00111111
10111101
00111111
11111111
NAME zoom (3,2)
WAL true

TIL rn
01010101
10101010
00000000
11111111
11111011
00001011
11111011
11111111
NAME zoom (4,2)
WAL true

TIL ro
01010101
10101010
00000000
11111111
11111111
10000100
11111111
11111111
NAME zoom (5,2)
WAL true

TIL rp
01010101
10101010
00000000
11111111
11111011
01011011
11111011
11111111
NAME zoom (6,2)
WAL true

TIL rq
01010101
10101010
00000000
11111111
11111111
10000010
11111111
11111111
NAME zoom (7,2)
WAL true

TIL rr
01010101
10101010
00000000
11111111
11111111
10000001
11111111
11111111
NAME zoom (8,2)
WAL true

TIL rs
01010101
10101010
00000000
11111111
11111111
11111111
11111111
11111111
NAME zoom (9,2)
WAL true

TIL rt
01010101
10101010
00000101
11101010
11100101
11101010
11100101
11101010
NAME zoom (14,2)
WAL true

TIL ru
01011111
10011111
01011111
10011111
01011111
10011111
01011111
10011111
NAME zoom (15,2)
WAL false

TIL rv
01010000
10100111
01010111
10100111
01010111
10100111
01010111
10100111
NAME zoom (1,3)
WAL true

TIL rw
00000000
11111111
11111111
11000000
11011111
11011111
11011111
11011111
NAME zoom (2,3)

TIL ry
00000000
11111111
11111111
00000000
01111111
01111111
01111111
01111111
NAME zoom (6,3)

TIL rz
00000000
11111111
11111111
00000000
11111110
11111110
11111110
11111110
NAME zoom (9,3)

TIL s0
00000000
11111111
11111111
00000011
11111011
11111011
11111011
11111011
NAME zoom (13,3)

TIL s1
00000101
11101010
11100101
11101010
11100101
11101010
11100101
11101010
NAME zoom (14,3)
WAL true

TIL s2
01010111
10100111
01010111
10100111
01010111
10100111
01010111
10100111
NAME zoom (1,4)
WAL true

TIL s3
11111100
11110000
11110000
11100000
11000000
11000100
10000000
00000000
NAME zoom (3,4)

TIL s4
00011111
00001111
00000111
00000111
00000011
00100011
00000001
00000000
NAME zoom (4,4)

TIL s5
11111100
11110000
11110000
11100000
11000000
11000100
11000000
11000000
NAME zoom (7,4)

TIL s6
00011111
00001111
00000111
00000111
00000011
00100011
00000011
00000111
NAME zoom (8,4)

TIL s7
11111111
11111111
11111111
11111111
11110000
11110000
11100001
10000001
NAME zoom (10,4)

TIL s8
11110000
11000000
11000000
00000000
00000000
00010000
00000000
00000000
NAME zoom (11,4)

TIL s9
01111111
00111111
00011111
00001111
00000000
10000000
00001000
00001000
NAME zoom (12,4)

TIL sa
11100101
11101010
11100101
11101010
11100101
11101010
11100101
11101010
NAME zoom (14,4)
WAL true

TIL sb
11011100
11011111
11011111
11011111
11011111
11011111
11011111
11011111
NAME zoom (2,5)

TIL sc
00000010
10000001
11110000
11111000
11110000
11100000
11000000
10000000
NAME zoom (3,5)

TIL sd
01000000
10000000
00001111
00011111
00011111
00001111
00000111
00000011
NAME zoom (4,5)

TIL se
00111111
01111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME zoom (5,5)

TIL sf
11100011
11100001
11110000
11111000
11110000
11100000
11000000
10000000
NAME zoom (7,5)

TIL sg
11000111
10000111
00001111
00011111
00011111
00001111
00000111
00000011
NAME zoom (8,5)

TIL sh
11000011
11111111
11111111
11111111
11111111
11111111
11111111
11111110
NAME zoom (10,5)

TIL si
00001001
10000110
11000000
11100000
11000000
10000000
00000000
00000000
NAME zoom (11,5)

TIL sj
00001100
00011111
00111111
01111111
01111111
00111111
00011111
00001111
NAME zoom (12,5)

TIL sk
00111011
11111011
11111011
11111011
11111011
11111011
11111011
11111011
NAME zoom (13,5)

TIL sm
00000000
11111111
11111111
11111111
11111111
11111100
11110000
11110000
NAME zoom (3,6)

TIL sn
00000000
11111111
11111111
11111111
11111111
00011111
00001111
00000111
NAME zoom (4,6)

TIL so
00000000
01111111
01111111
01111111
01111111
01111111
01111111
01111111
NAME zoom (6,6)

TIL sp
00000000
11111110
11111110
11111110
11111110
11111110
11111110
11111110
NAME zoom (9,6)

TIL sq
11111100
00000000
11111111
11111111
11111111
11111111
11111111
11111111
NAME zoom (10,6)

TIL sr
00000000
11111111
11111111
11111111
11101010
10100000
00000000
00000000
NAME zoom (11,6)

TIL ss
00000000
11111111
11111111
11111111
10111111
00011111
00011111
00001111
NAME zoom (12,6)

TIL st
00000011
11111011
11111011
11111011
11111011
11111011
11111011
11111011
NAME zoom (13,6)

TIL su
11100000
11000000
11000100
11000000
11000000
11100010
11100001
11110000
NAME zoom (3,7)

TIL sv
00000111
00000011
00100011
00000011
00000111
01000111
10000111
00001111
NAME zoom (4,7)

TIL sw
11100000
11000000
11000100
10000000
10000000
00000010
10000001
11110000
NAME zoom (7,7)

TIL sx
00000111
00000011
00100011
00000001
00000001
01000001
10000000
00001111
NAME zoom (8,7)

TIL sy
00000000
00000000
00010000
00000000
00000000
10001111
10000110
11000000
NAME zoom (11,7)

TIL sz
00001111
00001111
10001111
00001111
00011111
00011111
00011111
00111111
NAME zoom (12,7)

TIL t0
11011111
11011111
11011111
11011111
11011111
11011111
11000000
11011111
NAME zoom (2,8)

TIL t1
11111000
11110000
11100000
11000000
10000000
00000000
00000000
11111111
NAME zoom (3,8)

TIL t2
00011111
00011111
00001111
00000111
00000011
00000001
00000000
11111111
NAME zoom (4,8)

TIL t3
01111111
01111111
01111111
01111111
01111111
01111111
00000000
01111111
NAME zoom (6,8)

TIL t4
11111110
11111110
11111110
11111110
11111110
11111110
00000000
11111110
NAME zoom (9,8)

TIL t5
11111111
11111111
11111111
11111111
11111110
11111100
00000000
11111111
NAME zoom (10,8)

TIL t6
11100000
11000000
10000000
00000000
00000000
00000000
00000000
11111111
NAME zoom (11,8)

TIL t7
01111111
01111111
00111111
00011111
00001111
00000111
00000000
11111111
NAME zoom (12,8)

TIL t8
11111011
11111011
11111011
11111011
11111011
11111011
00000011
11111011
NAME zoom (13,8)

TIL t9
11111111
11100111
11000010
10000000
10000000
10000000
10000000
11100001
NAME zoom (3,9)

TIL ta
11111111
11111110
00000100
00000000
00000000
00000000
00000000
00001000
NAME zoom (4,9)

TIL tb
11111111
00111111
00011111
00011111
00011111
00111111
01111111
01111111
NAME zoom (5,9)

TIL tc
11111111
11111111
11111100
11110000
11110000
11100000
11000000
11000100
NAME zoom (7,9)

TIL td
11111111
11111111
00011111
00001111
00000111
00000111
00000011
00100011
NAME zoom (8,9)

TIL te
11111111
11111111
11110000
11000000
11000000
10000000
00000000
00010000
NAME zoom (11,9)

TIL tf
11111111
11111111
01111111
00111111
00011111
00011111
00001111
10001111
NAME zoom (12,9)

TIL tg
11110000
11110000
11110000
11111000
11111100
11111110
11111100
11111000
NAME zoom (3,10)

TIL th
00000000
00000000
11110000
01100001
00000011
00000111
00000111
00000011
NAME zoom (4,10)

TIL ti
01111111
01111111
01111100
01111111
01111111
01111111
01111111
01111111
NAME zoom (6,10)

TIL tj
10000000
00000000
00000011
10000001
11110000
11111000
11110000
11100000
NAME zoom (7,10)

TIL tk
00000001
00000000
11000000
10000000
00001111
00011111
00011111
00001111
NAME zoom (8,10)

TIL tl
11111110
11111110
00111110
01111110
11111110
11111110
11111110
11111110
NAME zoom (9,10)

TIL tm
00000000
00000000
10000110
10000110
11000000
11100000
11000000
10000000
NAME zoom (11,10)

TIL tn
00001111
00011111
00011111
00011111
00111111
01111111
01111111
00111111
NAME zoom (12,10)

TIL to
01010111
10100111
01010111
10100111
01010111
10100111
01010000
10101010
NAME zoom (1,11)
WAL true

TIL tp
11011111
11011111
11011111
11000000
11111111
11111111
00000000
10101010
NAME zoom (2,11)
WAL true

TIL tq
11110000
11100000
11000000
00000000
11111111
11111111
00000000
10101010
NAME zoom (3,11)
WAL true

TIL tr
00000001
00000000
00000000
00000000
11111111
11111111
00000000
10101010
NAME zoom (4,11)
WAL true

TIL ts
11111111
11111111
01111111
00000000
11111111
11111111
00000000
10101010
NAME zoom (5,11)
WAL true

TIL tt
01111111
01111111
01111111
00000000
11111111
11111111
00000000
10101010
NAME zoom (6,11)
WAL true

TIL tu
11000000
10000000
00000000
00000000
11111111
11111111
00000000
10101010
NAME zoom (7,11)
WAL true

TIL tv
00000111
00000011
00000001
00000000
11111111
11111111
00000000
10101010
NAME zoom (8,11)
WAL true

TIL tw
11111110
11111110
11111110
00000000
11111111
11111111
00000000
10101010
NAME zoom (9,11)
WAL true

TIL tx
11111111
11111111
11111111
00000000
11111111
11111111
00000000
10101010
NAME zoom (10,11)
WAL true

TIL u0
11111011
11111011
11111011
00000011
11111111
11111111
00000000
10101010
NAME zoom (13,11)
WAL true

TIL u1
11100101
11101010
11100101
11101010
11100101
11101010
00000101
10101010
NAME zoom (14,11)
WAL true

TIL u2
11111001
11111010
11111001
11111010
11111001
11111100
11111110
11111111
NAME zoom (0,12)

TIL u3
01010101
10101010
01010101
10101010
01010101
10101010
00000000
11111111
NAME zoom (1,12)

TIL u4
01010101
10101010
01010101
10101010
01010101
10101010
00000000
11111100
NAME zoom (5,12)

TIL u5
01010101
10101010
01010101
10101010
01010101
10101010
00000000
10101010
NAME zoom (6,12)

TIL u6
01010101
10101010
01010101
10101010
01010101
10101010
00000000
10111111
NAME zoom (10,12)

TIL u7
01011111
10011111
01011111
10011111
01011111
10111111
01111111
11111111
NAME zoom (15,12)

TIL u8
11111101
11111100
11111101
11111100
11111101
11111100
11111101
11111100
NAME zoom (5,13)

TIL u9
01010101
10101010
01010101
10101010
01010101
10101010
01010101
10101010
NAME zoom (6,13)

TIL ua
00111111
10111111
00111111
10111111
00111111
10111111
00111111
10111111
NAME zoom (10,13)

TIL ub
11111111
11000000
10010101
10101010
10010101
10101010
10010101
10101000
NAME zoom (1,14)

TIL uc
11111111
00000000
01010101
10101010
01010101
10101010
01010101
00000000
NAME zoom (2,14)

TIL ud
11111101
00000000
01010101
10101010
01010101
10101010
01010101
00000000
NAME zoom (5,14)

TIL ue
01010101
00000000
01010101
10101010
01010101
10101010
01010101
00101010
NAME zoom (6,14)

TIL uf
01010101
00000000
01010101
10101010
01010101
10101010
01010101
10101010
NAME zoom (7,14)

TIL ug
00111111
00000000
01010101
10101010
01010101
10101010
01010101
10101010
NAME zoom (10,14)

TIL uh
11111111
00000000
01010101
10101010
01010101
10101010
01010101
10101010
NAME zoom (11,14)

TIL ui
11111111
00000011
01010101
10101001
01010101
10101001
01010101
10101001
NAME zoom (14,14)

TIL uj
10010101
10101000
10010101
10101000
10010100
10101010
10010101
10000000
NAME zoom (1,15)

TIL uk
01010101
10101010
01010101
10101010
00000000
10101010
01010101
00000000
NAME zoom (2,15)

TIL ul
01010101
00101010
01010101
00101010
01010101
10101010
01010101
00000000
NAME zoom (6,15)

TIL um
01010101
10101010
01010101
10101010
01010101
10101010
01010101
00000000
NAME zoom (7,15)

TIL un
01010101
10101001
01010101
10101001
01010101
10101001
01010101
00000001
NAME zoom (14,15)

TIL uo
11111111
11111111
11111111
11111111
01111111
10111111
11000000
11000000
NAME zoomcambg1

TIL up
11000000
11000000
11000000
11000000
11000000
11111111
11111111
11111111
NAME zoomcambg2

TIL uq
11111111
11111111
11111111
11111111
11111111
11111111
00011011
00010011
NAME zoomcambg3

TIL ur
00000011
00000011
00000011
00010011
00001011
11110111
11111011
11111111
NAME zoomcambg4

TIL ut
01000001
10010100
01000001
00000000
00000000
11000011
11000011
11011011
>
01000001
10101000
01000001
10000001
00000000
11000011
11000001
11011111
NAME alb1bg

TIL uu
11000011
10000001
00101000
11000011
10000001
01000010
11000011
11011011
>
11000011
10101001
00000000
11000011
00000000
11000011
11000011
11101011
NAME alb2bg

TIL uv
01000001
10101000
01000001
00000000
00000000
11000011
11000011
11011011
>
01101001
10000000
01000000
10000001
00000000
11000011
11000001
11011111
NAME alb3bg

TIL uw
01000001
10100100
00000000
11000011
00000000
11000011
11000011
11011011
>
01000001
10000000
00100100
11000011
00000000
01000010
11000011
11101011
NAME alb4bg

TIL ux
11000011
10101001
11000010
11000011
10000001
01000010
11000011
11011011
>
11000011
10101000
11000011
11000011
10000001
01000010
11000011
10111011
NAME alb5bg

TIL uy
11000011
10101001
10000001
11000011
10000001
01000010
11000011
11011011
>
11000011
10000001
10010101
11000011
00000000
11000011
11000011
11011101
NAME alb6bg

TIL uz
11000011
00101000
10000001
11000011
10000001
01000010
11000011
11011011
>
11000011
10000001
00010100
11000011
00000000
11000011
11000011
11011101
NAME alb7bg

TIL va
11000011
11011011
00000000
11000011
11000011
11011011
11011011
11011011
>
11000011
11011011
11000011
10000000
01000011
11011011
11011001
11011111
NAME alb8bg

TIL vb
11000011
10010101
11000011
11000011
10000001
01000010
11000011
11011011
>
11000011
10010101
11000011
01000010
10000001
11000011
11000011
11011011
NAME alb9bg

TIL vc
01000010
10010101
11000011
00000000
11000011
11000011
11000011
11011011
>
11000011
00101000
11000011
10000001
01000010
11000011
11000001
11011111
NAME alb10bg

TIL vd
00000000
10000000
00000111
00111111
11111101
11111111
11111111
11111111
NAME sunset cloud1

TIL ve
11011111
01111110
00000000
00000000
00000000
00000000
00000000
00000000
NAME sunset cloud2

TIL vf
00000000
00000000
00000000
00000000
00000000
00000011
00000011
00111111
NAME sunset cloud3

TIL vh
00000011
00000000
00000110
00000000
00000000
00000000
00000000
00000000
NAME sunset cloud5

TIL vi
00000000
00001111
01111111
11111111
11011111
01111111
00111110
00000000
NAME sunset cloud6

TIL vj
00000000
00000000
00100000
00000011
00011111
00000000
00000000
00000000
NAME sunset cloud7

TIL vk
00000000
00000000
11110000
11011111
11111111
11111111
11110000
00000000
NAME sunset cloud7

TIL vl
00000000
00000000
00000000
00001000
11000000
11111000
00000000
00110000
NAME sunset cloud8

TIL vn
00000000
00000000
00000000
00000000
11100001
10111100
11111111
11000000
NAME sunset cloud 9

TIL vo
00000000
00000011
00011111
01111111
11111111
00011111
00000011
00000000
NAME sunset cloud 10

TIL vp
00000000
11100000
11110111
11111111
11111111
11111111
01111110
00000000
NAME sunset cloud 11

TIL vq
00000000
00000000
00000000
00000000
00000111
00000000
00001000
00000000
NAME sunset cloud 12

TIL vr
00000000
00000000
11100100
01110000
11111110
11100000
00000011
00000000
NAME sunset cloud 13

TIL vs
00000000
00000001
00000010
01100100
00010100
00010100
00000000
00000000
NAME sunset grass

TIL vt
00000000
00000100
10001010
01001000
00101001
00101010
00101010
00000000
NAME sunset grass 2

TIL vu
00000000
00100010
01010101
00100010
00100010
10101010
11110110
01101011
NAME flowers

TIL vv
11000011
10010101
11000010
00000001
11000011
11000011
11000011
11011011
>
11000011
10010101
11000011
00000000
11000011
11000011
11000011
11011011
NAME u3a0

TIL vw
11000011
10101001
11000011
00000000
11000011
10000001
00000000
11011011
>
11000011
10101001
11000011
00000000
11000011
10000001
00000000
11011011
NAME u3a2

TIL vx
10000011
00010101
11000010
00000000
01000011
11000011
11000001
11011111
>
10000011
00010101
11000010
00000000
01000011
11000011
11000001
11011111
NAME u3a3

TIL vy
11000011
10010101
11000011
10000001
01000010
11000011
11000011
11101011
>
11000011
10010101
11000011
10000001
01000010
11000011
11000011
11101011
NAME u3a4

TIL vz
11000011
00010100
10000001
11000011
00000000
11000011
11000011
10111011
>
11000011
00010100
10000001
11000011
00000000
11000011
11000011
10111011
NAME u3a5

TIL wa
00111100
00101000
00111100
11111111
00111100
00111100
00111100
10100100
>
00111100
00101000
00111100
11111111
00111100
00111100
00111100
10100100
NAME lgbtq0

TIL wb
11000011
10010101
11000011
00000000
11000011
11000011
11000011
11011011
>
11000011
10101001
01000011
10000001
11000010
11000011
11000011
11011011
NAME lgbtq2

TIL wc
00111100
01010110
00111101
01111110
10111100
00111100
00111110
00100000
>
00111100
01010110
00111101
01111110
10111100
00111100
00111110
00100000
NAME lgbtq3

TIL wd
00111100
01101010
00111101
01111111
10111101
00111100
00111100
00010100
>
00111100
01101010
00111101
01111111
10111101
00111100
00111100
00010100
NAME lgbtq4

TIL we
11000011
10010100
11000001
11000011
00000000
11000011
11000011
10111011
>
11000011
10101001
11000000
01000011
10000000
11000011
11000011
10111011
NAME lgbtq5

TIL wf
00000000
01111111
01100001
01101101
01001001
01001001
01111111
01111111
>
00000000
01111111
01111111
01110000
01110110
01100100
01100100
01111111

TIL wg
11111111
11111111
11011111
11111111
11111101
11111111
11011111
11111111

TIL wh
11111111
11111111
11011111
10101111
11011111
11111111
11111101
11111111

TIL wi
11111111
11011011
11011111
00000111
11011111
11011111
11111101
01111111

TIL wj
11111111
11011011
10001111
11011111
11111111
11111011
11111111
10111111

TIL wk
11111111
11111011
11111111
11111111
11111111
11111111
11111011
11111111
>
11111111
11111111
11111111
10111111
11111111
11111111
11111011
11111111

TIL wl
11111111
10111101
11111010
11101101
11111111
11111111
10111011
11111111

TIL rb
11111111
11111111
11111111
11111011
11110001
11111011
11111111
11111111
NAME chords (0,0)

TIL rd
11111111
11111111
11111111
11111111
11111111
11111111
11111111
10110000
NAME chords (1,0)

TIL re
11111111
11111111
01111111
11111111
11111011
11111111
11111111
00000000
>
11111111
11111111
11111111
11111111
11111011
11111111
11111111
00000000
NAME chords (2,0)

TIL v0
11111111
11111111
11111101
11111111
11111111
11111111
11111111
00000000
NAME chords (3,0)

TIL v1
11111111
11111111
11111111
11111101
11111000
11111101
11111111
00000000
NAME chords (4,0)

TIL v2
11111111
11111111
11111111
11111111
11111111
11111111
11111111
00000000
NAME chords (5,0)

TIL v3
11111111
11111111
11110111
11111111
11111111
11111111
11111111
00000000
NAME chords (6,0)

TIL v4
11111111
11111111
11111111
11111111
11111111
11111111
11111111
00000000
>
11111111
11111111
11111111
11111111
10111111
11111111
11111111
00000000
NAME chords (7,0)

TIL v5
11111111
10111111
01011111
10111111
11111111
11111111
11111111
00000000
NAME chords (9,0)

TIL v6
11111111
11111111
11111101
11111111
11111111
01111111
11111111
00000000
NAME chords (12,0)

TIL v7
11111111
11111111
11111111
11111111
11111111
11111110
11111101
00001110
NAME chords (14,0)

TIL v8
11111111
11111111
11111111
11111111
11111111
11111111
01111111
11111111
NAME chords (15,0)

TIL v9
11111111
11111111
11111111
10000000
10111111
11011111
11101111
11110111
NAME chords (0,1)

TIL w0
11110111
11110111
11110111
00000111
11110111
11110111
11110111
11110111
NAME chords (1,1)

TIL w1
11111111
11111111
10000110
10111101
10001101
10111101
10111110
11111111
NAME chords (3,1)

TIL w2
11111111
11111111
01101101
10101101
10101101
10101101
01110011
11111111
NAME chords (4,1)

TIL w3
11111111
11111111
00011110
01101110
00011110
01011110
01101110
11111111
NAME chords (5,1)

TIL w4
11111111
11111111
00111001
11010110
00110000
11010110
00110110
11111111
NAME chords (6,1)

TIL w5
11111111
11111111
11000100
10111110
11001110
11110110
10001100
11111111
NAME chords (7,1)

TIL w6
11111111
11111111
01100111
11011011
11011111
11011011
01100111
11111111
NAME chords (8,1)

TIL w7
11111111
11111111
11001101
10110101
10111100
10110101
11001101
11111111
NAME chords (9,1)

TIL w8
11111111
11111111
10110011
10101101
00101101
10101101
10110011
11111111
NAME chords (10,1)

TIL w9
11111111
11111111
00011000
01101011
00011011
01011011
01101000
11111111
NAME chords (11,1)

TIL wm
11111111
11111111
11100011
01011111
01100111
01111011
11000111
11111111
NAME chords (12,1)

TIL wn
11101111
11101111
11101111
11100000
11101111
11101111
11101111
11101111
NAME chords (14,1)

TIL wo
11111111
11111111
11111111
00000001
11111101
11111011
11110111
11101111
NAME chords (15,1)

TIL wp
11110111
11111011
11111101
11111110
11111110
11111101
11111011
11111011
NAME chords (0,2)

TIL wq
11110111
11110111
11110110
11110110
11110110
11110110
11110110
11110111
NAME chords (1,2)

TIL wr
11111111
11111111
00011001
11110110
00110110
11110110
11111001
11111111
NAME chords (2,2)

TIL ws
11111111
11111111
10001111
10110111
10001111
10101111
10110111
11111111
NAME chords (3,2)

TIL wt
11111111
11111111
00001100
01111011
00011011
01111011
01111100
11111111
NAME chords (4,2)

TIL wu
11111111
11111111
11011010
01011010
01011010
01011010
11100110
11111111
NAME chords (5,2)

TIL wv
11111111
11111111
00111101
11011101
00111100
10111101
11011101
11111111
NAME chords (6,2)

TIL ww
11111111
11111111
10100001
01101111
11100011
01101111
10100001
11111111
NAME chords (7,2)

TIL wx
11111111
11111111
01110111
01110111
10001111
11011111
11011111
11111111
NAME chords (8,2)

TIL wy
11111111
11111111
10011100
01101011
01111011
01101011
10011100
11111111
NAME chords (9,2)

TIL wz
11111111
11111111
11011011
01001010
01010010
01011010
11011011
11111111
NAME chords (10,2)

TIL x0
11111111
11111111
00110000
11010111
11110001
11010111
00110000
11111111
NAME chords (11,2)

TIL x1
11111111
11111111
10001100
10110111
10001111
10111111
10111111
11111111
NAME chords (12,2)

TIL x2
11111111
11111111
00011000
01110111
01111001
01111110
01110001
11111111
NAME chords (13,2)

TIL x3
11011111
11011111
10111111
01111111
01111111
10111111
11011111
11101111
NAME chords (15,2)

TIL x4
11110111
11101111
11011111
10111111
10000000
11111111
11111111
11111111
NAME chords (0,3)

TIL x5
11110111
11110000
11111000
11111100
00000000
11111111
11111111
11111111
NAME chords (1,3)

TIL x6
11111111
00000000
11111111
11111111
11111111
01111111
11111111
11111111
NAME chords (4,3)

TIL x7
11111111
00000000
11111111
11111111
11111111
11111101
11111101
11110000
NAME chords (5,3)

TIL x8
11111111
00000000
11111111
11111111
11111111
11111111
11111111
01111111
NAME chords (6,3)

TIL x9
11111111
00000000
11111111
11111111
11111111
11111111
10111111
01011111
NAME chords (7,3)

TIL xa
11111111
00000000
11111111
11111111
11110111
11101011
11110111
11111111
NAME chords (9,3)

TIL xb
11111111
00000000
11111111
11111111
11111111
11110111
11111111
11111111
NAME chords (12,3)

TIL xc
11101111
00001111
00011111
00111111
00000000
11111111
11111111
11111111
NAME chords (14,3)

TIL xd
11101111
11110111
11111011
11111101
00000001
11111111
11111111
11111111
NAME chords (15,3)

TIL xe
11111111
11111111
11111111
11111111
11111111
01111111
10111111
01111111
NAME chords (1,4)

TIL xf
11111111
11111111
11111111
11111111
11111111
11111100
11111000
11111101
NAME chords (2,4)

TIL xg
11111111
11111111
11111111
11000111
00001000
01010101
10101010
01010101
NAME chords (3,4)

TIL xh
11110111
11111111
11111111
11111111
11111111
01111111
00111111
01111111
NAME chords (4,4)

TIL xi
11111101
11111101
11111111
11111111
11111111
11111111
11111111
11111111
NAME chords (5,4)

TIL xj
11111111
11111111
11111111
11001111
10110111
10111111
10110111
11001111
NAME chords (8,4)

TIL xk
11111111
11111111
11111111
11111111
11111111
11111110
11111111
11111111
>
11111111
11111111
11111111
11111111
11111111
11111110
11111111
11111111
NAME chords (9,4)

TIL xl
11111011
11111111
11111111
11111111
01111111
00111111
01111111
11111111
NAME chords (10,4)

TIL xm
11111111
11111111
11111111
11110000
11110111
11110001
11110111
11110111
NAME chords (12,4)

TIL xo
11111111
01111111
11111111
11111111
11111111
11110111
11111111
11111111
NAME chords (15,4)

TIL xp
11111000
11111100
11111110
11111110
11111110
11111110
11111110
11111110
NAME chords (2,5)

TIL xq
10101010
01010101
10101010
01010100
10101010
01010100
10101010
01010100
NAME chords (3,5)

TIL xr
11111111
11111111
11111111
11111111
11111111
11111111
11111111
11111110
>
11111111
11111111
11111111
11111111
11111111
11111111
11111111
11111110
NAME chords (5,5)

TIL xs
11111111
11111111
11111110
11111110
11111110
11011110
11111110
11111110
NAME chords (6,5)

TIL xt
11111111
11111111
00000000
00000000
11111110
11111110
11111110
11111110
NAME chords (7,5)

TIL xu
11111111
11111111
10000000
10000000
10111111
10111111
10111111
10111111
NAME chords (11,5)

TIL xv
11111111
11111111
00000000
00000000
10111111
10111111
10111111
10111111
NAME chords (12,5)

TIL xw
11111111
11111111
00000000
00000000
10111111
00011111
00011111
00011111
NAME chords (13,5)

TIL xx
11111111
11111111
00111111
00111111
10111111
10111111
10111111
10111101
NAME chords (14,5)

TIL xy
11111111
11111111
01111111
11111111
11111111
11111111
11111111
11111111
>
11111111
11111111
01111111
11111111
11111111
11111111
11101111
11111111
NAME chords (15,5)

TIL xz
11111111
11111111
11111111
11111100
11111111
11111111
11111111
11111111
NAME chords (1,6)

TIL y0
11111110
01111111
01111111
00011111
01111111
01111111
11111111
11111111
NAME chords (2,6)

TIL y1
10101010
01010100
00000001
01111101
01111101
01111101
01111101
01111101
NAME chords (3,6)

TIL y2
11111111
11110111
11100011
11110111
11111111
11111111
11111111
11111111
NAME chords (4,6)

TIL y3
11111110
00000000
11111110
11111110
11111110
11111110
11111110
00000000
NAME chords (7,6)

TIL y4
10111111
10000000
10111111
00011111
00011111
00011111
10111111
10000000
NAME chords (11,6)

TIL y5
10111111
00000000
10111111
10111111
10111111
10111111
10111111
00000000
NAME chords (12,6)

TIL y6
10111111
00111111
10111111
10111111
10111111
10111111
10111111
00111111
NAME chords (14,6)

TIL y7
01111101
01111101
01111101
01111101
01111101
01111101
01111101
01111101
NAME chords (3,7)

TIL y8
11101111
11111111
11111111
11111111
11111111
11111101
11111111
11111111
>
11101111
11111111
11111111
11111111
11111111
01111101
11111111
11111111
NAME chords (5,7)

TIL y9
11111110
11111110
11111110
11111110
11111110
00000000
11111110
11111110
NAME chords (7,7)

TIL ya
11111110
11111100
11111100
11111100
11111110
00000000
11111110
11111110
NAME chords (9,7)

TIL yb
11111111
01111111
01111111
01101111
11111111
11111111
11111111
11111111
NAME chords (10,7)

TIL yc
10111111
10111111
10111111
10111111
10111111
10000000
10111111
10111111
NAME chords (11,7)

TIL yd
10111111
10111111
10111111
10111111
10111111
00000000
10111111
10111111
NAME chords (12,7)

TIL ye
10111111
10111111
10111111
10111111
10111111
00111111
10111111
10111111
NAME chords (14,7)

TIL yf
11111111
11111111
11111111
10111111
00011111
10111111
11111111
11111111
NAME chords (15,7)

TIL yg
11111111
11111111
11111111
11111101
11111111
11111111
11111111
11111111
NAME chords (0,8)

TIL yh
11101111
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME chords (1,8)

TIL yi
11111111
11111111
11111111
11111111
11111111
11111111
11111011
11110101
NAME chords (4,8)

TIL yj
11111110
11111110
11111110
00000000
11111110
11111110
11111110
11111110
NAME chords (7,8)

TIL yk
10111111
10111111
10111111
10000000
10111111
10111111
10111111
10111111
NAME chords (11,8)

TIL yl
10111111
10111111
10111111
00000000
10111111
10111111
10111111
10111111
NAME chords (12,8)

TIL ym
10111111
10111111
10111111
00111111
10111111
10111111
10111111
10111111
NAME chords (14,8)

TIL yn
10111111
01111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME chords (2,9)

TIL yo
11111011
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME chords (4,9)

TIL yp
11111111
11111111
11111111
11111111
11111110
11111101
11111110
11111111
NAME chords (5,9)

TIL yq
11111110
11111110
11111111
11111111
11111111
01111111
11111111
11111111
NAME chords (6,9)

TIL yr
11111110
00000000
11111111
11111111
11111111
11111111
11111111
11111111
NAME chords (7,9)

TIL ys
11111111
11111111
11111111
11111111
11101111
11111111
11111111
11111111
NAME chords (10,9)

TIL yt
10111111
10000000
11111111
11111111
11111111
11110111
11101011
11110111
NAME chords (11,9)

TIL yu
10111111
00111111
11011111
11111111
11111111
11111101
11111111
01111111
NAME chords (14,9)

TIL yv
11111111
11111111
11111101
11111000
11111101
11111111
11111111
11111111
NAME chords (0,10)

TIL yw
11111111
11110000
11100111
11001111
10011111
00111111
01111111
01111111
NAME chords (2,10)

TIL yx
01111101
01111100
01111101
01111101
00000001
11111111
11111111
11111111
NAME chords (3,10)

TIL yy
11111111
00011111
11001111
11100111
11110011
11111011
11111001
11111101
NAME chords (4,10)

TIL yz
01111111
11111110
11111101
11111100
11111101
11111101
11111111
11111111
NAME chords (7,10)

TIL z0
11111111
01101110
10100100
00101010
10101110
10101110
11111111
11111111
NAME chords (8,10)

TIL z1
11111111
11111110
11111111
11111111
11111111
11111111
11111111
11111111
NAME chords (10,10)

TIL z2
11111111
11111001
11110111
11110100
11110110
11111001
11111111
11111111
NAME chords (12,10)

TIL z3
11111111
11111111
11111111
11111111
11111111
11111111
11111111
10111111
NAME chords (15,10)

TIL z4
01111111
01111111
01111111
10111110
10111110
10111110
10111110
10111110
NAME chords (2,11)

TIL z5
11111111
10000011
00000001
00000000
00000000
00000000
00000000
00000000
NAME chords (3,11)

TIL z6
11111101
11111101
11111101
11111001
11111011
11111011
11111011
11111011
NAME chords (4,11)

TIL z7
11111111
11111111
11111111
11111111
11111011
11111111
11111111
11111111
>
11111111
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME chords (5,11)

TIL z8
00000000
00000000
11111110
11111110
11111110
11111110
11111110
00000000
NAME chords (7,11)

TIL z9
11111111
11111111
11111111
11111111
11111111
11111111
11111111
11111111
>
11111111
11111111
11111111
11111111
11110111
11111111
11111111
11111111
NAME chords (10,11)

TIL za
10000000
10000000
10111111
10111111
10111111
10111111
10111111
10000000
NAME chords (11,11)

TIL zb
00000000
00000000
10111111
10111111
10111111
10111111
10111111
00000000
NAME chords (12,11)

TIL zc
00111111
00111111
10111111
10111111
10111111
10111110
10111111
00111111
NAME chords (14,11)

TIL zd
11111111
11111111
11111111
11111111
11111111
11111011
11111111
11111111
NAME chords (15,11)

TIL ze
11111111
11111111
01111111
11111111
11111110
11111110
11111101
11111101
NAME chords (1,12)

TIL zf
10111111
10111111
10111111
01111111
11111111
11111111
11111111
11111111
NAME chords (2,12)

TIL zg
00000001
10000011
11111111
11111111
11111111
11111111
11111111
11111111
NAME chords (3,12)

TIL zh
11111011
11111011
11111101
11111101
11111110
11111110
11111111
11111111
NAME chords (4,12)

TIL zi
11111111
11111111
11111111
11111111
11111111
01111111
01111111
01111111
NAME chords (5,12)

TIL zj
11111110
11111100
01111100
11111100
11111110
11111110
11111110
11111110
NAME chords (6,12)

TIL zk
11111110
01111110
01111110
01111110
11111110
00000000
11111110
11111110
NAME chords (7,12)

TIL zl
10111111
00011111
00011111
00011111
10111111
00000000
10111111
10111111
NAME chords (12,12)

TIL zm
10111111
10111111
10111111
10111111
10111111
00000000
10111111
00011111
NAME chords (13,12)

TIL zn
10111111
00011111
00011111
00011111
10111111
00111111
10111111
10111111
NAME chords (14,12)

TIL zo
11111101
11111011
11111011
11110111
11110111
11110111
11110111
11110111
>
10111101
11111011
11111011
11110111
11110111
11110111
11110111
11110111
NAME chords (1,13)

TIL zp
11111111
11111000
11111010
11111001
11111000
11111111
11111111
11111111
NAME chords (2,13)

TIL zq
11111111
00000000
10101010
01010101
00000000
11111111
11111111
11111111
NAME chords (3,13)

TIL zr
11111111
00111111
10111111
00111111
00111111
11111111
11111111
11111111
NAME chords (4,13)

TIL zs
10111111
10011111
11011111
11011111
11011111
11011111
11011111
11011111
NAME chords (5,13)

TIL zt
11111110
11111110
11111110
11111110
11111110
11111110
01111110
11111110
NAME chords (6,13)

TIL zu
00011111
00011111
10111111
00000000
10111111
10111111
10111111
10111111
NAME chords (13,13)

TIL zv
10111111
10111111
10111111
00111100
10111111
10111111
10111111
10111111
NAME chords (14,13)

TIL zw
11111111
01111111
01111111
00011111
01111111
01111111
11111111
11111111
NAME chords (15,13)

TIL zx
11111011
11111001
11111101
11111100
11111110
11111111
11111111
11111111
NAME chords (1,14)

TIL zy
11111111
11111111
11111111
11111111
00111111
10000111
11110000
11111111
NAME chords (2,14)

TIL zz
11111111
11111111
11111111
11111111
11111111
11111111
11111100
00000011
NAME chords (3,14)

TIL 10b
00000000
01111111
01111111
01111111
01111111
01111111
01111111
00000000

TIL 10c
00000000
11111111
11111001
11111110
11111110
11111001
11111111
00000000

TIL 10d
00000000
11111111
10011111
01111111
01111111
10011111
11111111
00000000

TIL 10e
00000000
11111110
11111110
11111110
11111110
11111110
11111110
00000000

TIL 10f
00000000
11111111
11111111
11111111
11111111
11111111
11111111
00000000

TIL 10g
00000000
11111111
11111111
11111100
11111110
11111111
11111111
00000000

TIL 10h
00000000
11111111
11100111
11001111
10011111
01111111
11111111
00000000

TIL 10k
01111111
01111111
01111111
01111111
01111111
01111111
01111111
00000000

TIL 10l
11111110
11111110
11111110
11111110
11111110
11111110
11111110
00000000

TIL 10n
11111111
11111111
10001001
11111111
10010011
11111111
11111111
00000000

TIL 10o
11111111
11111111
10100001
11111111
10001001
11111111
11111111
00000000

TIL 10p
11111111
11111111
10000101
11111111
10010001
11111111
11111111
00000000

TIL 10q
11111111
11111111
10000001
10000001
10000001
11111111
11111111
00000000

TIL 10r
11111111
11100111
11011011
11111011
11100111
11111111
11101111
11111111
NAME qmark

TIL 10s
11111111
11111001
11111101
10111011
10111111
11111011
10111111
11111111
NAME pmarks

TIL 10t
11111111
11110111
11110111
11110111
11110111
11111111
11110111
11111111

TIL 10u
00111111
10000111
00111011
10111011
00100111
10101111
00111111
10101111

TIL 10v
11111111
11001111
10110111
11110111
11101111
11111111
11101111
11111111

TIL 10x
00000000
01111110
01111110
01111110
01111010
01111110
01111110
01111110
NAME closeddoor

TIL 10y
00111100
01011010
00111100
01111110
10111101
00111100
00111100
00100100
NAME spaceman

TIL 10z
10111111
00000000
11111111
11111111
11111111
11111111
11111111
11111111
NAME chordsfix

TIL rx
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000010
NAME titlescreen (1,1)

TIL sl
00000000
00000000
00000000
00000000
00000000
00000000
00010000
00101000
NAME titlescreen (3,1)

TIL ty
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000001
>
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000001
NAME titlescreen (5,1)

TIL tz
00000000
00000000
00000000
00000000
00000000
00000000
10000000
11000000
NAME titlescreen (6,1)

TIL us
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
>
00000000
00000000
00000000
00000000
00000010
00000000
00000000
00000000
NAME titlescreen (10,1)

TIL vg
00000000
00000000
00001000
00001000
00111110
00001000
00001000
00000000
NAME titlescreen (13,1)

TIL vm
00000000
00000000
00100000
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (1,1)

TIL 11a
01110101
11101010
01010101
11101010
01110101
00101010
00110101
00101010
NAME titlescreen (2,3)

TIL 11b
01010000
10111000
01010000
10111000
01010000
10100000
01100000
10100000
NAME titlescreen (3,3)

TIL 11c
00111110
00001000
00001000
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (4,3)

TIL 11d
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
>
00000000
00000100
00000000
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (5,3)

TIL 11e
00000000
00000000
00000000
00000000
00000000
00100000
00000000
00000000
NAME titlescreen (11,3)

TIL 11f
00000000
00000000
00000000
00000000
01000000
11100000
01000000
00000000
>
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (12,3)

TIL 11g
00000000
01000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (13,3)

TIL 11h
00110101
00101010
00110101
00101010
00010101
00011111
00010000
00010000
NAME titlescreen (2,4)

TIL 11i
01100000
10100010
01100101
10100010
01100000
11000000
01000000
01000000
NAME titlescreen (3,4)

TIL 11j
00000000
00000000
00000000
00000000
00000000
00000000
00000001
00000000
NAME titlescreen (4,4)

TIL 11k
00000000
00000000
00000010
00000000
00000000
00000000
11111111
11111111
>
00000000
00000000
00000000
00000000
00000000
00000000
11111111
11111111
NAME titlescreen (5,4)

TIL 11l
00000000
00000000
00000000
00000000
00000000
00000000
11110100
11101100
NAME titlescreen (6,4)

TIL 11m
00000010
00000001
00000000
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (7,4)

TIL 11n
00000001
00000000
00000000
00000000
00000000
00000000
01000000
00000000
NAME titlescreen (11,4)

TIL 11o
01111111
00111111
00011111
00001111
00011111
00111111
01111111
11111111
NAME titlescreen (5,5)

TIL 11p
11011100
11000000
11011111
11011111
11011111
11011111
11011111
11011111
NAME titlescreen (6,5)

TIL 11q
00000000
00000000
11111111
11111111
111111111
11000111
11011010
11000110
NAME titlescreen (7,5)

TIL 11r
00000000
00000000
11111111
11111111
11111111
00110000
11011101
00011101
NAME titlescreen (8,5)

TIL 11s
00000000
00000000
11111111
11111111
11111111
01011010
11011010
11000010
NAME titlescreen (9,5)

TIL 11t
00000000
00000000
11111111
11111111
11111111
11101100
11101011
10101000
NAME titlescreen (11,5)

TIL 11u
00000000
00000000
11111111
11111111
11111111
11011101
01011101
01100011
NAME titlescreen (10,5)

TIL 11v
00000000
00000000
11111111
11111111
11111111
10001111
01111111
10011111
NAME titlescreen (12,5)

TIL 11w
00000000
00000000
11110000
11110000
11110000
11110000
11110000
11110000
NAME titlescreen (13,5)

TIL 11x
00111000
00010000
00000000
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (14,5)
WAL false

TIL 11y
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
>
00000000
00000000
00000000
00000000
00000000
01000000
10100000
01000000
NAME titlescreen (1,6)

TIL 11z
01000000
01000000
01000000
01000000
01000000
01000000
01000001
01000000
>
01000000
01000000
01000000
01000000
01000000
01000000
01000000
01000000
NAME titlescreen (3,6)

TIL 12a
00000000
00000000
00000000
00000000
00000000
00000000
01000000
00000000
NAME titlescreen (4,7)

TIL 12b
00000000
00000000
00000000
00000000
01000000
00000000
00000000
00000000
NAME titlescreen (5,7)

TIL 12c
00000000
00000000
00000000
00000111
00000000
00011111
00011111
00011111
NAME titlescreen (6,7)

TIL 12d
00000000
00000111
01111010
11010101
00000000
11111111
11111111
11111111
NAME titlescreen (7,7)

TIL 12e
00111110
11010101
10101010
01010101
00000000
11111111
11111111
11111111
NAME titlescreen (8,7)

TIL 12f
10101010
01010101
10101010
01010101
00000000
11111111
11111111
11111111
NAME titlescreen (9,7)

TIL 12g
10101010
01010101
10101111
11111000
00000000
11111111
11111111
11111111
NAME titlescreen (11,7)

TIL 12h
10101010
01111111
11000000
00000000
00000000
11111111
11111111
11111111
NAME titlescreen (10,7)

TIL 12i
11111000
00000000
00000000
00000000
00000000
11111111
11111111
11111111
NAME titlescreen (12,7)

TIL 12j
00000000
00000000
00000000
00000000
00000000
11110000
11110000
11110000
NAME titlescreen (13,7)

TIL 12k
00000000
00000000
01000000
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (14,7)

TIL 12l
00000100
00000000
00000000
00000000
00000000
00000000
00000001
00000011
NAME titlescreen (1,8)

TIL 12m
00010000
00010000
00010000
00010000
00010000
11110000
11110000
11110000
NAME titlescreen (2,8)

TIL 12n
01000000
01000000
01000000
01000000
01000000
01111000
01111100
01111110
NAME titlescreen (3,8)

TIL 12o
00011000
00011011
00011011
00011011
00011000
00011111
00011111
00011111
NAME titlescreen (6,8)

TIL 12p
11000011
01011110
01000111
01011111
11000010
11111111
11111111
11111111
NAME titlescreen (7,8)

TIL 12q
00010001
11111011
00111011
11011011
00110001
11111111
11111111
11111111
NAME titlescreen (8,8)

TIL 12r
00011000
01101011
00011000
01011011
01101000
11111111
11111111
11111111
NAME titlescreen (9,8)

TIL 12s
01110111
11110111
11110111
11110111
01110000
11111111
11111111
11111111
NAME titlescreen (11,8)

TIL 12t
10001011
11011001
11011010
11011011
10001011
11111111
11111111
11111111
NAME titlescreen (10,8)

TIL 12u
01000011
01011110
01000111
01011111
01000010
11111111
11111111
11111111
NAME titlescreen (12,8)

TIL 12v
00010000
11110111
00110111
11010111
00110111
11110111
11110111
11110111
NAME titlescreen (13,8)

TIL 12w
00000000
11111111
111111101
11111100
11111000
11110000
11100000
11110000
NAME titlescreen (14,8)

TIL 12x
00000111
00001111
00011111
00011111
00011111
00011111
00011111
00011111
NAME titlescreen (1,9)
WAL false

TIL 12y
11111111
11111111
11111111
11111111
11110000
11100000
11000000
11000000
NAME titlescreen (2,9)

TIL 12z
11111111
11111111
11111111
11111111
01111111
00111111
00011111
00011111
NAME titlescreen (3,9)

TIL 13a
10000000
00000000
00000000
00000000
00000000
00000000
10000000
11000000
NAME titlescreen (4,11)

TIL 13b
00000000
00000000
00000000
00011101
00011101
00010001
00010001
00000000
NAME titlescreen (6,11)

TIL 13c
00000000
00000000
00000000
11011101
11011101
10010000
01011101
00000000
NAME titlescreen (7,11)

TIL 13d
00000000
00000000
00000000
11011100
10011000
01000100
11011100
00000000
NAME titlescreen (8,11)

TIL 13e
00000000
00000000
00000000
01110111
01010111
01110110
01010101
00000000
NAME titlescreen (9,11)

TIL 13f
00000000
00000000
00000000
01110111
01110101
01100101
01010111
00000000
NAME titlescreen (11,11)

TIL 13g
00000000
00000000
00000000
01000100
01000100
01010100
00101000
00000000
NAME titlescreen (10,11)

TIL 13h
00000000
00000000
00000000
01010111
01100111
01010100
01010111
00000000
NAME titlescreen (12,11)

TIL 13i
00000000
00000000
00000000
01010000
00100000
00100000
00100000
00000000
NAME titlescreen (13,11)

TIL 13j
00000000
00000000
00000000
00100000
00000000
00000000
00000000
00000000
NAME titlescreen (14,11)

TIL 13k
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (1,10)

TIL 13l
00011111
00111111
00111111
00111111
01111111
01111111
11111111
11111111
NAME titlescreen (1,10)

TIL 13m
11111111
11111111
11111111
11111111
00000000
00101010
01010101
00000000
NAME titlescreen (2,10)

TIL 13n
11111111
11111111
11111111
11111111
00000111
10100111
01010111
00000111
NAME titlescreen (3,10)

TIL 13o
11000000
111000001
11100000
11110000
11110000
11111000
11111000
11111000
NAME titlescreen (4,10)

TIL 13p
00000000
11101110
01001010
01001010
01001110
00000000
00000000
00000000
NAME titlescreen (8,10)

TIL 13q
00000000
00011101
00011000
00000100
00011100
00000000
00000000
00000000
NAME titlescreen (9,10)

TIL 13r
00000000
11011101
10010101
10011101
10010101
00000000
00000000
00000000
NAME titlescreen (11,10)

TIL 13s
00000000
11011100
11001000
10001000
01001000
00000000
00000000
00000000
NAME titlescreen (10,10)

TIL 13t
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00001000
NAME titlescreen (1,12)

TIL 13u
11111111
11111111
11111111
01111111
01111111
00111111
00011111
00000111
NAME titlescreen (1,12)
WAL false

TIL 13v
11111000
11111000
11110000
11110000
11100000
11000000
10000000
00000000
NAME titlescreen (4,12)

TIL 13w
00000010
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (5,12)

TIL 13x
00000000
00001000
00000000
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (6,12)

TIL 13y
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000100
NAME titlescreen (7,12)

TIL 13z
00000000
00000100
00001110
00000100
00000000
00000000
00000000
00000000
>
00000000
00000100
00001110
00000100
00000000
00000000
00000000
00000000
NAME titlescreen (9,12)

TIL 14a
00001000
00001000
00111110
00001000
00001000
00000000
00000000
00000000
NAME titlescreen (7,14)

TIL 14b
00000000
00100000
01010000
00100000
00000000
00000000
00000000
00000000
>
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME titlescreen (9,14)

TIL 14c
00000000
00001000
00010100
00001000
00000000
00000000
00000000
00000000
NAME titlescreen (2,15)

TIL 14d
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
>
00000000
00000000
00000000
01000000
00000000
00000000
00000000
00000000
NAME titlescreen (5,15)

TIL 14e
00000000
00000000
00000000
00000000
00100000
00000000
00000000
00000000
NAME titlescreen (8,15)

TIL 14f
00000000
00000000
00000000
00010000
00101000
00010000
00000000
00000000
NAME titlescreen (14,15)

TIL 14g
11111111
00000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 14h
01000000
01000000
01000000
01000000
01000000
01000000
01000000
01000000

TIL 14i
00010000
00010000
00010000
00010000
00010000
00010000
00010000
00010000

TIL 14j
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 14k
00000000
00000000
00000000
00010000
00000000
00000000
00000000
00000000

TIL 14l
00000000
00000000
00000000
00000000
00000001
00000000
00000000
00000000

TIL 14m
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 14n
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00100000

TIL 14o
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00010000

TIL 14p
00000000
00000000
00000000
00000001
00000000
00000000
00000000
00000000

TIL 14q
00000000
00000000
00000000
00000000
00000000
00000000
00010000
00000000

TIL 14r
00000000
00000000
00000000
00000000
00000000
00000000
00010000
00000000

TIL 14s
00000000
00000000
00000000
00010000
00000000
00000000
00000000
00000000

TIL 14t
00000000
00000000
00000000
00000000
00000000
00000000
00000000
01000000

TIL 14u
00010000
00000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 14v
00000001
00000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 14w
10000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 14x
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00010000

TIL 14y
00101000
00010000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 14z
00000000
00000000
00000000
00000000
00000000
00000000
00000001
00000000

TIL 15a
00001000
00000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 15b
00000000
00000000
00000000
00000000
00000000
00000010
00000000
00000000

TIL 15c
00000000
11111111
00000000
00000000
00000000
00000000
00000000
00000000

TIL 15d
11111111
00000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 15e
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 15f
11111111
000000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 15g
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 15h
01000000
01000000
01000000
01000000
01000000
01000000
01000000
01000000

TIL 15i
00010000
00010000
00010000
00010000
00010000
01110000
11110000
11111111

TIL 15j
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 15k
00000001
00000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 15l
00000000
00000000
00000000
00000000
00000000
10000000
00000000
00000000

TIL 15m
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00100000

SPR 10
00111100
00100100
11111111
00111100
00111100
00100100
00100100
00100100
>
00111100
00100100
00111100
01111111
10111100
00100100
00100110
00100000
NAME alb8
DLG 3c
POS 2 14,13

SPR 11
00111100
01101010
00111100
00111100
01111110
10111101
00111100
00100100
>
00111100
01101010
00111100
10111101
01111110
00111100
00111100
00100100
NAME alb9
DLG 3d
POS 2 2,11

SPR 12
10111101
01101010
00111100
11111111
00111100
00111100
00111100
00100100
>
00111100
11010111
00111100
01111110
10111101
00111100
00111110
00100000
NAME alb10
DLG 1a
POS 2 1,10

SPR 14
00111100
01101010
00111101
11111110
00111100
00111100
00111100
00100100
>
00111100
01101010
00111100
11111111
00111100
00111100
00111100
00100100
NAME u3a1
DLG 3m
POS 4 10,10

SPR 15
00111100
01010110
00111100
11111111
00111100
01111110
11111111
00100100
>
00111100
01010110
00111100
11111111
00111100
01111110
11111111
00100100
NAME u3a2
DLG 1g
POS 4 9,9

SPR 16
01111100
11101010
00111101
01111110
10111100
00111100
00111110
00100000
>
01111100
11101010
00111101
01111110
10111100
00111100
00111110
00100000
NAME u3a3
DLG 1h
POS 4 7,8

SPR 26
00000000
00111110
00000110
00001010
00010010
00100010
01000000
00000000
NAME avatarcursor

SPR 30
00000000
00000000
00000000
00000000
00000000
00000000
00000001
00000011
NAME uke1

SPR 31
00000111
00001111
00001111
00001111
00001111
00001111
00001111
00000111
NAME uke4

SPR 32
11111111
11111111
11111111
11111111
11110000
11100000
11000000
11000000
NAME uke5

SPR 33
11111111
11111111
11111111
11111111
01111111
00111111
00011111
00011111
NAME uke6

SPR 34
00000000
00000000
10000000
10000000
10000000
10000000
00000000
00000000
NAME uke7

SPR 35
00000111
00000111
00000111
00000111
00000111
00000111
00001111
00011111
NAME uke8

SPR 36
11000000
11000000
11000000
11100000
11110000
11111111
11111111
11111111
NAME uke9

SPR 37
00011111
00011111
00011111
00111111
01111111
11111111
11111111
11111111
NAME uke10

SPR 38
00000000
00000000
00000000
00000000
00000000
10000000
10000000
11000000
NAME uke11

SPR 39
00011111
00111111
00111111
00111111
01111111
01111111
11111111
11111111
NAME uke12

SPR A
00111100
01101010
11111100
00111100
01111110
10111101
00100100
00100100
>
00111100
01101010
11111100
00111100
01111110
10111101
00100100
00100100
POS 5 10,13
COL 3

SPR t
00111100
01101010
00111100
11111111
00111100
00111100
00111100
00100100
>
00111100
01010110
00111101
01111110
10111100
00111100
00111110
00100000
NAME alb1
DLG 11
POS 2 7,6

SPR u
00111100
01111110
11010111
00111100
01111110
10111101
00111100
00100100
>
00111100
01010110
11111111
00111100
11111111
00111100
00111100
00010100
NAME alb2
DLG 15
POS 2 13,10

SPR v
00111100
01010110
00111100
11111111
00111100
00111100
00111100
00100100
>
00010100
01111110
00111101
01111110
10111100
00111100
00111110
00100000
NAME alb3
DLG 16
POS 2 10,6

SPR w
00111100
01011010
11111110
00111100
11111111
00111100
00111100
00100100
>
00111100
01111110
11011010
00111100
01111110
10111101
00111100
00010100
NAME alb4
DLG 14
POS 2 9,6

SPR x
00111100
01010110
00111101
00111100
01111110
10111101
00111100
00100100
>
00111100
01010111
00111100
00111100
01111110
10111101
00111100
01000100
NAME alb5
DLG 13
POS 2 9,11

SPR y
00111100
01010110
01111110
00111100
01111110
10111101
00111100
00100100
>
00111100
01111110
01101010
00111100
11111111
00111100
00111100
00100010
NAME alb6
DLG 12
POS 2 7,12

SPR z
00111100
11010111
01111110
00111100
01111110
10111101
00111100
00100100
>
00111100
01111110
11101011
00111100
11111111
00111100
00111100
00100010
NAME alb7
DLG 3b
POS 2 5,9

SPR 1a
00111100
01101010
00111100
01111110
10111101
00111100
00111100
00010100
>
00111100
01101010
00111100
01111110
10111101
00111100
00111100
00010100
NAME u3a4
DLG 1i
POS 4 5,9

SPR 1d
00111100
11101011
01111110
00111100
11111111
00111100
00111100
01000100
>
00111100
11101011
01111110
00111100
11111111
00111100
00111100
01000100
NAME u3a5
DLG 1j
POS 4 4,10

SPR 2r
00111100
00101000
00111100
11111111
00111100
00111100
00111100
00100100
>
00111100
00101000
00111100
11111111
00111100
00111100
00111100
00100100
NAME lgbtq1
DLG 1m
POS 8 5,10

SPR 2s
00111100
01101010
00111100
11111111
00111100
00111100
00111100
00100100
>
00111100
01010110
10111100
01111110
00111101
00111100
00111100
00100100
NAME lgbtq2
DLG 1n
POS 8 7,9

SPR 2t
00111100
01010110
00111101
01111110
10111100
00111100
00111110
00100000
>
00111100
01010110
00111101
01111110
10111100
00111100
00111110
00100000
NAME lgbtq3
DLG 1p
POS 8 10,9

SPR 2u
00111100
01101010
00111100
01111110
10111101
00111100
00111100
00010100
>
00111100
01101010
00111100
01111110
10111101
00111100
00111100
00010100
NAME lgbtq4
DLG 1q
POS 8 11,10

SPR 2v
00111100
01101011
00111110
00111100
11111111
00111100
00111100
01000100
>
00111100
01010110
00111111
10111100
01111111
00111100
00111100
01000100
NAME lgbtq5
DLG 1o
POS 8 8,9

SPR 2w
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME transparent

SPR 2x
00000001
00000010
00000100
00111000
00111000
11011000
11100000
11100000
NAME uke

SPR 2y
00000000
00000000
00000000
00000000
00000000
00111000
00111100
00111110
NAME uke3

SPR 2z
00000000
00000000
00000000
00000000
00000000
11100000
11100000
11100000
NAME uke2

SPR 3a
11111111
11111111
11111111
11111111
00000000
00000000
00000000
00000000
NAME uke13

SPR 3b
11111111
11111111
11111111
11111111
00000111
00000111
00000111
00000111
NAME uke14

SPR 3c
11000000
11100000
11100000
11110000
11110000
11111000
11111000
11111000
NAME uke15

SPR 3d
11111111
11111111
11111111
01111111
00111111
00111111
00011111
00000111
NAME uke16

SPR 3e
11111111
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME uke17

SPR 3f
11111111
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME uke18

SPR 3g
11111000
11111000
11111000
11110000
11100000
11000000
10000000
00000000
NAME uke19

SPR 3h
11111111
00011111
00000000
00000000
00000000
00000000
00000000
00000000
NAME uke20

SPR 3i
11111000
10000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME uke21

ITM 0
00000000
00000000
00000000
00111100
01100100
00100100
00011000
00000000
NAME tea
DLG 1

ITM 1
00000000
00111100
00100100
00111100
00010000
00011000
00010000
00011000
NAME key
DLG 2

ITM 2
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000

ITM 3
00000000
00000000
00000000
00000000
10000000
01000000
00111111
00111111
NAME zoom7a
DLG 42

ITM 4
00111111
00111111
00111111
00111111
00111111
00000000
00000000
00000000
NAME zoom7b
DLG 42

ITM 5
00000000
00000000
00000000
00000000
00000000
00000000
11100100
11101100
NAME zoom7c
DLG 42

ITM 6
11111100
11111100
11111100
11101100
11110100
00001000
00000100
00000000
NAME zoom7d
DLG 42

ITM 60
00000000
00000000
00000000
00000000
00000000
00001110
00000000
00000000
NAME book 2
DLG 40

ITM 61
00000000
00000000
00000000
00000000
00000000
00111000
00000000
00000000
NAME book 3
DLG 41

ITM 2x
00000011
00001111
00001111
00011111
00111111
00111011
01111111
11111111
NAME zoom1a
DLG 27

ITM 2z
11100000
11110000
11111000
11111000
11111100
11011100
11111110
11111111
NAME zoom1b
DLG 27

ITM 3a
00000011
00001111
00001111
00011111
00111111
00111011
00111111
00111111
NAME zoom2a
DLG 2g

ITM 3b
11100000
11110000
11111000
11111000
11111100
11011100
11111100
11111000
NAME zoom2b
DLG 2g

ITM 3f
11111101
01111110
00001111
00000111
00001111
00011111
00111111
01111111
NAME zoom1c
DLG 27

ITM 3g
10111111
01111111
11110000
11100000
11100000
11110000
11111000
11111100
NAME zoom1d
DLG 27

ITM 3h
11000000
10000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME zoom1e

ITM 3i
00011100
00011110
00001111
00000111
00001111
00011111
00111111
01111111
NAME zoom2c
DLG 2g

ITM 3j
00111000
01111000
11110000
11100000
11100000
11110000
11111000
11111100
NAME zoom2d
DLG 2g

ITM 3n
00000000
00000000
00000000
00000000
00000000
00000011
00001111
00001111
NAME zoom3a
DLG 2h

ITM 3o
00000000
00000000
00000000
00000000
00000000
11100000
11110000
11111000
NAME zoom3b
DLG 2h

ITM 3q
00000000
00000000
00000000
00000000
00010101
01011111
11111111
11111111
NAME zoom6a
DLG 43

ITM 3r
00000000
00000000
00000000
00000000
01000000
11100000
11100000
11110000
NAME zoom6b
DLG 43

ITM 3s
00011111
00111111
00111011
00111111
00111111
00011101
00011110
00001111
NAME zoom3c
DLG 2h

ITM 3t
11111000
11111100
11011100
11111100
11111000
10111000
01111000
11110000
NAME zoom3d
DLG 2h

ITM 3u
00011111
00111111
00111011
01111111
01111111
11111101
01111110
00001111
NAME zoom4c
DLG 2o

ITM 3v
11111000
11111100
11011100
11111110
11111110
10111110
01111111
11110000
NAME zoom4d
DLG 2o

ITM 3w
11111111
11111111
11101111
11111111
11111111
01110000
01111001
00111111
NAME zoom6c
DLG 43

ITM 3x
11110000
11110000
01110000
11110000
11100000
11100000
11100000
11000000
NAME zoom6d
DLG 43

ITM 3y
00000111
00001111
00011111
00111111
01111111
11111111
00000000
00000000
NAME zoom3e
DLG 2h

ITM 4a
11100000
11100000
11110000
11111000
11111100
11111110
00000000
00000000
NAME zoom3f
DLG 2h

ITM 4b
00000000
00000000
00000000
00000000
00000001
00000011
00000000
00000000
NAME zoom6e
DLG 30

ITM 4c
00011111
00111111
01111111
11111111
11111111
11111111
00000000
00000000
NAME zoom6f
DLG 43

ITM 4d
10000000
10000000
11000000
11100000
11110000
11111000
00000000
00000000
NAME zoom6g
DLG 43

ITM 4h
00000000
00000000
00000011
00001111
00001111
00011111
00111111
00111011
NAME zoom5a
DLG 2t

ITM 4i
00000000
00000000
11100000
11110000
11111000
11111000
11111100
11011100
NAME zoom5b
DLG 2t

ITM 4n
00000000
00000000
00000011
00000000
00000000
00000000
00000000
00000000
NAME zoom5c
DLG 2t

ITM 4o
01111111
11111111
11111100
01111110
00001111
00000111
00001111
00011111
NAME zoom5d
DLG 2t

ITM 4p
11111110
11111111
00111111
01111111
11110000
11100000
11100000
11110000
NAME zoom5e
DLG 2t

ITM 4q
00000000
00000000
11000000
10000000
00000000
00000000
00000000
00000000
NAME zoom5f

ITM 4z
00111111
01111111
11111111
00000000
00000000
00000000
00000000
00000000
NAME zoom5g
DLG 2t

ITM 5a
11111000
11111100
11111110
00000000
00000000
00000000
00000000
00000000
NAME zoom5h
DLG 2t

ITM 5f
00000011
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME zoom1f

ITM 5g
00000000
00000000
00000000
00000000
00000000
00000011
00001111
00001111
NAME zoom4a
DLG 2o

ITM 5h
00000000
00000000
00000000
00000000
00000000
11100000
11110000
11111000
NAME zoom4b
DLG 2o

ITM 5i
00000111
00001111
00011111
00111111
01111111
11111111
00000000
00000000
NAME zoom4e
DLG 2o

ITM 5j
11100000
11100000
11110000
11111000
11111100
11111110
00000000
00000000
NAME zoom4f
DLG 2o

ITM 5l
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME transparent

ITM 5m
00000000
00000000
00000000
00110000
01001000
01000000
01001000
00110000
NAME chordc
DLG 3e

ITM 5n
00000000
00000000
00000000
00001111
00001000
00001110
00001000
00001000
NAME chordf
DLG 3f

ITM 5o
00000000
00000000
00000000
00000000
10000000
01000000
00111111
00111111

ITM 5q
00000000
00000001
00000010
00000011
00000010
00000010
00000000
00000000
NAME chordam1
DLG 3g

ITM 5r
00000000
10010001
01011011
11010101
01010001
01010001
00000000
00000000
NAME chordam2
DLG 3g

ITM 5s
00000000
00000110
00001000
00001011
00001001
00000110
00000000
00000000
NAME chordg
DLG 3h

ITM 5t
00000000
00000000
01111110
01111110
01111110
00000000
00000000
00000000
NAME btn
DLG 3k

ITM 5v
00000000
00000000
01111110
01111110
01111110
00000000
00000000
00000000
NAME btnb
DLG 3l

ITM 5w
00000000
00000000
00111000
00000000
00000000
00000000
00000000
00000000
NAME book 1b
DLG 3o

ITM 5x
00000001
00000010
00000100
00111000
00111000
11011000
11100000
11100000
NAME uke

ITM 5y
00000000
00000000
00111000
00000000
00000000
00000000
00000000
00000000
NAME book1a
DLG 3x

ITM 5z
00000000
00000000
00000000
00000000
00001000
00001000
00000000
00000000
NAME book 1
DLG 3z

DLG 1
You found a nice warm cup of tea
NAME tea dialog

DLG 2
A key! {wvy}What does it open?{wvy}
NAME key dialog

DLG 11
"""
I just walked in off the street. They lent me a ukulele for the night.
(imageNow "SPR, alb1, transparent")
{alb1 = true}
{
  - {alb1 == true} * {alb2 == true} * {alb3 == true} * {alb4 == true} * {alb5 == true} * {alb6 == true} * {alb7 == true} * {alb8 == true} * {alb9 == true} * {alb10 == true} ?
    {pg}
    {exit "3" 7 15 "fade_b"}
    One of the most characteristic features of British ukulele pathways is {wvy}flexibility{wvy}.
}
"""
NAME alb1 dialog

DLG 12
"""
I organise these nights. I put together the songbook. It took hundreds of hours. I'm happy it means anyone can play here - everyone is musical.
(imageNow "SPR, alb6, transparent")
{alb6 = true}
{
  - {alb1 == true} * {alb2 == true} * {alb3 == true} * {alb4 == true} * {alb5 == true} * {alb6 == true} * {alb7 == true} * {alb8 == true} * {alb9 == true} * {alb10 == true} ?
    {pg}
    {exit "3" 7 15 "fade_b"}
    One of the most characteristic features of British ukulele pathways is {wvy}flexibility{wvy}.
}
"""
NAME alb6 dialog

DLG 13
"""
We shout out the songs we want to play and they show the chords on a projector. Sometimes hundreds of us sing together at once.
(imageNow "SPR, alb5, transparent")
{alb5 = true}
{
  - {alb1 == true} * {alb2 == true} * {alb3 == true} * {alb4 == true} * {alb5 == true} * {alb6 == true} * {alb7 == true} * {alb8 == true} * {alb9 == true} * {alb10 == true} ?
    {pg}
    {exit "3" 7 15 "fade_b"}
    One of the most characteristic features of British ukulele pathways is {wvy}flexibility{wvy}.
}
"""
NAME alb5 dialog

DLG 14
"""
I go to four ukulele clubs a week. I practise on my nights off. But I'm not a musician or anything.
(imageNow "SPR, alb4, transparent")
{alb4 = true}
{
  - {alb1 == true} * {alb2 == true} * {alb3 == true} * {alb4 == true} * {alb5 == true} * {alb6 == true} * {alb7 == true} * {alb8 == true} * {alb9 == true} * {alb10 == true} ?
    {pg}
    {exit "3" 7 15 "fade_b"}
    One of the most characteristic features of British ukulele pathways is {wvy}flexibility{wvy}.
}
"""
NAME alb4 dialog

DLG 15
"""
I was really nervous about anyone hearing me play. But here no one can hear if I make a mistake!
(imageNow "SPR, alb2, transparent")
{alb2 = true}
{
  - {alb1 == true} * {alb2 == true} * {alb3 == true} * {alb4 == true} * {alb5 == true} * {alb6 == true} * {alb7 == true} * {alb8 == true} * {alb9 == true} * {alb10 == true} ?
    {pg}
    {exit "3" 7 15 "fade_b"}
    One of the most characteristic features of British ukulele pathways is {wvy}flexibility{wvy}.
}
"""
NAME alb2 dialog

DLG 16
"""
I go to four ukulele clubs a week. I practise on my nights off. I'm a musician, and I've been playing lots of instruments since I was tiny, but this is so sociable!
(imageNow "SPR, alb3, transparent")
{alb3 = true}
{
  - {alb1 == true} * {alb2 == true} * {alb3 == true} * {alb4 == true} * {alb5 == true} * {alb6 == true} * {alb7 == true} * {alb8 == true} * {alb9 == true} * {alb10 == true} ?
    {pg}
    {exit "3" 7 15 "fade_b"}
    One of the most characteristic features of British ukulele pathways is {wvy}flexibility{wvy}.
}
"""
NAME alb3 dialog

DLG 27
"""
{
  - {zoom1 == false} ?
    Hey, we met in the bar way back when! This is a bit different, isn't it. 
    (imageNow "ITM, zoom1a, transparent")
    (imageNow "ITM, zoom1b, transparent")
    (imageNow "ITM, zoom1c, transparent")
    (imageNow "ITM, zoom1d, transparent")
    (imageNow "ITM, zoom1e, transparent")
    (imageNow "ITM, zoom1f, transparent")
    {zoom1 = true}
}{
  - {zoom1 == true} * {zoom2 == true} * {zoom3 == true} * {zoom4 == true} * {zoom5 == true} * {zoom6 == true} * {zoom7 == true} ?
    {pg}
    {exit "e" 6 9 "fade_b"}
    Time to do some more reading and thinking. I should check my desk again.
}
"""
NAME zoom1 dialog

DLG 40
"""
I pull {clr3}Christopher Small{clr3}'s {clr3}Musicking{clr3} (1998) out of the bookshelf.
{pg}
Small says that music is something that is done, not an abstract concept that something is done to.
{pg}
He turns 'music' into a verb - {clr3}musicking{clr3} - and suggests that it lets people explore and celebrate 'ideal relationships' - with each other, with society, with the world.
{pg}
He thinks you don't have to be a virtuoso to be musical - anyone can music meaningfully.
"""
NAME book 2 dialog

DLG 41
Next I look at {clr3}Tia DeNora{clr3}'s {clr3}Music In Everyday Life{clr3}. DeNora thinks music lets people present themselves to themselves to help them understand who they are - and to communicate their identity to other people.
NAME book 3 dialog

DLG 42
"""
{
  - {zoom7 == false} ?
    I'm tired, so I've turned my camera off and I'm just enjoying hearing the songs.
    (imageNow "ITM, zoom7a, transparent")
    (imageNow "ITM, zoom7b, transparent")
    (imageNow "ITM, zoom7c, transparent")
    (imageNow "ITM, zoom7d, transparent")
    {zoom7 = true}
}{
  - {zoom1 == true} * {zoom2 == true} * {zoom3 == true} * {zoom4 == true} * {zoom5 == true} * {zoom6 == true} * {zoom7 == true} ?
    {pg}
    {exit "e" 6 9 "fade_b"}
    Time to do some more reading and thinking. I should check my desk again.
}
"""
NAME zoom7 dialog

DLG 43
"""
{
  - {zoom6 == false} ?
    I like that I can lead lots of songs, or just listen if I want. 
    (imageNow "ITM, zoom6a, transparent")
    (imageNow "ITM, zoom6b, transparent")
    (imageNow "ITM, zoom6c, transparent")
    (imageNow "ITM, zoom6d, transparent")
    (imageNow "ITM, zoom6e, transparent")
    (imageNow "ITM, zoom6f, transparent")
    (imageNow "ITM, zoom6g, transparent")
    {zoom6 = true}
}{
  - {zoom1 == true} * {zoom2 == true} * {zoom3 == true} * {zoom4 == true} * {zoom5 == true} * {zoom6 == true} * {zoom7 == true} ?
    {pg}
    {exit "e" 6 9 "fade_b"}
    Time to do some more reading and thinking. I should check my desk again.
}
"""
NAME zoom6 dialog

DLG 44
"""
Emma Winston, Goldsmiths University of London
For CHASE Encounters June 2021
...
e.winston@gold.ac.uk
emmawinston.me
{end}
"""
NAME outro dialog

DLG 45
You walk through the doorway
NAME exit narration 23

DLG 46
You walk through the doorway
NAME exit narration 24

DLG v
I think I'm going to need to head out and find some real ukulele players to interview and play alongside.
NAME exit narration 7

DLG w
Perhaps I need to find out more about players. Maybe some of my books will help.
NAME exit narration 8

DLG y
Time for some {rbw}participant observation!{rbw}
NAME exit narration 10

DLG 1a
"""
I can hear myself strumming if I try hard enough, but really it's just a big wall of ukulele sound.
(imageNow "SPR, alb10, transparent")
{alb10 = true}
{
  - {alb1 == true} * {alb2 == true} * {alb3 == true} * {alb4 == true} * {alb5 == true} * {alb6 == true} * {alb7 == true} * {alb8 == true} * {alb9 == true} * {alb10 == true} ?
    {pg}
    {exit "3" 7 15 "fade_b"}
    One of the most characteristic features of British ukulele pathways is {wvy}flexibility{wvy}.
}
"""
NAME alb10 dialog

DLG 1d
You can take steps off the pathway and go your own way without disturbing anyone or being left out - I call this a '{clr3}desire line{clr3}'.
NAME exit narration desire line

DLG 1g
"""
We are all retired. We meet once a week to rehearse, but we perform at care homes a few times a week too.
(imageNow "SPR, u3a2, transparent") 
{u3a2 = true}
{
  - {u3a1 == true} * {u3a2 == true} * {u3a3 == true} * {u3a4 == true} * {u3a5 == true} ?
    {pg}
    {exit "8" 3 9 "fade_b"}
    Let's visit some more players!
}
"""
NAME u3a2 dialog

DLG 1h
"""
Lots of our audience members have dementia, and it's so rewarding when we can play something they really respond to.
(imageNow "SPR, u3a3, transparent")
{u3a3 = true}
{
  - {u3a1 == true} * {u3a2 == true} * {u3a3 == true} * {u3a4 == true} * {u3a5 == true} ?
    {pg}
    {exit "8" 3 9 "fade_b"}
    Let's visit some more players!
}
"""
NAME u3a3 dialog

DLG 1i
"""
I didn't know what to do with myself when I retired, but this has given me a new purpose.
{pg}
I started playing when I was 70!
(imageNow "SPR, u3a4, transparent")
{u3a4 = true}
{
  - {u3a1 == true} * {u3a2 == true} * {u3a3 == true} * {u3a4 == true} * {u3a5 == true} ?
    {pg}
    {exit "8" 3 9 "fade_b"}
    Let's visit some more players!
}
"""
NAME u3a4 dialog

DLG 1j
"""
There are dozens of University of the Third Age ukulele groups around the country - we organise classes and teach each other.
(imageNow "SPR, u3a5, transparent")
{u3a5 = true}
{
  - {u3a1 == true} * {u3a2 == true} * {u3a3 == true} * {u3a4 == true} * {u3a5 == true} ?
    {pg}
    {exit "8" 3 9 "fade_b"}
    Let's visit some more players!
}
"""
NAME u3a5 dialog

DLG 1m
"""
We are all LGBTQ-identified women. We play parody songs at charity events.
(imageNow "SPR, lgbtq1, transparent") 
{lgbtq1 = true}
{
  - {lgbtq1 == true} * {lgbtq2 == true} * {lgbtq3 == true} * {lgbtq4 == true} * {lgbtq5 == true} ?
    {pg}
    {exit "9" 3 11 "slide_u"}
    Cue the pandemic.
}
"""
NAME lgbtq1 dialog

DLG 1n
"""
Some of us get pretty political, but we like to have a laugh too.
(imageNow "SPR, lgbtq2, transparent") 
{lgbtq2 = true}
{
  - {lgbtq1 == true} * {lgbtq2 == true} * {lgbtq3 == true} * {lgbtq4 == true} * {lgbtq5 == true} ?
    {pg}
    {exit "9" 3 11 "slide_u"}
    Cue the pandemic.
}
"""
NAME lgbtq2 dialog

DLG 1o
"""
This is a bit different from most LGBTQ nights. It feels more like part of my daily life than the club circuit.
(imageNow "SPR, lgbtq5, transparent") 
{lgbtq5 = true}
{
  - {lgbtq1 == true} * {lgbtq2 == true} * {lgbtq3 == true} * {lgbtq4 == true} * {lgbtq5 == true} ?
    {pg}
    {exit "9" 3 11 "slide_u"}
    Cue the pandemic.
}
"""
NAME lgbtq5 dialog

DLG 1p
"""
I write funny songs about my experiences and I love playing them to people who get it.
(imageNow "SPR, lgbtq3, transparent") 
{lgbtq3 = true}
{
  - {lgbtq1 == true} * {lgbtq2 == true} * {lgbtq3 == true} * {lgbtq4 == true} * {lgbtq5 == true} ?
    {pg}
    {exit "9" 3 11 "slide_u"}
    Cue the pandemic.
}
"""
NAME lgbtq3 dialog

DLG 1q
"""
It's a safe place to mess up and learn something new.
(imageNow "SPR, lgbtq4, transparent") 
{lgbtq4 = true}
{
  - {lgbtq1 == true} * {lgbtq2 == true} * {lgbtq3 == true} * {lgbtq4 == true} * {lgbtq5 == true} ?
    {pg}
    {exit "9" 3 11 "slide_u"}
    Cue the pandemic.
}
"""
NAME lgbtq4 dialog

DLG 1r
"""
To try and get a broader view, I organise an anonymous survey. 
{pg}
It suggests that not everyone is so keen on the ukulele.
"""
NAME exit narration survey

DLG 2g
"""
{
  - {zoom2 == false} ?
    We make requests in the chat. One person leads each song, and the rest of us mute and strum along at home. It actually feels a lot like playing a duet.
    (imageNow "ITM, zoom2a, transparent")
    (imageNow "ITM, zoom2b, transparent")
    (imageNow "ITM, zoom2c, transparent")
    (imageNow "ITM, zoom2d, transparent")
    {zoom2 = true}
}{
  - {zoom1 == true} * {zoom2 == true} * {zoom3 == true} * {zoom4 == true} * {zoom5 == true} * {zoom6 == true} * {zoom7 == true} ?
    {pg}
    {exit "e" 6 9 "fade_b"}
    Time to do some more reading and thinking. I should check my desk again.
}
"""
NAME zoom2 dialog

DLG 2h
"""
{
  - {zoom3 == false} ?
    I miss that wall of ukulele sound - who doesn't? - but we're online every single night. I love these video calls.
    (imageNow "ITM, zoom3a, transparent")
    (imageNow "ITM, zoom3b, transparent")
    (imageNow "ITM, zoom3c, transparent")
    (imageNow "ITM, zoom3d, transparent")
    (imageNow "ITM, zoom3e, transparent")
    (imageNow "ITM, zoom3f, transparent")
    {zoom3 = true}
}{
  - {zoom1 == true} * {zoom2 == true} * {zoom3 == true} * {zoom4 == true} * {zoom5 == true} * {zoom6 == true} * {zoom7 == true} ?
    {pg}
    {exit "e" 6 9 "fade_b"}
    Time to do some more reading and thinking. I should check my desk again.
}
"""
NAME zoom3 dialog

DLG 2o
"""
{
  - {zoom4 == false} ?
    We're all really close now. It's kept me going and my playing has improved so much.
    (imageNow "ITM, zoom4a, transparent")
    (imageNow "ITM, zoom4b, transparent")
    (imageNow "ITM, zoom4c, transparent")
    (imageNow "ITM, zoom4d, transparent")
    (imageNow "ITM, zoom4e, transparent")
    (imageNow "ITM, zoom4f, transparent")
    {zoom4 = true}
}{
  - {zoom1 == true} * {zoom2 == true} * {zoom3 == true} * {zoom4 == true} * {zoom5 == true} * {zoom6 == true} * {zoom7 == true} ?
    {pg}
    {exit "e" 6 9 "fade_b"}
    Time to do some more reading and thinking. I should check my desk again.
}
"""
NAME zoom4 dialog

DLG 2t
"""
{
  - {zoom5 == false} ?
    I miss the social side, but the music's not so different. No one hears my mistakes but me.
    (imageNow "ITM, zoom5a, transparent")
    (imageNow "ITM, zoom5b, transparent")
    (imageNow "ITM, zoom5c, transparent")
    (imageNow "ITM, zoom5d, transparent")
    (imageNow "ITM, zoom5e, transparent")
    (imageNow "ITM, zoom5f, transparent")
    (imageNow "ITM, zoom5g, transparent")
    (imageNow "ITM, zoom5h, transparent")
    {zoom5 = true}
}{
  - {zoom1 == true} * {zoom2 == true} * {zoom3 == true} * {zoom4 == true} * {zoom5 == true} * {zoom6 == true} * {zoom7 == true} ?
    {pg}
    {exit "e" 6 9 "fade_b"}
    Time to do some more reading and thinking. I should check my desk again.
}
"""
NAME zoom5 dialog

DLG 3b
"""
I never sing, I only play along.
(imageNow "SPR, alb7, transparent")
{alb7 = true}
{
  - {alb1 == true} * {alb2 == true} * {alb3 == true} * {alb4 == true} * {alb5 == true} * {alb6 == true} * {alb7 == true} * {alb8 == true} * {alb9 == true} * {alb10 == true} * sayflex == false ?
    {pg}
    {exit "3" 7 15 "fade_b"}
    One of the most characteristic features of British ukulele pathways is {wvy}flexibility{wvy}.
}
"""
NAME alb7 dialog

DLG 3c
"""
I practise all the time. I've improved so much playing with other people.
(imageNow "SPR, alb8, transparent")
{alb8 = true}
{
  - {alb1 == true} * {alb2 == true} * {alb3 == true} * {alb4 == true} * {alb5 == true} * {alb6 == true} * {alb7 == true} * {alb8 == true} * {alb9 == true} * {alb10 == true} * sayflex == false ?
    {pg}
    {exit "3" 7 15 "fade_b"}
    One of the most characteristic features of British ukulele pathways is {wvy}flexibility{wvy}.
}
"""
NAME alb8 dialog

DLG 3d
"""
I'm just catching up with my friends. I'll join in again later.
(imageNow "SPR, alb9, transparent")
{alb9 = true}
{
  - {alb1 == true} * {alb2 == true} * {alb3 == true} * {alb4 == true} * {alb5 == true} * {alb6 == true} * {alb7 == true} * {alb8 == true} * {alb9 == true} * {alb10 == true} ?
    {pg}
    {exit "3" 7 15 "fade_b"}
    One of the most characteristic features of British ukulele pathways is {wvy}flexibility{wvy}.                       
}
"""
NAME alb9 dialog

DLG 3e
"""
(soundeffectNow "c")
Ukulele pathways retain their flexibility whether online or offline - and highlight the increasingly blurred boundary between the two domains. 
{c = true}
{
  - {c == true} * {f == true} * {a == true} * {g == true} ?
    {pg}
    {exit "y" 8 11}
}
"""
NAME c dialog

DLG 3f
"""
(soundeffectNow "f")
The ukulele's devaluation has multiple origins. 
{pg}
Some of these are highly valid, including objections to the cultural whitewashing of an instrument with great significance in Hawaii, and to the ukulele's use in corporate media; others are grounded in misogyny and cultural elitism.
{pg}
This devaluation, for some players, 'takes the pressure off' and allows exploration of a musical self.
{f = true}
{
  - {c == true} * {f == true} * {a == true} * {g == true} ?
    {pg}
    {exit "y" 8 11}
}
"""
NAME dialog f

DLG 3g
"""
(soundeffectNow "amin")
Travelling along the ukulele's contemporary British pathways lets participants self-actualise towards an identity in music...
{pg}
...and, for some, allows inclusion of music as an expressive medium supporting a marginalised social identity.
{a = true}
(imageNow "ITM, chordam1, transparent")
(imageNow "ITM, chordam2, transparent")
{
  - {c == true} * {f == true} * {a == true} * {g == true} ?
    {pg}
    {exit "y" 8 11}
}

"""
NAME dialog am

DLG 3h
"""
(soundeffectNow "g")
These qualities are not unique to the ukulele!
{pg}
But its low barrier to entry (in size, cost, and depth of initial learning curve), and the {wvy}unusually flexible{wvy} pathways established by its enthusiasts, supports its popularity.
{g = true}
{
  - {c == true} * {f == true} * {a == true} * {g == true} ?
    {pg}
    {exit "y" 8 11}
}
"""
NAME dialog g

DLG 3j
"""
Players can show vastly different levels of commitment in the same space, and individual engagement can change dramatically within the same session.  
{pg}
Sessions are sociable if you want them to be, but you don't even have to be heard unless you choose to.
"""
NAME exit narration flexibility

DLG 3k
"""
{sequence
  - {shk}"It's a toy guitar, and only insufferably twee hipster girls play it."{shk}
  - {shk}"It's always played out of tune!"{shk}
  - {shk}"It's an instrument for people who can't play anything else."{shk}
  - {shk}"It's fine for traditional Hawaiian music. Anything else is ridiculous."{shk}
  - {shk}"I'm so sick of hearing it in adverts!"{shk}
}{
  - {item "5t"} >= 4 ?
    {pg}
    {exit "d" 8 5}
    But that doesn't seem to put off the enthusiasts. In fact, some of the apparently negative stereotypes even seem to be helpful.
}
"""
NAME btn dialog

DLG 3l
"""
{sequence
  - "People think it's a toy, and it's not - but that's great. The pressure is off."
  - "Sure, it's easy to learn - but if you take it seriously you can do anything with it."
  - "I never thought I'd be able to play an instrument, but now I'm starting to really understand how music works."
  - "Nobody expects it to be played well...and that's really freeing."
  - "I don't have to live up to anyone's expectations. It's not like music was at school. I can just enjoy it."
}{
  - {item "5v"} >= 4 ?
    {pg}
    {exit "4" 11 9}
    It seems that one reason the ukulele appeals to many people who have struggled with musicking in the past is that many outsiders hate it!
    {pg}
    I decide to research some more specialist ukulele pathways based on some of the survey results.
}
"""
NAME btnb dialog

DLG 3m
"""
Welcome to the University of the Third Age ukulele group. Thanks for coming all the way to Little Nattering.
(imageNow "SPR, u3a1, transparent")
{u3a1 = true}
{
  - {u3a1 == true} * {u3a2 == true} * {u3a3 == true} * {u3a4 == true} * {u3a5 == true} ?
    {pg}
    {exit "8" 3 9 "fade_b"}
    Let's visit some more players!
}
"""
NAME u3a1 dialog

DLG 3n
"""
In an instant, life changes.
{pg}
Social activities move online, and the ukulele players I've spent so much time with are no exception.
"""
NAME exit narration 14

DLG 3o
"""
I find an article by {clr3}Killick{clr3} about musical {clr3}participation{clr3} (playing in a group situation) and {clr3}holicipation{clr3} (playing alone). 
{pg}
The difference is clear to him, but not to me. Ukulele players constantly shift between the two, online or in a packed bar.
{pg}
{exit "f" 8 13}
"""
NAME book 1b dialog

DLG 3p
The pathways they tread are designed for this -
NAME exit narration 15

DLG 3q
to be heard, and to be present, as much or as little as they choose while staying connected.
NAME exit narration 16

DLG 3r
Maybe this reflects the growth of a hyperconnected online world,
NAME exit narration 17

DLG 3s
or perhaps it just suits an instrument that's small, cheap, and has a flexible learning curve. 
NAME exit narration 18

DLG 3t
Either way, it lets them give themselves permission to create and perform, without being afraid -
NAME exit narration 19

DLG 3u
- to feel like a musician, without having to admit to being one.
NAME exit narration 20

DLG 3v
It all works.
NAME exit narration 21

DLG 3w
"""
There is plenty of research on the ukulele in Hawaii, especially in a traditional context, and a little on the contiguous United States.
{pg}
But despite its popularity in the UK, no one seems to have investigated it.
{pg}
Let's do something about that.
"""
NAME exit narration 22

DLG 3x
"""
I sort through some papers on the desk. They're mostly historical, but there are a couple about the ukulele today.
{pg}
{clr3}Nathan Kruse{clr3} (2015) writes about a ukulele club in Dallas where the participants talk a lot about the emotional rewards of playing in a group. He suggests that someone should study more than one ukulele club at a time.
{pg}
{clr3}Robin Giebelhausen and Adam Kruse{clr3} (2018) interview several leaders of ukulele groups, but think someone should research the experiences of players.
"""
NAME book1a dialog

DLG 3y
"""
This is a much-simplified walkthrough of some of my core thesis findings, recounted alongside the experience of doing ethnographic research.
{pg}
I have tried to capture the spirit of my interviews, surveys and fieldnotes in the "spoken" lines here, but nothing is quoted verbatim to avoid any issues around data publication. 
{pg}
Use your arrow keys (or touchscreen) to move around. Anything {clr3}red{clr3} can (and should) be interacted with.
{pg}
This game features background music - please mute your tab or device now if you would prefer silence.
"""
NAME intro narration

DLG 3z
"""
There's a book on this shelf called {clr3}The Hidden Musicians{clr3} by {clr3}Ruth Finnegan{clr3}.
{pg}
It was published in 1989, but feels new. It's about the musical lives of ordinary people in Milton Keynes, from pub rock bands to local choirs.
{pg}
Finnegan doesn't think 'groups' or 'communities' properly describes them -- she thinks they've built structures that will outlast the links between them as individuals.
{pg}
So she names their practices '{clr3}pathways{clr3}' -- they're routes people can follow to structure their actions, locally based but extending across the country.
"""
NAME book 1 dialog

VAR alb1
false

VAR alb2
false

VAR alb3
false

VAR alb4
false

VAR alb5
false

VAR alb6
false

VAR alb7
false

VAR alb8
false

VAR alb9
false

VAR sayflex
false

VAR saymatter
false

VAR saylearn
false

VAR sayinsiders
false

VAR saypandemic
false

VAR zoom1
false

VAR zoom2
false

VAR zoom3
false

VAR zoom4
false

VAR zoom5
false

VAR zoom6
false

VAR zoom7
false

VAR c
false

VAR f
false

VAR a
false

VAR g
false


</script>

<style>
html {
	margin:0px;
	padding:0px;
}

body {
	margin:0px;
	padding:0px;
	/* overflow:hidden; */
	background:#e1cfb2;
	font-family: 'VT323', monospace;
	color: #4d282b;
}

#game {
	background:black;
	width:100vw;
	max-width:100%;
	margin:auto;
	display:block;
	touch-action: none; /* fixing touch-input errors in chrome */

	/* sharp pixel edges */
	/* https://caniuse.com/#search=image-render */
  	-ms-interpolation-mode: nearest-neighbor; /* IE */
  	image-rendering: -moz-crisp-edges; /* FF 6.0+ */
  	image-rendering: pixelated; /* Chrome, Safari */
}

#container {
	 width: 70%;
	 margin: 0 auto;
	 padding: 40px 0;
	 background-color: #4d282b;
	 position: relative;
}

#caption {
	width: 70%;
	margin: 0 auto;
	text-align: center;
	font-size: 0.9em;
}

#description: {
	background-color: #e1cfb2;
}

a, a:link, a:visited {
	color: #b6383f;
	text-decoration: none;
}

a:active, a:hover, a:focus {
	text-decoration: underline;
}

#innercontainer {
	width: 70%;
	margin: 0 auto;
	max-width: 512px; 
	max-height: 512px;
	margin: 0 auto;
}

#maintext {
	width: 70%;
	margin: 0 auto;
	background-color: #e1cfb2;
    position: relative;
}

p {
	font-size: 1.2em;
}

#description {
	max-width: 100%;
	padding: 20px;
}

</style>

<!-- SCRIPTS -->
<script>
function startExportedGame() {
	attachCanvas( document.getElementById("game") );
	load_game( document.getElementById("exportedGameData").text.slice(1) );
}
</script>

<script>
//hex-to-rgb method borrowed from stack overflow
function hexToRgb(hex) {
	// Expand shorthand form (e.g. "03F") to full form (e.g. "0033FF")
	var shorthandRegex = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;
	hex = hex.replace(shorthandRegex, function(m, r, g, b) {
		return r + r + g + g + b + b;
	});

	var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
	return result ? {
		r: parseInt(result[1], 16),
		g: parseInt(result[2], 16),
		b: parseInt(result[3], 16)
	} : null;
}
function componentToHex(c) {
    var hex = c.toString(16);
    return hex.length == 1 ? "0" + hex : hex;
}
function rgbToHex(r, g, b) {
    return "#" + componentToHex(Math.floor(r)) + componentToHex(Math.floor(g)) + componentToHex(Math.floor(b));
}

function hslToHex(h,s,l) {
    var rgbArr = hslToRgb(h,s,l);
    return rgbToHex( Math.floor(rgbArr[0]), Math.floor(rgbArr[1]), Math.floor(rgbArr[2]) );
}

function hexToHsl(hex) {
    var rgb = hexToRgb(hex);
    return rgbToHsl(rgb.r, rgb.g, rgb.b);
}

// really just a vector distance
function colorDistance(a1,b1,c1,a2,b2,c2) {
    return Math.sqrt( Math.pow(a1 - a2, 2) + Math.pow(b1 - b2, 2) + Math.pow(c1 - c2, 2) );
}

function hexColorDistance(hex1,hex2) {
    var color1 = hexToRgb(hex1);
    var color2 = hexToRgb(hex2);
    return rgbColorDistance(color1.r, color1.g, color1.b, color2.r, color2.g, color2.b);
}


// source : http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c
/* accepts parameters
 * h  Object = {h:x, s:y, v:z}
 * OR 
 * h, s, v
*/
function HSVtoRGB(h, s, v) {
    var r, g, b, i, f, p, q, t;
    if (arguments.length === 1) {
        s = h.s, v = h.v, h = h.h;
    }
    i = Math.floor(h * 6);
    f = h * 6 - i;
    p = v * (1 - s);
    q = v * (1 - f * s);
    t = v * (1 - (1 - f) * s);
    switch (i % 6) {
        case 0: r = v, g = t, b = p; break;
        case 1: r = q, g = v, b = p; break;
        case 2: r = p, g = v, b = t; break;
        case 3: r = p, g = q, b = v; break;
        case 4: r = t, g = p, b = v; break;
        case 5: r = v, g = p, b = q; break;
    }
    return {
        r: Math.round(r * 255),
        g: Math.round(g * 255),
        b: Math.round(b * 255)
    };
}

/* accepts parameters
 * r  Object = {r:x, g:y, b:z}
 * OR 
 * r, g, b
*/
function RGBtoHSV(r, g, b) {
    if (arguments.length === 1) {
        g = r.g, b = r.b, r = r.r;
    }
    var max = Math.max(r, g, b), min = Math.min(r, g, b),
        d = max - min,
        h,
        s = (max === 0 ? 0 : d / max),
        v = max / 255;

    switch (max) {
        case min: h = 0; break;
        case r: h = (g - b) + d * (g < b ? 6: 0); h /= 6 * d; break;
        case g: h = (b - r) + d * 2; h /= 6 * d; break;
        case b: h = (r - g) + d * 4; h /= 6 * d; break;
    }

    return {
        h: h,
        s: s,
        v: v
    };
}

// source : https://gist.github.com/mjackson/5311256
/**
 * Converts an HSL color value to RGB. Conversion formula
 * adapted from http://en.wikipedia.org/wiki/HSL_color_space.
 * Assumes h, s, and l are contained in the set [0, 1] and
 * returns r, g, and b in the set [0, 255].
 *
 * @param   Number  h       The hue
 * @param   Number  s       The saturation
 * @param   Number  l       The lightness
 * @return  Array           The RGB representation
 */
function hslToRgb(h, s, l) {
  var r, g, b;

  if (s == 0) {
    r = g = b = l; // achromatic
  } else {
    function hue2rgb(p, q, t) {
      if (t < 0) t += 1;
      if (t > 1) t -= 1;
      if (t < 1/6) return p + (q - p) * 6 * t;
      if (t < 1/2) return q;
      if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
      return p;
    }

    var q = l < 0.5 ? l * (1 + s) : l + s - l * s;
    var p = 2 * l - q;

    r = hue2rgb(p, q, h + 1/3);
    g = hue2rgb(p, q, h);
    b = hue2rgb(p, q, h - 1/3);
  }

  return [ Math.floor(r * 255), Math.floor(g * 255), Math.floor(b * 255) ];
}

/**
 * From: http://stackoverflow.com/questions/2353211/hsl-to-rgb-color-conversion
 *
 * Converts an RGB color value to HSL. Conversion formula
 * adapted from http://en.wikipedia.org/wiki/HSL_color_space.
 * Assumes r, g, and b are contained in the set [0, 255] and
 * returns h, s, and l in the set [0, 1].
 *
 * @param   {number}  r       The red color value
 * @param   {number}  g       The green color value
 * @param   {number}  b       The blue color value
 * @return  {Array}           The HSL representation
 */
function rgbToHsl(r, g, b){
    r /= 255, g /= 255, b /= 255;
    var max = Math.max(r, g, b), min = Math.min(r, g, b);
    var h, s, l = (max + min) / 2;

    if(max == min){
        h = s = 0; // achromatic
    }else{
        var d = max - min;
        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
        switch(max){
            case r: h = (g - b) / d + (g < b ? 6 : 0); break;
            case g: h = (b - r) / d + 2; break;
            case b: h = (r - g) / d + 4; break;
        }
        h /= 6;
    }

    return [h, s, l];
}
</script>

<script>
var TransitionManager = function() {
	var transitionStart = null;
	var transitionEnd = null;
	var effectImage = null;

	var isTransitioning = false;
	var transitionTime = 0; // milliseconds
	var frameRate = 8; // cap the FPS
	var prevStep = -1; // used to avoid running post-process effect constantly

	this.BeginTransition = function(startRoom,startX,startY,endRoom,endX,endY,effectName) {
		// console.log("--- START ROOM TRANSITION ---");

		curEffect = effectName;

		var tmpRoom = player().room;
		var tmpX = player().x;
		var tmpY = player().y;

		if (transitionEffects[curEffect].showPlayerStart) {
			player().room = startRoom;
			player().x = startX;
			player().y = startY;
		}
		else {
			player().room = "_transition_none"; // kind of hacky!!
		}

		drawRoom(room[startRoom]);
		var startPalette = getPal( room[startRoom].pal );
		var startImage = new PostProcessImage( ctx.getImageData(0,0,canvas.width,canvas.height) ); // TODO : don't use global ctx?
		transitionStart = new TransitionInfo(startImage, startPalette, startX, startY);

		if (transitionEffects[curEffect].showPlayerEnd) {
			player().room = endRoom;
			player().x = endX;
			player().y = endY;
		}
		else {
			player().room = "_transition_none";
		}

		drawRoom(room[endRoom]);
		var endPalette = getPal( room[endRoom].pal );
		var endImage = new PostProcessImage( ctx.getImageData(0,0,canvas.width,canvas.height) );
		transitionEnd = new TransitionInfo(endImage, endPalette, endX, endY);

		effectImage = new PostProcessImage( ctx.createImageData(canvas.width,canvas.height) );

		isTransitioning = true;
		transitionTime = 0;
		prevStep = -1;

		player().room = tmpRoom;
		player().x = tmpX;
		player().y = tmpY;
	}

	this.UpdateTransition = function(dt) {
		if (!isTransitioning) {
			return;
		}

		transitionTime += dt;

		var transitionDelta = transitionTime / transitionEffects[curEffect].duration;
		var maxStep = Math.floor(frameRate * (transitionEffects[curEffect].duration / 1000));
		var step = Math.floor(transitionDelta * maxStep);

		if (step != prevStep) {
			// console.log("step! " + step + " " + transitionDelta);
			for (var y = 0; y < effectImage.Height; y++) {
				for (var x = 0; x < effectImage.Width; x++) {
					var color = transitionEffects[curEffect].pixelEffectFunc(transitionStart,transitionEnd,x,y,(step / maxStep));
					effectImage.SetPixel(x,y,color);
				}
			}
		}
		prevStep = step;

		ctx.putImageData(effectImage.GetData(), 0, 0);

		if (transitionTime >= transitionEffects[curEffect].duration) {
			isTransitioning = false;
			transitionTime = 0;
			transitionStart = null;
			transitionEnd = null;
			effectImage = null;
			prevStep = -1;

			if (transitionCompleteCallback != null) {
				transitionCompleteCallback();
			}
			transitionCompleteCallback = null;
		}
	}

	this.IsTransitionActive = function() {
		return isTransitioning;
	}

	// todo : should this be part of the constructor?
	var transitionCompleteCallback = null;
	this.OnTransitionComplete = function(callback) {
		if (isTransitioning) { // TODO : safety check necessary?
			transitionCompleteCallback = callback;
		}
	}

	var transitionEffects = {};
	var curEffect = "none";
	this.RegisterTransitionEffect = function(name, effect) {
		transitionEffects[name] = effect;
	}

	this.RegisterTransitionEffect("none", {
		showPlayerStart : false,
		showPlayerEnd : false,
		pixelEffectFunc : function() {},
	});

	this.RegisterTransitionEffect("fade_w", { // TODO : have it linger on full white briefly?
		showPlayerStart : false,
		showPlayerEnd : true,
		duration : 750,
		pixelEffectFunc : function(start,end,pixelX,pixelY,delta) {
			var pixelColorA = delta < 0.5 ? start.Image.GetPixel(pixelX,pixelY) : {r:255,g:255,b:255,a:255};
			var pixelColorB = delta < 0.5 ? {r:255,g:255,b:255,a:255} : end.Image.GetPixel(pixelX,pixelY);

			delta = delta < 0.5 ? (delta / 0.5) : ((delta - 0.5) / 0.5); // hacky

			return PostProcessUtilities.LerpColor(pixelColorA, pixelColorB, delta);
		}
	});

	this.RegisterTransitionEffect("fade_b", {
		showPlayerStart : false,
		showPlayerEnd : true,
		duration : 750,
		pixelEffectFunc : function(start,end,pixelX,pixelY,delta) {
			var pixelColorA = delta < 0.5 ? start.Image.GetPixel(pixelX,pixelY) : {r:0,g:0,b:0,a:255};
			var pixelColorB = delta < 0.5 ? {r:0,g:0,b:0,a:255} : end.Image.GetPixel(pixelX,pixelY);

			delta = delta < 0.5 ? (delta / 0.5) : ((delta - 0.5) / 0.5); // hacky

			return PostProcessUtilities.LerpColor(pixelColorA, pixelColorB, delta);
		}
	});

	this.RegisterTransitionEffect("wave", {
		showPlayerStart : true,
		showPlayerEnd : true,
		duration : 1500,
		pixelEffectFunc : function(start,end,pixelX,pixelY,delta) {
			var waveDelta = delta < 0.5 ? delta / 0.5 : 1 - ((delta - 0.5) / 0.5);

			var offset = (pixelY + (waveDelta * waveDelta * 0.2 * start.Image.Height));
			var freq = 4;
			var size = 2 + (14 * waveDelta);
			pixelX += Math.floor(Math.sin(offset / freq) * size);

			if (pixelX < 0) {
				pixelX += start.Image.Width;
			}
			else if (pixelX >= start.Image.Width) {
				pixelX -= start.Image.Width;
			}

			var curImage = delta < 0.5 ? start.Image : end.Image;
			return curImage.GetPixel(pixelX,pixelY);
		}
	});

	this.RegisterTransitionEffect("tunnel", {
		showPlayerStart : true,
		showPlayerEnd : true,
		duration : 1500,
		pixelEffectFunc : function(start,end,pixelX,pixelY,delta) {
			if (delta <= 0.4) {
				var tunnelDelta = 1 - (delta / 0.4);

				var xDist = start.PlayerCenter.x - pixelX;
				var yDist = start.PlayerCenter.y - pixelY;
				var dist = Math.sqrt((xDist * xDist) + (yDist * yDist));

				if (dist > start.Image.Width * tunnelDelta) {
					return {r:0,g:0,b:0,a:255};
				}
				else {
					return start.Image.GetPixel(pixelX,pixelY);
				}
			}
			else if (delta <= 0.6)
			{
				return {r:0,g:0,b:0,a:255};
			}
			else {
				var tunnelDelta = (delta - 0.6) / 0.4;

				var xDist = end.PlayerCenter.x - pixelX;
				var yDist = end.PlayerCenter.y - pixelY;
				var dist = Math.sqrt((xDist * xDist) + (yDist * yDist));

				if (dist > end.Image.Width * tunnelDelta) {
					return {r:0,g:0,b:0,a:255};
				}
				else {
					return end.Image.GetPixel(pixelX,pixelY);
				}
			}
		}
	});

	this.RegisterTransitionEffect("slide_u", {
		showPlayerStart : false,
		showPlayerEnd : true,
		duration : 1000,
		pixelEffectFunc : function(start,end,pixelX,pixelY,delta) {
			var pixelOffset = -1 * Math.floor(start.Image.Height * delta);
			var slidePixelY = pixelY + pixelOffset;

			var colorDelta = clampLerp(delta, 0.4);

			if (slidePixelY >= 0) {
				var colorA = start.Image.GetPixel(pixelX,slidePixelY);
				var colorB = PostProcessUtilities.GetCorrespondingColorFromPal(colorA,start.Palette,end.Palette);
				var colorLerped = PostProcessUtilities.LerpColor(colorA, colorB, colorDelta);
				return colorLerped;
			}
			else {
				slidePixelY += start.Image.Height;
				var colorB = end.Image.GetPixel(pixelX,slidePixelY);
				var colorA = PostProcessUtilities.GetCorrespondingColorFromPal(colorB,end.Palette,start.Palette);
				var colorLerped = PostProcessUtilities.LerpColor(colorA, colorB, colorDelta);
				return colorLerped;
			}
		}
	});

	this.RegisterTransitionEffect("slide_d", {
		showPlayerStart : false,
		showPlayerEnd : true,
		duration : 1000,
		pixelEffectFunc : function(start,end,pixelX,pixelY,delta) {
			var pixelOffset = Math.floor(start.Image.Height * delta);
			var slidePixelY = pixelY + pixelOffset;

			var colorDelta = clampLerp(delta, 0.4);

			if (slidePixelY < start.Image.Height) {
				var colorA = start.Image.GetPixel(pixelX,slidePixelY);
				var colorB = PostProcessUtilities.GetCorrespondingColorFromPal(colorA,start.Palette,end.Palette);
				var colorLerped = PostProcessUtilities.LerpColor(colorA, colorB, colorDelta);
				return colorLerped;
			}
			else {
				slidePixelY -= start.Image.Height;
				var colorB = end.Image.GetPixel(pixelX,slidePixelY);
				var colorA = PostProcessUtilities.GetCorrespondingColorFromPal(colorB,end.Palette,start.Palette);
				var colorLerped = PostProcessUtilities.LerpColor(colorA, colorB, colorDelta);
				return colorLerped;
			}
		}
	});

	this.RegisterTransitionEffect("slide_l", {
		showPlayerStart : false,
		showPlayerEnd : true,
		duration : 1000,
		pixelEffectFunc : function(start,end,pixelX,pixelY,delta) {
			var pixelOffset = -1 * Math.floor(start.Image.Width * delta);
			var slidePixelX = pixelX + pixelOffset;

			var colorDelta = clampLerp(delta, 0.4);

			if (slidePixelX >= 0) {
				var colorA = start.Image.GetPixel(slidePixelX,pixelY);
				var colorB = PostProcessUtilities.GetCorrespondingColorFromPal(colorA,start.Palette,end.Palette);
				var colorLerped = PostProcessUtilities.LerpColor(colorA, colorB, colorDelta);
				return colorLerped;
			}
			else {
				slidePixelX += start.Image.Width;
				var colorB = end.Image.GetPixel(slidePixelX,pixelY);
				var colorA = PostProcessUtilities.GetCorrespondingColorFromPal(colorB,end.Palette,start.Palette);
				var colorLerped = PostProcessUtilities.LerpColor(colorA, colorB, colorDelta);
				return colorLerped;
			}
		}
	});

	this.RegisterTransitionEffect("slide_r", {
		showPlayerStart : false,
		showPlayerEnd : true,
		duration : 1000,
		pixelEffectFunc : function(start,end,pixelX,pixelY,delta) {
			var pixelOffset = Math.floor(start.Image.Width * delta);
			var slidePixelX = pixelX + pixelOffset;

			var colorDelta = clampLerp(delta, 0.4);

			if (slidePixelX < start.Image.Width) {
				var colorA = start.Image.GetPixel(slidePixelX,pixelY);
				var colorB = PostProcessUtilities.GetCorrespondingColorFromPal(colorA,start.Palette,end.Palette);
				var colorLerped = PostProcessUtilities.LerpColor(colorA, colorB, colorDelta);
				return colorLerped;
			}
			else {
				slidePixelX -= start.Image.Width;
				var colorB = end.Image.GetPixel(slidePixelX,pixelY);
				var colorA = PostProcessUtilities.GetCorrespondingColorFromPal(colorB,end.Palette,start.Palette);
				var colorLerped = PostProcessUtilities.LerpColor(colorA, colorB, colorDelta);
				return colorLerped;
			}
		}
	});

	function clampLerp(deltaIn, clampDuration) {
		var clampOffset = (1.0 - clampDuration) / 2;
		var deltaOut = Math.min(clampDuration, Math.max(0.0, deltaIn - clampOffset)) / clampDuration;
		return deltaOut;
	}

	// TODO : WIP
	// this.RegisterTransitionEffect("fuzz", {
	// 	showPlayerStart : true,
	// 	showPlayerEnd : true,
	// 	duration : 1500,
	// 	pixelEffectFunc : function(start,end,pixelX,pixelY,delta) {
	// 		var curImage = delta <= 0.5 ? start : end;
	// 		var sampleSize = delta <= 0.5 ? (2 + Math.floor(14 * (delta/0.5))) : (16 - Math.floor(14 * ((delta-0.5)/0.5)));

	// 		var palIndex = 0;

	// 		var sampleX = Math.floor(pixelX / sampleSize) * sampleSize;
	// 		var sampleY = Math.floor(pixelY / sampleSize) * sampleSize;

	// 		var frameState = transitionEffects["fuzz"].frameState;

	// 		if (frameState.time != delta) {
	// 			frameState.time = delta;
	// 			frameState.preCalcSampleValues = {};
	// 		}

	// 		if (frameState.preCalcSampleValues[[sampleX,sampleY]]) {
	// 			palIndex = frameState.preCalcSampleValues[[sampleX,sampleY]];
	// 		}
	// 		else {
	// 			var paletteCount = {};
	// 			var foregroundValue = 1.0;
	// 			var backgroundValue = 0.4;
	// 			for (var y = sampleY; y < sampleY + sampleSize; y++) {
	// 				for (var x = sampleX; x < sampleX + sampleSize; x++) {
	// 					var color = curImage.Image.GetPixel(x,y)
	// 					var palIndex = PostProcessUtilities.GetColorPalIndex(color,curImage.Palette);
	// 					if (palIndex != -1) {
	// 						if (paletteCount[palIndex]) {
	// 							paletteCount[palIndex] += (palIndex != 0) ? foregroundValue : backgroundValue;
	// 						}
	// 						else {
	// 							paletteCount[palIndex] = (palIndex != 0) ? foregroundValue : backgroundValue;
	// 						}
	// 					}
	// 				}
	// 			}

	// 			var maxCount = 0;
	// 			for (var i in paletteCount) {
	// 				if (paletteCount[i] > maxCount) {
	// 					palIndex = i;
	// 					maxCount = paletteCount[i];
	// 				}
	// 			}

	// 			frameState.preCalcSampleValues[[sampleX,sampleY]] = palIndex;
	// 		}

	// 		return PostProcessUtilities.GetPalColor(curImage.Palette,palIndex);
	// 	},
	// 	frameState : { // ok this is hacky but it's for performance ok
	// 		time : -1,
	// 		preCalcSampleValues : {}
	// 	}
	// });
}; // TransitionManager()


// TODO : extract the scale variable so it can be changed?
var PostProcessUtilities = {
	SamplePixelColor : function(image,x,y) {
		var pixelIndex = (y * scale * image.width * 4) + (x * scale * 4);
		var r = image.data[pixelIndex + 0];
		var g = image.data[pixelIndex + 1];
		var b = image.data[pixelIndex + 2];
		var a = image.data[pixelIndex + 3];
		return { r:r, g:g, b:b, a:a };
	},
	SetPixelColor : function(image,x,y,colorRgba) {
		for (var yDelta = 0; yDelta < scale; yDelta++) {
			for (var xDelta = 0; xDelta < scale; xDelta++) {
				var pixelIndex = (((y * scale) + yDelta) * image.width * 4) + (((x * scale) + xDelta) * 4);
				image.data[pixelIndex + 0] = colorRgba.r;
				image.data[pixelIndex + 1] = colorRgba.g;
				image.data[pixelIndex + 2] = colorRgba.b;
				image.data[pixelIndex + 3] = colorRgba.a;
			}
		}
	},
	LerpColor : function(colorA,colorB,t) {
		// TODO: move to color_util.js?
		return {
			r : colorA.r + ((colorB.r - colorA.r) * t),
			g : colorA.g + ((colorB.g - colorA.g) * t),
			b : colorA.b + ((colorB.b - colorA.b) * t),
			a : colorA.a + ((colorB.a - colorA.a) * t),
		};
	},
	GetColorPalIndex : function(colorIn,curPal) {
		var colorIndex = -1;

		for (var i = 0; i < curPal.length; i++) {
			if (colorIn.r == curPal[i][0] && colorIn.g == curPal[i][1] && colorIn.b == curPal[i][2]) {
				colorIndex = i;
			}
		}

		return colorIndex;
	},
	GetPalColor : function(palette,index) {
		return { r: palette[index][0], g: palette[index][1], b: palette[index][2], a: 255 }
	},
	GetCorrespondingColorFromPal : function(colorIn,curPal,otherPal) { // this is kind of hacky!
		var colorIndex = PostProcessUtilities.GetColorPalIndex(colorIn,curPal);

		if (colorIndex >= 0 && colorIndex <= otherPal.length) {
			return PostProcessUtilities.GetPalColor(otherPal,colorIndex);
		}
		else {
			return colorIn;
		}
	},
};

var PostProcessImage = function(imageData) {
	this.Width = imageData.width / scale;
	this.Height = imageData.height / scale;

	this.GetPixel = function(x,y) {
		return PostProcessUtilities.SamplePixelColor(imageData,x,y);
	};

	this.SetPixel = function(x,y,colorRgba) {
		PostProcessUtilities.SetPixelColor(imageData,x,y,colorRgba);
	};

	this.GetData = function() {
		return imageData;
	};
};

var TransitionInfo = function(image, palette, playerX, playerY) {
	this.Image = image;
	this.Palette = palette;
	this.PlayerTilePos = { x: playerX, y: playerY };
	this.PlayerCenter = { x: Math.floor((playerX * tilesize) + (tilesize / 2)), y: Math.floor((playerY * tilesize) + (tilesize / 2)) };
};
</script>

<script>
/*
TODO:
- can I simplify this more now that I've removed the external resources stuff?
*/

function FontManager(packagedFontNames) {

var self = this;

var fontExtension = ".bitsyfont";
this.GetExtension = function() {
	return fontExtension;
}

// place to store font data
var fontResources = {};

// load fonts from the editor
if (packagedFontNames != undefined && packagedFontNames != null && packagedFontNames.length > 0
		&& Resources != undefined && Resources != null) {

	for (var i = 0; i < packagedFontNames.length; i++) {
		var filename = packagedFontNames[i];
		fontResources[filename] = Resources[filename];
	}
}

// manually add resource
this.AddResource = function(filename, fontdata) {
	fontResources[filename] = fontdata;
}

this.ContainsResource = function(filename) {
	return fontResources[filename] != null;
}

function GetData(fontName) {
	return fontResources[fontName + fontExtension];
}
this.GetData = GetData;

function Create(fontData) {
	return new Font(fontData);
}
this.Create = Create;

this.Get = function(fontName) {
	var fontData = self.GetData(fontName);
	return self.Create(fontData);
}

function Font(fontData) {
	var name = "unknown";
	var width = 6; // default size so if you have NO font or an invalid font it displays boxes
	var height = 8;
	var chardata = {};

	// create invalid char data at default size in case the font is missing
	var invalidCharData = {};
	updateInvalidCharData();

	this.getName = function() {
		return name;
	}

	this.getData = function() {
		return chardata;
	}

	this.getWidth = function() {
		return width;
	}

	this.getHeight = function() {
		return height;
	}

	this.hasChar = function(char) {
		var codepoint = char.charCodeAt(0);
		return chardata[codepoint] != null;
	}

	this.getChar = function(char) {

		var codepoint = char.charCodeAt(0);

		if (chardata[codepoint] != null) {
			return chardata[codepoint];
		}
		else {
			return invalidCharData;
		}
	}

	this.allCharCodes = function() {
		var codeList = [];
		for (var code in chardata) {
			codeList.push(code);
		}
		return codeList;
	}

	function createCharData() {
		return { 
			width: width,
			height: height,
			offset: {
				x: 0,
				y: 0
			},
			spacing: width,
			data: [],
		};
	}

	function updateInvalidCharData() {
		invalidCharData = createCharData();
		for (var y = 0; y < height; y++) {
			for (var x = 0; x < width; x++) {
				if (x < width-1 && y < height-1) {
					invalidCharData.data.push(1);
				}
				else {
					invalidCharData.data.push(0);
				}
			}
		}
	}

	function parseFont(fontData) {
		if (fontData == null) {
			return;
		}

		var lines = fontData.split("\n");

		var isReadingChar = false;
		var isReadingCharProperties = false;
		var curCharLineCount = 0;
		var curCharCode = 0;

		for (var i = 0; i < lines.length; i++) {
			var line = lines[i];

			if (line[0] === "#") {
				continue; // skip comment lines
			}

			if (!isReadingChar) {
				// READING NON CHARACTER DATA LINE
				var args = line.split(" ");
				if (args[0] == "FONT") {
					name = args[1];
				}
				else if (args[0] == "SIZE") {
					width = parseInt(args[1]);
					height = parseInt(args[2]);
				}
				else if (args[0] == "CHAR") {
					isReadingChar = true;
					isReadingCharProperties = true;

					curCharLineCount = 0;
					curCharCode = parseInt(args[1]);
					chardata[curCharCode] = createCharData();
				}
			}
			else {
				// CHAR PROPERTIES
				if (isReadingCharProperties) {
					var args = line.split(" ");
					if (args[0].indexOf("CHAR_") == 0) { // Sub-properties start with "CHAR_"
						if (args[0] == "CHAR_SIZE") {
							// Custom character size - overrides the default character size for the font
							chardata[curCharCode].width = parseInt(args[1]);
							chardata[curCharCode].height = parseInt(args[2]);
							chardata[curCharCode].spacing = parseInt(args[1]); // HACK : assumes CHAR_SIZE is always declared first
						}
						else if (args[0] == "CHAR_OFFSET") {
							// Character offset - shift the origin of the character on the X or Y axis
							chardata[curCharCode].offset.x = parseInt(args[1]);
							chardata[curCharCode].offset.y = parseInt(args[2]);
						}
						else if (args[0] == "CHAR_SPACING") {
							// Character spacing:
							// specify total horizontal space taken up by the character
							// lets chars take up more or less space on a line than its bitmap does
							chardata[curCharCode].spacing = parseInt(args[1]);
						}
					}
					else {
						isReadingCharProperties = false;
					}
				}

				// CHAR DATA
				if (!isReadingCharProperties) {
					// READING CHARACTER DATA LINE
					for (var j = 0; j < chardata[curCharCode].width; j++)
					{
						chardata[curCharCode].data.push( parseInt(line[j]) );
					}

					curCharLineCount++;
					if (curCharLineCount >= height) {
						isReadingChar = false;
					}
				}
			}
		}

		// re-init invalid character box at the actual font size once it's loaded
		updateInvalidCharData();
	}

	parseFont(fontData);
}

} // FontManager
</script>

<script>
function Script() {

this.CreateInterpreter = function() {
	return new Interpreter();
};

this.CreateUtils = function() {
	return new Utils();
};

var Interpreter = function() {
	var env = new Environment();
	var parser = new Parser( env );

	this.SetDialogBuffer = function(buffer) { env.SetDialogBuffer( buffer ); };

	// TODO -- maybe this should return a string instead othe actual script??
	this.Compile = function(scriptName, scriptStr) {
		// console.log("COMPILE");
		var script = parser.Parse(scriptStr, scriptName);
		env.SetScript(scriptName, script);
	}
	this.Run = function(scriptName, exitHandler, objectContext) { // Runs pre-compiled script
		var localEnv = new LocalEnvironment(env);

		if (objectContext) {
			localEnv.SetObject(objectContext); // PROTO : should this be folded into the constructor?
		}

		var script = env.GetScript(scriptName);

		script.Eval( localEnv, function(result) { OnScriptReturn(localEnv, exitHandler); } );
	}
	this.Interpret = function(scriptStr, exitHandler, objectContext) { // Compiles and runs code immediately
		// console.log("INTERPRET");
		var localEnv = new LocalEnvironment(env);

		if (objectContext) {
			localEnv.SetObject(objectContext); // PROTO : should this be folded into the constructor?
		}

		var script = parser.Parse(scriptStr, "anonymous");
		script.Eval( localEnv, function(result) { OnScriptReturn(localEnv, exitHandler); } );
	}
	this.HasScript = function(name) { return env.HasScript(name); };

	this.ResetEnvironment = function() {
		env = new Environment();
		parser = new Parser( env );
	}

	this.Parse = function(scriptStr, rootId) { // parses a script but doesn't save it
		return parser.Parse(scriptStr, rootId);
	}

	// TODO : add back in if needed later...
	// this.CompatibilityParse = function(scriptStr, compatibilityFlags) {
	// 	env.compatibilityFlags = compatibilityFlags;

	// 	var result = parser.Parse(scriptStr);

	// 	delete env.compatibilityFlags;

	// 	return result;
	// }

	this.Eval = function(scriptTree, exitHandler) { // runs a script stored externally
		var localEnv = new LocalEnvironment(env); // TODO : does this need an object context?
		scriptTree.Eval(
			localEnv,
			function(result) {
				OnScriptReturn(result, exitHandler);
			});
	}

	function OnScriptReturn(result, exitHandler) {
		if (exitHandler != null) {
			exitHandler(result);
		}
	}

	this.CreateExpression = function(expStr) {
		return parser.CreateExpression(expStr);
	}

	this.SetVariable = function(name,value,useHandler) {
		env.SetVariable(name,value,useHandler);
	}

	this.DeleteVariable = function(name,useHandler) {
		env.DeleteVariable(name,useHandler);
	}
	this.HasVariable = function(name) {
		return env.HasVariable(name);
	}

	this.SetOnVariableChangeHandler = function(onVariableChange) {
		env.SetOnVariableChangeHandler(onVariableChange);
	}
	this.GetVariableNames = function() {
		return env.GetVariableNames();
	}
	this.GetVariable = function(name) {
		return env.GetVariable(name);
	}

	function DebugVisualizeScriptTree(scriptTree) {
		var printVisitor = {
			Visit : function(node,depth) {
				console.log("-".repeat(depth) + "- " + node.ToString());
			},
		};

		scriptTree.VisitAll( printVisitor );
	}

	this.DebugVisualizeScriptTree = DebugVisualizeScriptTree;

	this.DebugVisualizeScript = function(scriptName) {
		DebugVisualizeScriptTree(env.GetScript(scriptName));
	}
}


var Utils = function() {
	// for editor ui
	this.CreateDialogBlock = function(children,doIndentFirstLine) {
		if (doIndentFirstLine === undefined) {
			doIndentFirstLine = true;
		}

		var block = new DialogBlockNode(doIndentFirstLine);

		for (var i = 0; i < children.length; i++) {
			block.AddChild(children[i]);
		}
		return block;
	}

	this.CreateOptionBlock = function() {
		var block = new DialogBlockNode(false);
		block.AddChild(new FuncNode("print", [new LiteralNode(" ")]));
		return block;
	}

	this.CreateItemConditionPair = function() {
		var itemFunc = this.CreateFunctionBlock("item", ["0"]);
		var condition = new ExpNode("==", itemFunc, new LiteralNode(1));
		var result = new DialogBlockNode(true);
		result.AddChild(new FuncNode("print", [new LiteralNode(" ")]));
		var conditionPair = new ConditionPairNode(condition, result);
		return conditionPair;
	}

	this.CreateVariableConditionPair = function() {
		var varNode = this.CreateVariableNode("a");
		var condition = new ExpNode("==", varNode, new LiteralNode(1));
		var result = new DialogBlockNode(true);
		result.AddChild(new FuncNode("print", [new LiteralNode(" ")]));
		var conditionPair = new ConditionPairNode(condition, result);
		return conditionPair;
	}

	this.CreateDefaultConditionPair = function() {
		var condition = this.CreateElseNode();
		var result = new DialogBlockNode(true);
		result.AddChild(new FuncNode("print", [new LiteralNode(" ")]));
		var conditionPair = new ConditionPairNode(condition, result);
		return conditionPair;
	}

	this.CreateEmptyPrintFunc = function() {
		return new FuncNode("print", [new LiteralNode("...")]);
	}

	this.CreateFunctionBlock = function(name, initParamValues) {
		var parameters = [];
		for (var i = 0; i < initParamValues.length; i++) {
			parameters.push(new LiteralNode(initParamValues[i]));
		}

		var node = new FuncNode(name, parameters);
		var block = new CodeBlockNode();
		block.AddChild(node);
		return block;
	}

	// TODO : rename ParseStringToLiteralNode?
	this.CreateLiteralNode = function(str) {
		if (str === "true") {
			return new LiteralNode(true);
		}
		else if (str === "false") {
			return new LiteralNode(false);
		}
		else if (!isNaN(parseFloat(str))) {
			return new LiteralNode(parseFloat(str));
		}
		else {
			return new LiteralNode(str);
		}
	}

	this.CreateVariableNode = function(variableName) {
		return new VarNode(variableName);
	}

	this.CreatePropertyNode = function(propertyName, literalValue) {
		var varNode = new VarNode(propertyName);
		var valNode = new LiteralNode(literalValue);
		var node = new FuncNode("property", [varNode, valNode]);
		var block = new CodeBlockNode();
		block.AddChild(node);
		return block;
	}

	this.CreateElseNode = function() {
		return new ElseNode();
	}

	this.CreateStringLiteralNode = function(str) {
		return new LiteralNode(str);
	}

	// TODO : need to split up code & dialog blocks :|
	this.CreateCodeBlock = function() {
		return new CodeBlockNode();
	}

	this.ChangeSequenceType = function(oldSequence, type) {
		if(type === "sequence") {
			return new SequenceNode(oldSequence.children);
		}
		else if(type === "cycle") {
			return new CycleNode(oldSequence.children);
		}
		else if(type === "shuffle") {
			return new ShuffleNode(oldSequence.children);
		}
		return oldSequence;
	}

	this.CreateSequenceBlock = function() {
		var option1 = new DialogBlockNode( false /*doIndentFirstLine*/ );
		option1.AddChild(new FuncNode("print", [new LiteralNode("...")]));

		var option2 = new DialogBlockNode( false /*doIndentFirstLine*/ );
		option2.AddChild(new FuncNode("print", [new LiteralNode("...")]));

		var sequence = new SequenceNode( [ option1, option2 ] );
		var block = new CodeBlockNode();
		block.AddChild( sequence );
		return block;
	}

	this.CreateCycleBlock = function() {
		var option1 = new DialogBlockNode( false /*doIndentFirstLine*/ );
		option1.AddChild(new FuncNode("print", [new LiteralNode("...")]));

		var option2 = new DialogBlockNode( false /*doIndentFirstLine*/ );
		option2.AddChild(new FuncNode("print", [new LiteralNode("...")]));

		var sequence = new CycleNode( [ option1, option2 ] );
		var block = new CodeBlockNode();
		block.AddChild( sequence );
		return block;
	}

	this.CreateShuffleBlock = function() {
		var option1 = new DialogBlockNode( false /*doIndentFirstLine*/ );
		option1.AddChild(new FuncNode("print", [new LiteralNode("...")]));

		var option2 = new DialogBlockNode( false /*doIndentFirstLine*/ );
		option2.AddChild(new FuncNode("print", [new LiteralNode("...")]));

		var sequence = new ShuffleNode( [ option1, option2 ] );
		var block = new CodeBlockNode();
		block.AddChild( sequence );
		return block;
	}

	this.CreateIfBlock = function() {
		var leftNode = new CodeBlockNode();
		leftNode.AddChild( new FuncNode("item", [new LiteralNode("0")] ) );
		var rightNode = new LiteralNode( 1 );
		var condition1 = new ExpNode("==", leftNode, rightNode );

		var condition2 = new ElseNode();

		var result1 = new DialogBlockNode();
		result1.AddChild(new FuncNode("print", [new LiteralNode("...")]));

		var result2 = new DialogBlockNode();
		result2.AddChild(new FuncNode("print", [new LiteralNode("...")]));

		var ifNode = new IfNode( [ condition1, condition2 ], [ result1, result2 ] );
		var block = new CodeBlockNode();
		block.AddChild( ifNode );
		return block;
	}

	this.ReadDialogScript = function(lines, i) {
		var scriptStr = "";
		if (lines[i] === Sym.DialogOpen) {
			scriptStr += lines[i] + "\n";
			i++;
			while(lines[i] != Sym.DialogClose) {
				scriptStr += lines[i] + "\n";
				i++;
			}
			scriptStr += lines[i];
			i++;
		}
		else {
			scriptStr += lines[i];
			i++;
		}
		return { script:scriptStr, index:i };
	}

	// TODO this.ReadCodeScript (reads through code open and close symbols), and this.ReadScript

	this.EnsureDialogBlockFormat = function(dialogStr) {
		// TODO -- what if it's already enclosed in dialog symbols??
		if(dialogStr.indexOf('\n') > -1) {
			dialogStr = Sym.DialogOpen + "\n" + dialogStr + "\n" + Sym.DialogClose;
		}
		return dialogStr;
	}

	this.RemoveDialogBlockFormat = function(source) {
		var sourceLines = source.split("\n");
		var dialogStr = "";
		if(sourceLines[0] === Sym.DialogOpen) {
			// multi line
			var i = 1;
			while (i < sourceLines.length && sourceLines[i] != Sym.DialogClose) {
				dialogStr += sourceLines[i] + (sourceLines[i+1] != Sym.DialogClose ? '\n' : '');
				i++;
			}
		}
		else {
			// single line
			dialogStr = source;
		}
		return dialogStr;
	}

	this.SerializeDialogNodeList = function(nodeList) {
		var tempBlock = new DialogBlockNode(false);
		 // set children directly to avoid breaking the parenting chain for this temp operation
		tempBlock.children = nodeList;
		return tempBlock.Serialize();
	}

	this.GetOperatorList = function() {
		return [Sym.Set].concat(Sym.Operators);
	}

	this.IsInlineCode = function(node) {
		return isInlineCode(node);
	}
}


/* BUILT-IN FUNCTIONS */ // TODO: better way to encapsulate these?
function deprecatedFunc(environment,parameters,onReturn) {
	console.log("BITSY SCRIPT WARNING: Tried to use deprecated function");
	onReturn(null);
}

function printFunc(environment, parameters, onReturn) {
	if (parameters[0] != undefined && parameters[0] != null) {
		var textStr = "" + parameters[0];
		environment.GetDialogBuffer().AddText(textStr);
		environment.GetDialogBuffer().AddScriptReturn(function() { onReturn(null); });
	}
	else {
		onReturn(null);
	}
}

function linebreakFunc(environment, parameters, onReturn) {
	// console.log("LINEBREAK FUNC");
	environment.GetDialogBuffer().AddLinebreak();
	environment.GetDialogBuffer().AddScriptReturn(function() { onReturn(null); });
}

function pagebreakFunc(environment, parameters, onReturn) {
	environment.GetDialogBuffer().AddPagebreak(function() { onReturn(null); });
}

function printDrawingFunc(environment, parameters, onReturn) {
	var drawingId = parameters[0];
	environment.GetDialogBuffer().AddDrawing(drawingId);
	environment.GetDialogBuffer().AddScriptReturn(function() { onReturn(null); });
}

function printSpriteFunc(environment,parameters,onReturn) {
	var spriteId = parameters[0];
	if(names.sprite.has(spriteId)) spriteId = names.sprite.get(spriteId); // id is actually a name
	var drawingId = sprite[spriteId].drw;
	printDrawingFunc(environment, [drawingId], onReturn);
}

function printTileFunc(environment,parameters,onReturn) {
	var tileId = parameters[0];
	if(names.tile.has(tileId)) tileId = names.tile.get(tileId); // id is actually a name
	var drawingId = tile[tileId].drw;
	printDrawingFunc(environment, [drawingId], onReturn);
}

function printItemFunc(environment,parameters,onReturn) {
	var itemId = parameters[0];
	if(names.item.has(itemId)) itemId = names.item.get(itemId); // id is actually a name
	var drawingId = item[itemId].drw;
	printDrawingFunc(environment, [drawingId], onReturn);
}

function printFontFunc(environment, parameters, onReturn) {
	var allCharacters = "";
	var font = fontManager.Get( fontName );
	var codeList = font.allCharCodes();
	for (var i = 0; i < codeList.length; i++) {
		allCharacters += String.fromCharCode(codeList[i]) + " ";
	}
	printFunc(environment, [allCharacters], onReturn);
}

function itemFunc(environment,parameters,onReturn) {
	var itemId = parameters[0];

	if (names.item.has(itemId)) {
		// id is actually a name
		itemId = names.item.get(itemId);
	}

	var curItemCount = player().inventory[itemId] ? player().inventory[itemId] : 0;

	if (parameters.length > 1) {
		// TODO : is it a good idea to force inventory to be >= 0?
		player().inventory[itemId] = Math.max(0, parseInt(parameters[1]));
		curItemCount = player().inventory[itemId];

		if (onInventoryChanged != null) {
			onInventoryChanged(itemId);
		}
	}

	onReturn(curItemCount);
}

function addOrRemoveTextEffect(environment,name) {
	if( environment.GetDialogBuffer().HasTextEffect(name) )
		environment.GetDialogBuffer().RemoveTextEffect(name);
	else
		environment.GetDialogBuffer().AddTextEffect(name);
}

function rainbowFunc(environment,parameters,onReturn) {
	addOrRemoveTextEffect(environment,"rbw");
	onReturn(null);
}

// TODO : should the colors use a parameter instead of special names?
function color1Func(environment,parameters,onReturn) {
	addOrRemoveTextEffect(environment,"clr1");
	onReturn(null);
}

function color2Func(environment,parameters,onReturn) {
	addOrRemoveTextEffect(environment,"clr2");
	onReturn(null);
}

function color3Func(environment,parameters,onReturn) {
	addOrRemoveTextEffect(environment,"clr3");
	onReturn(null);
}

function wavyFunc(environment,parameters,onReturn) {
	addOrRemoveTextEffect(environment,"wvy");
	onReturn(null);
}

function shakyFunc(environment,parameters,onReturn) {
	addOrRemoveTextEffect(environment,"shk");
	onReturn(null);
}

function propertyFunc(environment, parameters, onReturn) {
	var outValue = null;

	if (parameters.length > 0 && parameters[0]) {
		var propertyName = parameters[0];

		if (environment.HasProperty(propertyName)) {
			// TODO : in a future update I can handle the case of initializing a new property
			// after which we can move this block outside the HasProperty check
			if (parameters.length > 1) {
				var inValue = parameters[1];
				environment.SetProperty(propertyName, inValue);
			}

			outValue = environment.GetProperty(propertyName);
		}
	}

	console.log("PROPERTY! " + propertyName + " " + outValue);

	onReturn(outValue);
}

function endFunc(environment,parameters,onReturn) {
	isEnding = true;
	isNarrating = true;
	dialogRenderer.SetCentered(true);
	onReturn(null);
}

function exitFunc(environment,parameters,onReturn) {
	var destRoom = parameters[0];

	if (names.room.has(destRoom)) {
		// it's a name, not an id! (note: these could cause trouble if people names things weird)
		destRoom = names.room.get(destRoom);
	}

	var destX = parseInt(parameters[1]);
	var destY = parseInt(parameters[2]);

	if (parameters.length >= 4) {
		var transitionEffect = parameters[3];

		transition.BeginTransition(
			player().room,
			player().x,
			player().y,
			destRoom,
			destX,
			destY,
			transitionEffect);
		transition.UpdateTransition(0);
	}

	player().room = destRoom;
	player().x = destX;
	player().y = destY;
	curRoom = destRoom;
	initRoom(curRoom);

	// TODO : this doesn't play nice with pagebreak because it thinks the dialog is finished!
	if (transition.IsTransitionActive()) {
		transition.OnTransitionComplete(function() { onReturn(null); });
	}
	else {
		onReturn(null);
	}
}

/* BUILT-IN OPERATORS */
function setExp(environment,left,right,onReturn) {
	// console.log("SET " + left.name);

	if(left.type != "variable") {
		// not a variable! return null and hope for the best D:
		onReturn( null );
		return;
	}

	right.Eval(environment,function(rVal) {
		environment.SetVariable( left.name, rVal );
		// console.log("VAL " + environment.GetVariable( left.name ) );
		left.Eval(environment,function(lVal) {
			onReturn( lVal );
		});
	});
}
function equalExp(environment,left,right,onReturn) {
	// console.log("EVAL EQUAL");
	// console.log(left);
	// console.log(right);
	right.Eval(environment,function(rVal){
		left.Eval(environment,function(lVal){
			onReturn( lVal === rVal );
		});
	});
}
function greaterExp(environment,left,right,onReturn) {
	right.Eval(environment,function(rVal){
		left.Eval(environment,function(lVal){
			onReturn( lVal > rVal );
		});
	});
}
function lessExp(environment,left,right,onReturn) {
	right.Eval(environment,function(rVal){
		left.Eval(environment,function(lVal){
			onReturn( lVal < rVal );
		});
	});
}
function greaterEqExp(environment,left,right,onReturn) {
	right.Eval(environment,function(rVal){
		left.Eval(environment,function(lVal){
			onReturn( lVal >= rVal );
		});
	});
}
function lessEqExp(environment,left,right,onReturn) {
	right.Eval(environment,function(rVal){
		left.Eval(environment,function(lVal){
			onReturn( lVal <= rVal );
		});
	});
}
function multExp(environment,left,right,onReturn) {
	right.Eval(environment,function(rVal){
		left.Eval(environment,function(lVal){
			onReturn( lVal * rVal );
		});
	});
}
function divExp(environment,left,right,onReturn) {
	right.Eval(environment,function(rVal){
		left.Eval(environment,function(lVal){
			onReturn( lVal / rVal );
		});
	});
}
function addExp(environment,left,right,onReturn) {
	right.Eval(environment,function(rVal){
		left.Eval(environment,function(lVal){
			onReturn( lVal + rVal );
		});
	});
}
function subExp(environment,left,right,onReturn) {
	right.Eval(environment,function(rVal){
		left.Eval(environment,function(lVal){
			onReturn( lVal - rVal );
		});
	});
}

/* ENVIRONMENT */
var Environment = function() {
	var dialogBuffer = null;
	this.SetDialogBuffer = function(buffer) { dialogBuffer = buffer; };
	this.GetDialogBuffer = function() { return dialogBuffer; };

	var functionMap = new Map();
	functionMap.set("print", printFunc);
	functionMap.set("say", printFunc);
	functionMap.set("br", linebreakFunc);
	functionMap.set("item", itemFunc);
	functionMap.set("rbw", rainbowFunc);
	functionMap.set("clr1", color1Func);
	functionMap.set("clr2", color2Func);
	functionMap.set("clr3", color3Func);
	functionMap.set("wvy", wavyFunc);
	functionMap.set("shk", shakyFunc);
	functionMap.set("printSprite", printSpriteFunc);
	functionMap.set("printTile", printTileFunc);
	functionMap.set("printItem", printItemFunc);
	functionMap.set("debugOnlyPrintFont", printFontFunc); // DEBUG ONLY
	functionMap.set("end", endFunc);
	functionMap.set("exit", exitFunc);
	functionMap.set("pg", pagebreakFunc);
	functionMap.set("property", propertyFunc);

	this.HasFunction = function(name) { return functionMap.has(name); };
	this.EvalFunction = function(name,parameters,onReturn,env) {
		if (env == undefined || env == null) {
			env = this;
		}

		functionMap.get(name)(env, parameters, onReturn);
	}

	var variableMap = new Map();

	this.HasVariable = function(name) { return variableMap.has(name); };
	this.GetVariable = function(name) { return variableMap.get(name); };
	this.SetVariable = function(name,value,useHandler) {
		// console.log("SET VARIABLE " + name + " = " + value);
		if(useHandler === undefined) useHandler = true;
		variableMap.set(name, value);
		if(onVariableChangeHandler != null && useHandler){
			onVariableChangeHandler(name);
		}
	};
	this.DeleteVariable = function(name,useHandler) {
		if(useHandler === undefined) useHandler = true;
		if(variableMap.has(name)) {
			variableMap.delete(name);
			if(onVariableChangeHandler != null && useHandler) {
				onVariableChangeHandler(name);
			}
		}
	};

	var operatorMap = new Map();
	operatorMap.set("=", setExp);
	operatorMap.set("==", equalExp);
	operatorMap.set(">", greaterExp);
	operatorMap.set("<", lessExp);
	operatorMap.set(">=", greaterEqExp);
	operatorMap.set("<=", lessEqExp);
	operatorMap.set("*", multExp);
	operatorMap.set("/", divExp);
	operatorMap.set("+", addExp);
	operatorMap.set("-", subExp);

	this.HasOperator = function(sym) { return operatorMap.get(sym); };
	this.EvalOperator = function(sym,left,right,onReturn) {
		operatorMap.get( sym )( this, left, right, onReturn );
	}

	var scriptMap = new Map();
	this.HasScript = function(name) { return scriptMap.has(name); };
	this.GetScript = function(name) { return scriptMap.get(name); };
	this.SetScript = function(name,script) { scriptMap.set(name, script); };

	var onVariableChangeHandler = null;
	this.SetOnVariableChangeHandler = function(onVariableChange) {
		onVariableChangeHandler = onVariableChange;
	}
	this.GetVariableNames = function() {
		return Array.from( variableMap.keys() );
	}
}

// Local environment for a single run of a script: knows local context
var LocalEnvironment = function(parentEnvironment) {
	// this.SetDialogBuffer // not allowed in local environment?
	this.GetDialogBuffer = function() { return parentEnvironment.GetDialogBuffer(); };

	this.HasFunction = function(name) { return parentEnvironment.HasFunction(name); };
	this.EvalFunction = function(name,parameters,onReturn,env) {
		if (env == undefined || env == null) {
			env = this;
		}

		parentEnvironment.EvalFunction(name,parameters,onReturn,env);
	}

	this.HasVariable = function(name) { return parentEnvironment.HasVariable(name); };
	this.GetVariable = function(name) { return parentEnvironment.GetVariable(name); };
	this.SetVariable = function(name,value,useHandler) { parentEnvironment.SetVariable(name,value,useHandler); };
	// this.DeleteVariable // not needed in local environment?

	this.HasOperator = function(sym) { return parentEnvironment.HasOperator(sym); };
	this.EvalOperator = function(sym,left,right,onReturn,env) {
		if (env == undefined || env == null) {
			env = this;
		}

		parentEnvironment.EvalOperator(sym,left,right,onReturn,env);
	};

	// TODO : I don't *think* any of this is required by the local environment
	// this.HasScript
	// this.GetScript
	// this.SetScript

	// TODO : pretty sure these debug methods aren't required by the local environment either
	// this.SetOnVariableChangeHandler
	// this.GetVariableNames

	/* Here's where specific local context data goes:
	 * this includes access to the object running the script
	 * and any properties it may have (so far only "locked")
	 */

	// The local environment knows what object called it -- currently only used to access properties
	var curObject = null;
	this.HasObject = function() { return curObject != undefined && curObject != null; }
	this.SetObject = function(object) { curObject = object; }
	this.GetObject = function() { return curObject; }

	// accessors for properties of the object that's running the script
	this.HasProperty = function(name) {
		if (curObject && curObject.property && curObject.property.hasOwnProperty(name)) {
			return true;
		}
		else {
			return false;
		}
	};
	this.GetProperty = function(name) {
		if (curObject && curObject.property && curObject.property.hasOwnProperty(name)) {
			return curObject.property[name]; // TODO : should these be getters and setters instead?
		}
		else {
			return null;
		}
	};
	this.SetProperty = function(name, value) {
		// NOTE : for now, we need to gaurd against creating new properties
		if (curObject && curObject.property && curObject.property.hasOwnProperty(name)) {
			curObject.property[name] = value;
		}
	};
}

function leadingWhitespace(depth) {
	var str = "";
	for(var i = 0; i < depth; i++) {
		str += "  "; // two spaces per indent
	}
	// console.log("WHITESPACE " + depth + " ::" + str + "::");
	return str;
}

/* NODES */
var TreeRelationship = function() {
	this.parent = null;
	this.children = [];

	this.AddChild = function(node) {
		this.children.push(node);
		node.parent = this;
	};

	this.AddChildren = function(nodeList) {
		for (var i = 0; i < nodeList.length; i++) {
			this.AddChild(nodeList[i]);
		}
	};

	this.SetChildren = function(nodeList) {
		this.children = [];
		this.AddChildren(nodeList);
	};

	this.VisitAll = function(visitor, depth) {
		if (depth == undefined || depth == null) {
			depth = 0;
		}

		visitor.Visit(this, depth);
		for (var i = 0; i < this.children.length; i++) {
			this.children[i].VisitAll( visitor, depth + 1 );
		}
	};

	this.rootId = null; // for debugging
	this.GetId = function() {
		// console.log(this);
		if (this.rootId != null) {
			return this.rootId;
		}
		else if (this.parent != null) {
			var parentId = this.parent.GetId();
			if (parentId != null) {
				return parentId + "_" + this.parent.children.indexOf(this);
			}
		}
		else {
			return null;
		}
	}
}

var DialogBlockNode = function(doIndentFirstLine) {
	Object.assign( this, new TreeRelationship() );
	// Object.assign( this, new Runnable() );
	this.type = "dialog_block";

	this.Eval = function(environment, onReturn) {
		// console.log("EVAL BLOCK " + this.children.length);

		if (isPlayerEmbeddedInEditor && events != undefined && events != null) {
			events.Raise("script_node_enter", { id: this.GetId() });
		}

		var lastVal = null;
		var i = 0;

		function evalChildren(children, done) {
			if (i < children.length) {
				// console.log(">> CHILD " + i);
				children[i].Eval(environment, function(val) {
					// console.log("<< CHILD " + i);
					lastVal = val;
					i++;
					evalChildren(children,done);
				});
			}
			else {
				done();
			}
		};

		var self = this;
		evalChildren(this.children, function() {
			if (isPlayerEmbeddedInEditor && events != undefined && events != null) {
				events.Raise("script_node_exit", { id: self.GetId() });
			}

			onReturn(lastVal);
		});
	}

	if (doIndentFirstLine === undefined) {
		doIndentFirstLine = true; // This is just for serialization
	}

	this.Serialize = function(depth) {
		if (depth === undefined) {
			depth = 0;
		}

		var str = "";
		var lastNode = null;

		for (var i = 0; i < this.children.length; i++) {

			var curNode = this.children[i];

			var curNodeIsNonInlineCode = curNode.type === "code_block" && !isInlineCode(curNode);
			var prevNodeIsNonInlineCode = lastNode && lastNode.type === "code_block" && !isInlineCode(lastNode);

			var shouldIndentFirstLine = (i == 0 && doIndentFirstLine);
			var shouldIndentAfterLinebreak = (lastNode && lastNode.type === "function" && lastNode.name === "br");
			var shouldIndentCodeBlock = i > 0 && curNodeIsNonInlineCode;
			var shouldIndentAfterCodeBlock = prevNodeIsNonInlineCode;

			// need to insert a newline before the first block of non-inline code that isn't 
			// preceded by a {br}, since those will create their own newline
			if (i > 0 && curNodeIsNonInlineCode && !prevNodeIsNonInlineCode && !shouldIndentAfterLinebreak) {
				str += "\n";
			}

			if (shouldIndentFirstLine || shouldIndentAfterLinebreak || shouldIndentCodeBlock || shouldIndentAfterCodeBlock) {
				str += leadingWhitespace(depth);
			}

			str += curNode.Serialize(depth);

			if (i < this.children.length-1 && curNodeIsNonInlineCode) {
				str += "\n";
			}

			lastNode = curNode;
		}

		return str;
	}

	this.ToString = function() {
		return this.type + " " + this.GetId();
	};
}

var CodeBlockNode = function() {
	Object.assign( this, new TreeRelationship() );
	this.type = "code_block";

	this.Eval = function(environment, onReturn) {
		// console.log("EVAL BLOCK " + this.children.length);

		if (isPlayerEmbeddedInEditor && events != undefined && events != null) {
			events.Raise("script_node_enter", { id: this.GetId() });
		}

		var lastVal = null;
		var i = 0;

		function evalChildren(children, done) {
			if (i < children.length) {
				// console.log(">> CHILD " + i);
				children[i].Eval(environment, function(val) {
					// console.log("<< CHILD " + i);
					lastVal = val;
					i++;
					evalChildren(children,done);
				});
			}
			else {
				done();
			}
		};

		var self = this;
		evalChildren(this.children, function() {
			if (isPlayerEmbeddedInEditor && events != undefined && events != null) {
				events.Raise("script_node_exit", { id: self.GetId() });
			}

			onReturn(lastVal);
		});
	}

	this.Serialize = function(depth) {
		if(depth === undefined) {
			depth = 0;
		}

		// console.log("SERIALIZE BLOCK!!!");
		// console.log(depth);
		// console.log(doIndentFirstLine);

		var str = "{"; // todo: increase scope of Sym?

		// TODO : do code blocks ever have more than one child anymore????
		for (var i = 0; i < this.children.length; i++) {
			var curNode = this.children[i];
			str += curNode.Serialize(depth);
		}

		str += "}";

		return str;
	}

	this.ToString = function() {
		return this.type + " " + this.GetId();
	};
}

function isInlineCode(node) {
	return isTextEffectBlock(node) || isUndefinedBlock(node) || isMultilineListBlock(node);
}

function isUndefinedBlock(node) {
	return node.type === "code_block" && node.children.length > 0 && node.children[0].type === "undefined";
}

var textEffectBlockNames = ["clr1", "clr2", "clr3", "wvy", "shk", "rbw", "printSprite", "printItem", "printTile", "print", "say", "br"];
function isTextEffectBlock(node) {
	if (node.type === "code_block") {
		if (node.children.length > 0 && node.children[0].type === "function") {
			var func = node.children[0];
			return textEffectBlockNames.indexOf(func.name) != -1;
		}
	}
	return false;
}

var listBlockTypes = ["sequence", "cycle", "shuffle", "if"];
function isMultilineListBlock(node) {
	if (node.type === "code_block") {
		if (node.children.length > 0) {
			var child = node.children[0];
			return listBlockTypes.indexOf(child.type) != -1;
		}
	}
	return false;
}

// for round-tripping undefined code through the parser (useful for hacks!)
var UndefinedNode = function(sourceStr) {
	Object.assign(this, new TreeRelationship());
	this.type = "undefined";
	this.source = sourceStr;

	this.Eval = function(environment,onReturn) {
		addOrRemoveTextEffect(environment, "_debug_highlight");
		printFunc(environment, ["{" + sourceStr + "}"], function() {
			onReturn(null);
		});
		addOrRemoveTextEffect(environment, "_debug_highlight");
	}

	this.Serialize = function(depth) {
		return this.source;
	}

	this.ToString = function() {
		return "undefined" + " " + this.GetId();
	}
}

var FuncNode = function(name,args) {
	Object.assign( this, new TreeRelationship() );
	// Object.assign( this, new Runnable() );
	this.type = "function";
	this.name = name;
	this.args = args;

	this.Eval = function(environment,onReturn) {
		if (isPlayerEmbeddedInEditor && events != undefined && events != null) {
			events.Raise("script_node_enter", { id: this.GetId() });
		}

		var self = this; // hack to deal with scope (TODO : move up higher?)

		var argumentValues = [];
		var i = 0;

		function evalArgs(args, done) {
			// TODO : really hacky way to make we get the first
			// symbol's NAME instead of its variable value
			// if we are trying to do something with a property
			if (self.name === "property" && i === 0 && i < args.length) {
				if (args[i].type === "variable") {
					argumentValues.push(args[i].name);
					i++;
				}
				else {
					// first argument for a property MUST be a variable symbol
					// -- so skip everything if it's not!
					i = args.length;
				}
			}

			if (i < args.length) {
				// Evaluate each argument
				args[i].Eval(
					environment,
					function(val) {
						argumentValues.push(val);
						i++;
						evalArgs(args, done);
					});
			}
			else {
				done();
			}
		};

		evalArgs(
			this.args,
			function() {
				if (isPlayerEmbeddedInEditor && events != undefined && events != null) {
					events.Raise("script_node_exit", { id: self.GetId() });
				}

				environment.EvalFunction(self.name, argumentValues, onReturn);
			});
	}

	this.Serialize = function(depth) {
		var isDialogBlock = this.parent.type === "dialog_block";
		if (isDialogBlock && this.name === "print") {
			// TODO this could cause problems with "real" print functions
			return this.args[0].value; // first argument should be the text of the {print} func
		}
		else if (isDialogBlock && this.name === "br") {
			return "\n";
		}
		else {
			var str = "";
			str += this.name;
			for(var i = 0; i < this.args.length; i++) {
				str += " ";
				str += this.args[i].Serialize(depth);
			}
			return str;
		}
	}

	this.ToString = function() {
		return this.type + " " + this.name + " " + this.GetId();
	};
}

var LiteralNode = function(value) {
	Object.assign( this, new TreeRelationship() );
	// Object.assign( this, new Runnable() );
	this.type = "literal";
	this.value = value;

	this.Eval = function(environment,onReturn) {
		onReturn(this.value);
	}

	this.Serialize = function(depth) {
		var str = "";

		if (this.value === null) {
			return str;
		}

		if (typeof this.value === "string") {
			str += '"';
		}

		str += this.value;

		if (typeof this.value === "string") {
			str += '"';
		}

		return str;
	}

	this.ToString = function() {
		return this.type + " " + this.value + " " + this.GetId();
	};
}

var VarNode = function(name) {
	Object.assign( this, new TreeRelationship() );
	// Object.assign( this, new Runnable() );
	this.type = "variable";
	this.name = name;

	this.Eval = function(environment,onReturn) {
		// console.log("EVAL " + this.name + " " + environment.HasVariable(this.name) + " " + environment.GetVariable(this.name));
		if( environment.HasVariable(this.name) )
			onReturn( environment.GetVariable( this.name ) );
		else
			onReturn(null); // not a valid variable -- return null and hope that's ok
	} // TODO: might want to store nodes in the variableMap instead of values???

	this.Serialize = function(depth) {
		var str = "" + this.name;
		return str;
	}

	this.ToString = function() {
		return this.type + " " + this.name + " " + this.GetId();
	};
}

var ExpNode = function(operator, left, right) {
	Object.assign( this, new TreeRelationship() );
	this.type = "operator";
	this.operator = operator;
	this.left = left;
	this.right = right;

	this.Eval = function(environment,onReturn) {
		// console.log("EVAL " + this.operator);
		var self = this; // hack to deal with scope
		environment.EvalOperator( this.operator, this.left, this.right, 
			function(val){
				// console.log("EVAL EXP " + self.operator + " " + val);
				onReturn(val);
			} );
		// NOTE : sadly this pushes a lot of complexity down onto the actual operator methods
	}

	this.Serialize = function(depth) {
		var isNegativeNumber = this.operator === "-" && this.left.type === "literal" && this.left.value === null;

		if (!isNegativeNumber) {
			var str = "";

			if (this.left != undefined && this.left != null) {
				str += this.left.Serialize(depth) + " ";
			}

			str += this.operator;

			if (this.right != undefined && this.right != null) {
				str += " " + this.right.Serialize(depth);
			}

			return str;
		}
		else {
			return this.operator + this.right.Serialize(depth); // hacky but seems to work
		}
	}

	this.VisitAll = function(visitor, depth) {
		if (depth == undefined || depth == null) {
			depth = 0;
		}

		visitor.Visit( this, depth );
		if(this.left != null)
			this.left.VisitAll( visitor, depth + 1 );
		if(this.right != null)
			this.right.VisitAll( visitor, depth + 1 );
	};

	this.ToString = function() {
		return this.type + " " + this.operator + " " + this.GetId();
	};
}

var SequenceBase = function() {
	this.Serialize = function(depth) {
		var str = "";
		str += this.type + "\n";
		for (var i = 0; i < this.children.length; i++) {
			str += leadingWhitespace(depth + 1) + Sym.List + " ";
			str += this.children[i].Serialize(depth + 2);
			str += "\n";
		}
		str += leadingWhitespace(depth);
		return str;
	}

	this.VisitAll = function(visitor, depth) {
		if (depth == undefined || depth == null) {
			depth = 0;
		}

		visitor.Visit(this, depth);
		for (var i = 0; i < this.children.length; i++) {
			this.children[i].VisitAll( visitor, depth + 1 );
		}
	};

	this.ToString = function() {
		return this.type + " " + this.GetId();
	};
}

var SequenceNode = function(options) {
	Object.assign(this, new TreeRelationship());
	Object.assign(this, new SequenceBase());
	this.type = "sequence";
	this.AddChildren(options);

	var index = 0;
	this.Eval = function(environment, onReturn) {
		// console.log("SEQUENCE " + index);
		this.children[index].Eval(environment, onReturn);

		var next = index + 1;
		if (next < this.children.length) {
			index = next;
		}
	}
}

var CycleNode = function(options) {
	Object.assign(this, new TreeRelationship());
	Object.assign(this, new SequenceBase());
	this.type = "cycle";
	this.AddChildren(options);

	var index = 0;
	this.Eval = function(environment, onReturn) {
		// console.log("CYCLE " + index);
		this.children[index].Eval(environment, onReturn);

		var next = index + 1;
		if (next < this.children.length) {
			index = next;
		}
		else {
			index = 0;
		}
	}
}

var ShuffleNode = function(options) {
	Object.assign(this, new TreeRelationship());
	Object.assign(this, new SequenceBase());
	this.type = "shuffle";
	this.AddChildren(options);

	var optionsShuffled = [];
	function shuffle(options) {
		optionsShuffled = [];
		var optionsUnshuffled = options.slice();
		while (optionsUnshuffled.length > 0) {
			var i = Math.floor(Math.random() * optionsUnshuffled.length);
			optionsShuffled.push(optionsUnshuffled.splice(i,1)[0]);
		}
	}
	shuffle(this.children);

	var index = 0;
	this.Eval = function(environment, onReturn) {
		optionsShuffled[index].Eval(environment, onReturn);
		
		index++;
		if (index >= this.children.length) {
			shuffle(this.children);
			index = 0;
		}
	}
}

// TODO : rename? ConditionalNode?
var IfNode = function(conditions, results, isSingleLine) {
	Object.assign(this, new TreeRelationship());
	this.type = "if";

	for (var i = 0; i < conditions.length; i++) {
		this.AddChild(new ConditionPairNode(conditions[i], results[i]));
	}

	var self = this;
	this.Eval = function(environment, onReturn) {
		// console.log("EVAL IF");
		var i = 0;
		function TestCondition() {
			self.children[i].Eval(environment, function(result) {
				if (result.conditionValue == true) {
					onReturn(result.resultValue);
				}
				else if (i+1 < self.children.length) {
					i++;
					TestCondition();
				}
				else {
					onReturn(null);
				}
			});
		};
		TestCondition();
	}

	if (isSingleLine === undefined) {
		isSingleLine = false; // This is just for serialization
	}

	this.Serialize = function(depth) {
		var str = "";
		if(isSingleLine) {
			// HACKY - should I even keep this mode???
			str += this.children[0].children[0].Serialize() + " ? " + this.children[0].children[1].Serialize();
			if (this.children.length > 1 && this.children[1].children[0].type === Sym.Else) {
				str += " " + Sym.ElseExp + " " + this.children[1].children[1].Serialize();
			}
		}
		else {
			str += "\n";
			for (var i = 0; i < this.children.length; i++) {
				str += this.children[i].Serialize(depth);
			}
			str += leadingWhitespace(depth);
		}
		return str;
	}

	this.IsSingleLine = function() {
		return isSingleLine;
	}

	this.VisitAll = function(visitor, depth) {
		if (depth == undefined || depth == null) {
			depth = 0;
		}

		visitor.Visit(this, depth);

		for (var i = 0; i < this.children.length; i++) {
			this.children[i].VisitAll(visitor, depth + 1);
		}
	};

	this.ToString = function() {
		return this.type + " " + this.mode + " " + this.GetId();
	};
}

var ConditionPairNode = function(condition, result) {
	Object.assign(this, new TreeRelationship());

	this.type = "condition_pair";

	this.AddChild(condition);
	this.AddChild(result);

	var self = this;

	this.Eval = function(environment, onReturn) {
		self.children[0].Eval(environment, function(conditionSuccess) {
			if (conditionSuccess) {
				self.children[1].Eval(environment, function(resultValue) {
					onReturn({ conditionValue:true, resultValue:resultValue });
				});
			}
			else {
				onReturn({ conditionValue:false });
			}
		});
	}

	this.Serialize = function(depth) {
		var str = "";
		str += leadingWhitespace(depth + 1);
		str += Sym.List + " " + this.children[0].Serialize(depth) + " " + Sym.ConditionEnd + Sym.Linebreak;
		str += this.children[1].Serialize(depth + 2) + Sym.Linebreak;
		return str;
	}

	this.VisitAll = function(visitor, depth) {
		if (depth == undefined || depth == null) {
			depth = 0;
		}

		visitor.Visit(this, depth);

		for (var i = 0; i < this.children.length; i++) {
			this.children[i].VisitAll(visitor, depth + 1);
		}
	}

	this.ToString = function() {
		return this.type + " " + this.GetId();
	}
}

var ElseNode = function() {
	Object.assign( this, new TreeRelationship() );
	this.type = Sym.Else;

	this.Eval = function(environment, onReturn) {
		onReturn(true);
	}

	this.Serialize = function() {
		return Sym.Else;
	}

	this.ToString = function() {
		return this.type + " " + this.mode + " " + this.GetId();
	};
}

var Sym = {
	DialogOpen : '"""',
	DialogClose : '"""',
	CodeOpen : "{",
	CodeClose : "}",
	Linebreak : "\n", // just call it "break" ?
	Separator : ":",
	List : "-",
	String : '"',
	ConditionEnd : "?",
	Else : "else",
	ElseExp : ":", // special shorthand for expressions (deprecate?)
	Set : "=",
	Operators : ["==", ">=", "<=", ">", "<", "-", "+", "/", "*"], // operators need to be in reverse order of precedence
};

var Parser = function(env) {
	var environment = env;

	this.Parse = function(scriptStr, rootId) {
		var rootNode = new DialogBlockNode();
		rootNode.rootId = rootId;
		var state = new ParserState(rootNode, scriptStr);

		console.log(scriptStr);
		console.log(state.Source());

		if (state.MatchAhead(Sym.DialogOpen)) {
			// multi-line dialog block
			var dialogStr = state.ConsumeBlock(Sym.DialogOpen + Sym.Linebreak, Sym.Linebreak + Sym.DialogClose);
			rootNode = new DialogBlockNode();
			rootNode.rootId = rootId; // hacky!!
			state = new ParserState(rootNode, dialogStr);
			state = ParseDialog(state);
		}
		else {
			// single-line dialog block
			state = ParseDialog(state);
		}

		return state.rootNode;
	};

	var ParserState = function( rootNode, str ) {
		this.rootNode = rootNode;
		this.curNode = this.rootNode;

		var sourceStr = str;
		var i = 0;
		this.Index = function() { return i; };
		this.Count = function() { return sourceStr.length; };
		this.Done = function() { return i >= sourceStr.length; };
		this.Char = function() { return sourceStr[i]; };
		this.Step = function(n) { if(n===undefined) n=1; i += n; };
		this.MatchAhead = function(str) {
			// console.log(str);
			str = "" + str; // hack to turn single chars into strings
			// console.log(str);
			// console.log(str.length);
			for (var j = 0; j < str.length; j++) {
				if (i + j >= sourceStr.length) {
					return false;
				}
				else if (str[j] != sourceStr[i+j]) {
					return false;
				}
			}
			return true;
		}
		this.Peak = function(end) {
			var str = "";
			var j = i;
			// console.log(j);
			while (j < sourceStr.length && end.indexOf(sourceStr[j]) == -1) {
				str += sourceStr[j];
				j++;
			}
			// console.log("PEAK ::" + str + "::");
			return str;
		}
		this.ConsumeBlock = function(open, close, includeSymbols) {
			if (includeSymbols === undefined || includeSymbols === null) {
				includeSymbols = false;
			}

			var startIndex = i;

			var matchCount = 0;
			if (this.MatchAhead(open)) {
				matchCount++;
				this.Step(open.length);
			}

			while (matchCount > 0 && !this.Done()) {
				if (this.MatchAhead(close)) {
					matchCount--;
					this.Step( close.length );
				}
				else if (this.MatchAhead(open)) {
					matchCount++;
					this.Step(open.length);
				}
				else {
					this.Step();
				}
			}

			if (includeSymbols) {
				return sourceStr.slice(startIndex, i);
			}
			else {
				return sourceStr.slice(startIndex + open.length, i - close.length);
			}
		}

		this.Print = function() { console.log(sourceStr); };
		this.Source = function() { return sourceStr; };
	};

	/*
		ParseDialog():
		This function adds {print} nodes and linebreak {br} nodes to display text,
		interleaved with bracketed code nodes for functions and flow control,
		such as text effects {shk} {wvy} or sequences like {cycle} and {shuffle}.
		The parsing of those code blocks is handled by ParseCode.

		Note on parsing newline characters:
		- there should be an implicit linebreak {br} after each dialog line
		- a "dialog line" is defined as any line that either:
			- 1) contains dialog text (any text outside of a code block)
			- 2) is entirely empty (no text, no code)
			- *or* 3) contains a list block (sequence, cycle, shuffle, or conditional)
		- lines *only* containing {code} blocks are not dialog lines

		NOTE TO SELF: all the state I'm storing in here feels like
		evidence that the parsing system kind of broke down at this point :(
		Maybe it would feel better if I move into the "state" object
	*/
	function ParseDialog(state) {
		var curLineNodeList = [];
		var curText = "";
		var curLineIsEmpty = true;
		var curLineContainsDialogText = false;
		var prevLineIsDialogLine = false;

		var curLineIsDialogLine = function() {
			return curLineContainsDialogText || curLineIsEmpty;
		}

		var resetLineStateForNewLine = function() {
			prevLineIsDialogLine = curLineIsDialogLine();
			curLineContainsDialogText = false;
			curLineIsEmpty = true;
			curText = "";
			curLineNodeList = [];
		}

		var tryAddTextNodeToList = function() {
			if (curText.length > 0) {
				var printNode = new FuncNode("print", [new LiteralNode(curText)]);
				curLineNodeList.push(printNode);

				curText = "";
				curLineIsEmpty = false;
				curLineContainsDialogText = true;
			}
		}

		var addCodeNodeToList = function() {
			var codeSource = state.ConsumeBlock(Sym.CodeOpen, Sym.CodeClose);
			var codeState = new ParserState(new CodeBlockNode(), codeSource);
			codeState = ParseCode(codeState);
			var codeBlockNode = codeState.rootNode;
			curLineNodeList.push(codeBlockNode);

			curLineIsEmpty = false;

			// lists count as dialog text, because they can contain it
			if (isMultilineListBlock(codeBlockNode)) {
				curLineContainsDialogText = true;
			}
		}

		var tryAddLinebreakNodeToList = function() {
			if (prevLineIsDialogLine) {
				var linebreakNode = new FuncNode("br", []);
				curLineNodeList.unshift(linebreakNode);
			}
		}

		var addLineNodesToParent = function() {
			for (var i = 0; i < curLineNodeList.length; i++) {
				state.curNode.AddChild(curLineNodeList[i]);
			}
		}

		while (!state.Done()) {
			if (state.MatchAhead(Sym.CodeOpen)) { // process code block
				// add any buffered text to a print node, and parse the code
				tryAddTextNodeToList();
				addCodeNodeToList();
			}
			else if (state.MatchAhead(Sym.Linebreak)) { // process new line
				// add any buffered text to a print node, 
				// and add a linebreak if we are between two dialog lines
				tryAddTextNodeToList();
				tryAddLinebreakNodeToList();

				// since we've reached the end of a line
				// add stored nodes for this line to the parent node we are building,
				// and reset state for the next line
				addLineNodesToParent();
				resetLineStateForNewLine();

				state.Step();
			}
			else {
				// continue adding text to the current text buffer
				curText += state.Char();
				state.Step();
			}
		}

		// to make sure we don't leave anything behind:
		// add buffered text to a print node and add all nodes
		// to the current parent node
		tryAddTextNodeToList();
		tryAddLinebreakNodeToList();
		addLineNodesToParent();

		return state;
	}

	function ParseDialogBlock(state) {
		var dialogStr = state.ConsumeBlock( Sym.DialogOpen, Sym.DialogClose );

		var dialogState = new ParserState(new DialogBlockNode(), dialogStr);
		dialogState = ParseDialog( dialogState );

		state.curNode.AddChild( dialogState.rootNode );

		return state;
	}

	/*
		ParseConditional():
		A conditional contains a list of conditions that can be
		evaluated to true or false, followed by more dialog
		that will be evaluated if the condition is true. The first
		true condition is the one that gets evaluated.
	*/
	function ParseConditional(state) {
		var conditionStrings = [];
		var resultStrings = [];
		var curIndex = -1;
		var requiredLeadingWhitespace = -1;

		// TODO : very similar to sequence parsing - can we share anything?
		function parseConditionalItemLine(state) {
			var lineText = "";
			var whitespaceCount = 0;
			var isNewCondition = false;
			var encounteredNonWhitespace = false;
			var encounteredConditionEnd = false;

			while (!state.Done() && !(state.Char() === Sym.Linebreak)) {
				// count whitespace until we hit the first non-whitespace character
				if (!encounteredNonWhitespace) {
					if (state.Char() === " " || state.Char() === "\t") {
						whitespaceCount++;
					}
					else {
						encounteredNonWhitespace = true;

						if (state.Char() === Sym.List) {
							isNewCondition = true;
							whitespaceCount += 2; // count the list seperator AND the following extra space
						}
					}
				}

				// if this is the condition, we need to track whether we've
				// reached the end of the condition
				if (isNewCondition && !encounteredConditionEnd) {
					if (state.Char() === Sym.ConditionEnd) {
						encounteredConditionEnd = true;
					}
				}

				// add characters one at a time, unless it's a code block
				// since code blocks can contain additional sequences inside
				// them that will mess up our list item detection
				if (state.Char() === Sym.CodeOpen) {
					lineText += state.ConsumeBlock(Sym.CodeOpen, Sym.CodeClose, true /*includeSymbols*/);
				}
				else {
					if (!encounteredConditionEnd) { // skip all characters including & after the condition end
						lineText += state.Char();
					}
					state.Step();
				}
			}

			if (state.Char() === Sym.Linebreak) {
				state.Step();
			}

			return { text:lineText, whitespace:whitespaceCount, isNewCondition:isNewCondition };
		}

		// TODO : this is copied from sequence parsing; share?
		function trimLeadingWhitespace(text, trimLength) {
			var textSplit = text.split(Sym.linebreak);
			textSplit = textSplit.map(function(line) { return line.slice(trimLength) });
			return textSplit.join(Sym.linebreak);
		}

		while (!state.Done()) {
			var lineResults = parseConditionalItemLine(state);

			if (lineResults.isNewCondition) {
				requiredLeadingWhitespace = lineResults.whitespace;
				curIndex++;
				conditionStrings[curIndex] = "";
				resultStrings[curIndex] = "";
			}

			// to avoid extra newlines in nested conditionals, only count lines
			// that at least match the whitespace count of the initial line
			// NOTE: see the comment in sequence parsing for more details
			if (lineResults.whitespace >= requiredLeadingWhitespace) {
				var trimmedText = trimLeadingWhitespace(lineResults.text, requiredLeadingWhitespace);

				if (lineResults.isNewCondition) {
					conditionStrings[curIndex] += trimmedText;
				}
				else {
					resultStrings[curIndex] += trimmedText + Sym.Linebreak;
				}
			}
		}

		// hack: cut off the trailing newlines from all the result strings
		resultStrings = resultStrings.map(function(result) { return result.slice(0,-1); });

		var conditions = [];
		for (var i = 0; i < conditionStrings.length; i++) {
			var str = conditionStrings[i].trim();
			if (str === Sym.Else) {
				conditions.push(new ElseNode());
			}
			else {
				var exp = CreateExpression(str);
				conditions.push(exp);
			}
		}

		var results = [];
		for (var i = 0; i < resultStrings.length; i++) {
			var str = resultStrings[i];
			var dialogBlockState = new ParserState(new DialogBlockNode(), str);
			dialogBlockState = ParseDialog(dialogBlockState);
			var dialogBlock = dialogBlockState.rootNode;
			results.push(dialogBlock);
		}

		state.curNode.AddChild(new IfNode(conditions, results));

		return state;
	}

	function IsSequence(str) {
		// console.log("IsSequence? " + str);
		return str === "sequence" || str === "cycle" || str === "shuffle";
	}

	/*
		ParseSequence():
		Sequence nodes contain a list of dialog block nodes. The order those
		nodes are evaluated is determined by the type of sequence:
		- sequence: each child node evaluated once in order
		- cycle: repeats from the beginning after all nodes evaluate
		- shuffle: evaluate in a random order

		Each item in a sequence is sepearated by a "-" character.
		The seperator must come at the beginning of the line,
		but may be preceded by whitespace (in any amount).

		About whitespace: Whitespace at the start of a line
		is ignored if it less than or equal to the count of
		whitespace that preceded the list separator ("-") at
		the start of that item. (The count also includes the
		seperator and the extra space after the seperator.)
	 */
	function ParseSequence(state, sequenceType) {
		var itemStrings = [];
		var curItemIndex = -1; // -1 indicates not reading an item yet
		var requiredLeadingWhitespace = -1;

		function parseSequenceItemLine(state) {
			var lineText = "";
			var whitespaceCount = 0;
			var isNewListItem = false;
			var encounteredNonWhitespace = false;

			while (!state.Done() && !(state.Char() === Sym.Linebreak)) {
				// count whitespace until we hit the first non-whitespace character
				if (!encounteredNonWhitespace) {
					if (state.Char() === " " || state.Char() === "\t") {
						whitespaceCount++;
					}
					else {
						encounteredNonWhitespace = true;

						if (state.Char() === Sym.List) {
							isNewListItem = true;
							whitespaceCount += 2; // count the list seperator AND the following extra space
						}
					}
				}

				// add characters one at a time, unless it's a code block
				// since code blocks can contain additional sequences inside
				// them that will mess up our list item detection
				if (state.Char() === Sym.CodeOpen) {
					lineText += state.ConsumeBlock(Sym.CodeOpen, Sym.CodeClose, true /*includeSymbols*/);
				}
				else {
					lineText += state.Char();
					state.Step();
				}
			}

			if (state.Char() === Sym.Linebreak) {
				state.Step();
			}

			return { text:lineText, whitespace:whitespaceCount, isNewListItem:isNewListItem };
		}

		function trimLeadingWhitespace(text, trimLength) {
			// the split and join is necessary because a single "line"
			// can contain sequences that may contain newlines of their own
			// (we treat them all as one "line" for sequence parsing purposes)
			var textSplit = text.split(Sym.linebreak);
			textSplit = textSplit.map(function(line) { return line.slice(trimLength) });
			return textSplit.join(Sym.linebreak);
		}

		while (!state.Done()) {
			var lineResults = parseSequenceItemLine(state);

			if (lineResults.isNewListItem) {
				requiredLeadingWhitespace = lineResults.whitespace;
				curItemIndex++;
				itemStrings[curItemIndex] = "";
			}

			// to avoid double counting closing lines (empty ones ending in a curly brace)
			// we only allow lines that have at least as much whitespace as the start of the list item
			// TODO : I think right now this leads to a bug if the list item's indentation is less than
			// its parent code block... hopefully that won't be a big deal for now
			// (NOTE: I think the bug could be fixed by only applying this to the FINAL line of an item, but
			// that would require more consideration and testing)
			if (lineResults.whitespace >= requiredLeadingWhitespace) {
				var trimmedText = trimLeadingWhitespace(lineResults.text, requiredLeadingWhitespace);
				itemStrings[curItemIndex] += trimmedText + Sym.Linebreak;
			}
		}

		// a bit hacky: cut off the trailing newlines from all the items
		itemStrings = itemStrings.map(function(item) { return item.slice(0,-1); });

		var options = [];
		for (var i = 0; i < itemStrings.length; i++) {
			var str = itemStrings[i];
			var dialogBlockState = new ParserState(new DialogBlockNode(false /* doIndentFirstLine */), str);
			dialogBlockState = ParseDialog(dialogBlockState);
			var dialogBlock = dialogBlockState.rootNode;
			options.push(dialogBlock);
		}

		if (sequenceType === "sequence") {
			state.curNode.AddChild(new SequenceNode(options));
		}
		else if (sequenceType === "cycle") {
			state.curNode.AddChild(new CycleNode(options));
		}
		else if (sequenceType === "shuffle") {
			state.curNode.AddChild(new ShuffleNode(options));
		}

		return state;
	}

	function ParseFunction(state, funcName) {
		console.log("~~~ PARSE FUNCTION " + funcName);

		var args = [];

		var curSymbol = "";
		function OnSymbolEnd() {
			curSymbol = curSymbol.trim();
			// console.log("PARAMTER " + curSymbol);
			args.push( StringToValue(curSymbol) );
			// console.log(args);
			curSymbol = "";
		}

		while( !( state.Char() === "\n" || state.Done() ) ) {
			if( state.MatchAhead(Sym.CodeOpen) ) {
				var codeBlockState = new ParserState(new CodeBlockNode(), state.ConsumeBlock(Sym.CodeOpen, Sym.CodeClose));
				codeBlockState = ParseCode( codeBlockState );
				var codeBlock = codeBlockState.rootNode;
				args.push( codeBlock );
				curSymbol = "";
			}
			else if( state.MatchAhead(Sym.String) ) {
				/* STRING LITERAL */
				var str = state.ConsumeBlock(Sym.String, Sym.String);
				// console.log("STRING " + str);
				args.push( new LiteralNode(str) );
				curSymbol = "";
			}
			else if(state.Char() === " " && curSymbol.length > 0) {
				OnSymbolEnd();
			}
			else {
				curSymbol += state.Char();
			}
			state.Step();
		}

		if(curSymbol.length > 0) {
			OnSymbolEnd();
		}

		state.curNode.AddChild( new FuncNode( funcName, args ) );

		return state;
	}

	function IsValidVariableName(str) {
		var reg = /^[a-zA-Z_$][a-zA-Z_$0-9]*$/;
		var isValid = reg.test(str);
		// console.log("VALID variable??? " + isValid);
		return isValid;
	}

	function StringToValue(valStr) {
		if(valStr[0] === Sym.CodeOpen) {
			// CODE BLOCK!!!
			var codeStr = (new ParserState( null, valStr )).ConsumeBlock(Sym.CodeOpen, Sym.CodeClose); //hacky
			var codeBlockState = new ParserState(new CodeBlockNode(), codeStr);
			codeBlockState = ParseCode( codeBlockState );
			return codeBlockState.rootNode;
		}
		else if(valStr[0] === Sym.String) {
			// STRING!!
			// console.log("STRING");
			var str = "";
			var i = 1;
			while (i < valStr.length && valStr[i] != Sym.String) {
				str += valStr[i];
				i++;
			}
			// console.log(str);
			return new LiteralNode( str );
		}
		else if(valStr === "true") {
			// BOOL
			return new LiteralNode( true );
		}
		else if(valStr === "false") {
			// BOOL
			return new LiteralNode( false );
		}
		else if( !isNaN(parseFloat(valStr)) ) {
			// NUMBER!!
			// console.log("NUMBER!!! " + valStr);
			return new LiteralNode( parseFloat(valStr) );
		}
		else if(IsValidVariableName(valStr)) {
			// VARIABLE!!
			// console.log("VARIABLE");
			return new VarNode(valStr); // TODO : check for valid potential variables
		}
		else {
			// uh oh
			return new LiteralNode(null);
		}
	}

	function CreateExpression(expStr) {
		expStr = expStr.trim();

		function IsInsideString(index) {
			var inString = false;
			for(var i = 0; i < expStr.length; i++) {
				if(expStr[i] === Sym.String)
					inString = !inString;

				if(index === i)
					return inString;
			}
			return false;
		}

		function IsInsideCode(index) {
			var count = 0;
			for(var i = 0; i < expStr.length; i++) {
				if(expStr[i] === Sym.CodeOpen)
					count++;
				else if(expStr[i] === Sym.CodeClose)
					count--;

				if(index === i)
					return count > 0;
			}
			return false;
		}

		var operator = null;

		// set is special because other operator can look like it, and it has to go first in the order of operations
		var setIndex = expStr.indexOf(Sym.Set);
		if( setIndex > -1 && !IsInsideString(setIndex) && !IsInsideCode(setIndex) ) { // it might be a set operator
			if( expStr[setIndex+1] != "=" && expStr[setIndex-1] != ">" && expStr[setIndex-1] != "<" ) {
				// ok it actually IS a set operator and not ==, >=, or <=
				operator = Sym.Set;
				var variableName = expStr.substring(0,setIndex).trim(); // TODO : valid variable name testing
				var left = IsValidVariableName(variableName) ? new VarNode( variableName ) : new LiteralNode(null);
				var right = CreateExpression( expStr.substring(setIndex+Sym.Set.length) );
				var exp = new ExpNode( operator, left, right );
				return exp;
			}
		}

		// special if "expression" for single-line if statements
		var ifIndex = expStr.indexOf(Sym.ConditionEnd);
		if( ifIndex > -1 && !IsInsideString(ifIndex) && !IsInsideCode(ifIndex) ) {
			operator = Sym.ConditionEnd;
			var conditionStr = expStr.substring(0,ifIndex).trim();
			var conditions = [ CreateExpression(conditionStr) ];

			var resultStr = expStr.substring(ifIndex+Sym.ConditionEnd.length);
			var results = [];
			function AddResult(str) {
				var dialogBlockState = new ParserState(new DialogBlockNode(), str);
				dialogBlockState = ParseDialog( dialogBlockState );
				var dialogBlock = dialogBlockState.rootNode;
				results.push( dialogBlock );
			}

			var elseIndex = resultStr.indexOf(Sym.ElseExp); // does this need to test for strings?
			if(elseIndex > -1) {
				conditions.push( new ElseNode() );

				var elseStr = resultStr.substring(elseIndex+Sym.ElseExp.length);
				var resultStr = resultStr.substring(0,elseIndex);

				AddResult( resultStr.trim() );
				AddResult( elseStr.trim() );
			}
			else {
				AddResult( resultStr.trim() );
			}

			return new IfNode( conditions, results, true /*isSingleLine*/ );
		}

		for( var i = 0; (operator == null) && (i < Sym.Operators.length); i++ ) {
			var opSym = Sym.Operators[i];
			var opIndex = expStr.indexOf( opSym );
			if( opIndex > -1 && !IsInsideString(opIndex) && !IsInsideCode(opIndex) ) {
				operator = opSym;
				var left = CreateExpression( expStr.substring(0,opIndex) );
				var right = CreateExpression( expStr.substring(opIndex+opSym.length) );
				var exp = new ExpNode( operator, left, right );
				return exp;
			}
		}

		if( operator == null ) {
			return StringToValue(expStr);
		}
	}
	this.CreateExpression = CreateExpression;

	function IsWhitespace(str) {
		return ( str === " " || str === "\t" || str === "\n" );
	}

	function IsExpression(str) {
		var tempState = new ParserState(null, str); // hacky
		var textOutsideCodeBlocks = "";

		while (!tempState.Done()) {
			if (tempState.MatchAhead(Sym.CodeOpen)) {
				tempState.ConsumeBlock(Sym.CodeOpen, Sym.CodeClose);
			}
			else {
				textOutsideCodeBlocks += tempState.Char();
				tempState.Step();
			}
		}

		var containsAnyExpressionOperators = (textOutsideCodeBlocks.indexOf(Sym.ConditionEnd) != -1) ||
				(textOutsideCodeBlocks.indexOf(Sym.Set) != -1) ||
				(Sym.Operators.some(function(opSym) { return textOutsideCodeBlocks.indexOf(opSym) != -1; }));

		return containsAnyExpressionOperators;
	}

	function IsLiteral(str) {
		var isBool = str === "true" || str === "false";
		var isNum = !isNaN(parseFloat(str));
		var isStr = str[0] === '"' && str[str.length-1] === '"';
		var isVar = IsValidVariableName(str);
		var isEmpty = str.length === 0;
		return isBool || isNum || isStr || isVar || isEmpty;
	}

	function ParseExpression(state) {
		var line = state.Source(); // state.Peak( [Sym.Linebreak] ); // TODO : remove the linebreak thing
		// console.log("EXPRESSION " + line);
		var exp = CreateExpression(line);
		// console.log(exp);
		state.curNode.AddChild(exp);
		state.Step(line.length);
		return state;
	}

	function IsConditionalBlock(state) {
		var peakToFirstListSymbol = state.Peak([Sym.List]);

		var foundListSymbol = peakToFirstListSymbol < state.Source().length;

		var areAllCharsBeforeListWhitespace = true;
		for (var i = 0; i < peakToFirstListSymbol.length; i++) {
			if (!IsWhitespace(peakToFirstListSymbol[i])) {
				areAllCharsBeforeListWhitespace = false;
			}
		}

		var peakToFirstConditionSymbol = state.Peak([Sym.ConditionEnd]);
		peakToFirstConditionSymbol = peakToFirstConditionSymbol.slice(peakToFirstListSymbol.length);
		var hasNoLinebreakBetweenListAndConditionEnd = peakToFirstConditionSymbol.indexOf(Sym.Linebreak) == -1;

		return foundListSymbol && 
			areAllCharsBeforeListWhitespace && 
			hasNoLinebreakBetweenListAndConditionEnd;
	}

	function ParseCode(state) {
		if (IsConditionalBlock(state)) {
			state = ParseConditional(state);
		}
		else if (environment.HasFunction(state.Peak([" "]))) { // TODO --- what about newlines???
			var funcName = state.Peak([" "]);
			state.Step(funcName.length);
			state = ParseFunction(state, funcName);
		}
		else if (IsSequence(state.Peak([" ", Sym.Linebreak]))) {
			var sequenceType = state.Peak([" ", Sym.Linebreak]);
			state.Step(sequenceType.length);
			state = ParseSequence(state, sequenceType);
		}
		else if (IsLiteral(state.Source()) || IsExpression(state.Source())) {
			state = ParseExpression(state);
		}
		else {
			var undefinedSrc = state.Peak([]);
			var undefinedNode = new UndefinedNode(undefinedSrc);
			state.curNode.AddChild(undefinedNode);
		}

		// just go to the end now
		while (!state.Done()) {
			state.Step();
		}

		return state;
	}

	function ParseCodeBlock(state) {
		var codeStr = state.ConsumeBlock( Sym.CodeOpen, Sym.CodeClose );
		var codeState = new ParserState(new CodeBlockNode(), codeStr);
		codeState = ParseCode( codeState );
		state.curNode.AddChild( codeState.rootNode );
		return state;
	}

}

} // Script()
</script>

<script>
function Dialog() {

this.CreateRenderer = function() {
	return new DialogRenderer();
};

this.CreateBuffer = function() {
	return new DialogBuffer();
};

var DialogRenderer = function() {

	// TODO : refactor this eventually? remove everything from struct.. avoid the defaults?
	var textboxInfo = {
		img : null,
		width : 104,
		height : 8+4+2+5, //8 for text, 4 for top-bottom padding, 2 for line padding, 5 for arrow
		top : 12,
		left : 12,
		bottom : 12, //for drawing it from the bottom
		font_scale : 0.5, // we draw font at half-size compared to everything else
		padding_vert : 2,
		padding_horz : 4,
		arrow_height : 5,
	};

	var font = null;
	this.SetFont = function(f) {
		font = f;
		textboxInfo.height = (textboxInfo.padding_vert * 3) + (relativeFontHeight() * 2) + textboxInfo.arrow_height;
		textboxInfo.img = context.createImageData(textboxInfo.width*scale, textboxInfo.height*scale);
	}

	function textScale() {
		return scale * textboxInfo.font_scale;
	}

	function relativeFontWidth() {
		return Math.ceil( font.getWidth() * textboxInfo.font_scale );
	}

	function relativeFontHeight() {
		return Math.ceil( font.getHeight() * textboxInfo.font_scale );
	}

	var context = null;
	this.AttachContext = function(c) {
		context = c;
	};

	this.ClearTextbox = function() {
		if(context == null) return;

		//create new image none exists
		if(textboxInfo.img == null)
			textboxInfo.img = context.createImageData(textboxInfo.width*scale, textboxInfo.height*scale);

		// fill text box with black
		for (var i=0;i<textboxInfo.img.data.length;i+=4)
		{
			textboxInfo.img.data[i+0]=0;
			textboxInfo.img.data[i+1]=0;
			textboxInfo.img.data[i+2]=0;
			textboxInfo.img.data[i+3]=255;
		}
	};

	var isCentered = false;
	this.SetCentered = function(centered) {
		isCentered = centered;
	};

	this.DrawTextbox = function() {
		if(context == null) return;
		if (isCentered) {
			context.putImageData(textboxInfo.img, textboxInfo.left*scale, ((height/2)-(textboxInfo.height/2))*scale);
		}
		else if (player().y < mapsize/2) {
			//bottom
			context.putImageData(textboxInfo.img, textboxInfo.left*scale, (height-textboxInfo.bottom-textboxInfo.height)*scale);
		}
		else {
			//top
			context.putImageData(textboxInfo.img, textboxInfo.left*scale, textboxInfo.top*scale);
		}
	};

	var arrowdata = [
		1,1,1,1,1,
		0,1,1,1,0,
		0,0,1,0,0
	];
	this.DrawNextArrow = function() {
		// console.log("draw arrow!");
		var top = (textboxInfo.height-5) * scale;
		var left = (textboxInfo.width-(5+4)) * scale;
		if (textDirection === TextDirection.RightToLeft) { // RTL hack
			left = 4 * scale;
		}

		for (var y = 0; y < 3; y++) {
			for (var x = 0; x < 5; x++) {
				var i = (y * 5) + x;
				if (arrowdata[i] == 1) {
					//scaling nonsense
					for (var sy = 0; sy < scale; sy++) {
						for (var sx = 0; sx < scale; sx++) {
							var pxl = 4 * ( ((top+(y*scale)+sy) * (textboxInfo.width*scale)) + (left+(x*scale)+sx) );
							textboxInfo.img.data[pxl+0] = 255;
							textboxInfo.img.data[pxl+1] = 255;
							textboxInfo.img.data[pxl+2] = 255;
							textboxInfo.img.data[pxl+3] = 255;
						}
					}
				}
			}
		}
	};

	var text_scale = 2; //using a different scaling factor for text feels like cheating... but it looks better
	this.DrawChar = function(char, row, col, leftPos) {
		char.offset = {
			x: char.base_offset.x,
			y: char.base_offset.y
		}; // compute render offset *every* frame

		char.SetPosition(row,col);
		char.ApplyEffects(effectTime);

		var charData = char.bitmap;

		var top = (4 * scale) + (row * 2 * scale) + (row * font.getHeight() * text_scale) + Math.floor( char.offset.y );
		var left = (4 * scale) + (leftPos * text_scale) + Math.floor( char.offset.x );

		var debug_r = Math.random() * 255;

		for (var y = 0; y < char.height; y++) {
			for (var x = 0; x < char.width; x++) {

				var i = (y * char.width) + x;
				if ( charData[i] == 1 ) {

					//scaling nonsense
					for (var sy = 0; sy < text_scale; sy++) {
						for (var sx = 0; sx < text_scale; sx++) {
							var pxl = 4 * ( ((top+(y*text_scale)+sy) * (textboxInfo.width*scale)) + (left+(x*text_scale)+sx) );
							textboxInfo.img.data[pxl+0] = char.color.r;
							textboxInfo.img.data[pxl+1] = char.color.g;
							textboxInfo.img.data[pxl+2] = char.color.b;
							textboxInfo.img.data[pxl+3] = char.color.a;
						}
					}
				}
				// else {
				// 	// DEBUG

				// 	//scaling nonsense
				// 	for (var sy = 0; sy < text_scale; sy++) {
				// 		for (var sx = 0; sx < text_scale; sx++) {
				// 			var pxl = 4 * ( ((top+(y*text_scale)+sy) * (textboxInfo.width*scale)) + (left+(x*text_scale)+sx) );
				// 			textboxInfo.img.data[pxl+0] = debug_r;
				// 			textboxInfo.img.data[pxl+1] = 0;
				// 			textboxInfo.img.data[pxl+2] = 0;
				// 			textboxInfo.img.data[pxl+3] = 255;
				// 		}
				// 	}
				// }

			}
		}
		
		// call printHandler for character
		char.OnPrint();
	};

	var effectTime = 0; // TODO this variable should live somewhere better
	this.Draw = function(buffer, dt) {
		effectTime += dt;

		this.ClearTextbox();

		buffer.ForEachActiveChar(this.DrawChar);

		if (buffer.CanContinue()) {
			this.DrawNextArrow();
		}

		this.DrawTextbox();

		if (buffer.DidPageFinishThisFrame() && onPageFinish != null) {
			onPageFinish();
		}
	};

	/* this is a hook for GIF rendering */
	var onPageFinish = null;
	this.SetPageFinishHandler = function(handler) {
		onPageFinish = handler;
	};

	this.Reset = function() {
		effectTime = 0;
		// TODO - anything else?
	}

	// this.CharsPerRow = function() {
	// 	return textboxInfo.charsPerRow;
	// }
}


var DialogBuffer = function() {
	var buffer = [[[]]]; // holds dialog in an array buffer
	var pageIndex = 0;
	var rowIndex = 0;
	var charIndex = 0;
	var nextCharTimer = 0;
	var nextCharMaxTime = 50; // in milliseconds
	var isDialogReadyToContinue = false;
	var activeTextEffects = [];
	var font = null;
	var arabicHandler = new ArabicHandler();
	var onDialogEndCallbacks = [];

	this.SetFont = function(f) {
		font = f;
	}

	this.CurPage = function() { return buffer[ pageIndex ]; };
	this.CurRow = function() { return this.CurPage()[ rowIndex ]; };
	this.CurChar = function() { return this.CurRow()[ charIndex ]; };
	this.CurPageCount = function() { return buffer.length; };
	this.CurRowCount = function() { return this.CurPage().length; };
	this.CurCharCount = function() { return this.CurRow().length; };

	this.ForEachActiveChar = function(handler) { // Iterates over visible characters on the active page
		var rowCount = rowIndex + 1;
		for (var i = 0; i < rowCount; i++) {
			var row = this.CurPage()[i];
			var charCount = (i == rowIndex) ? charIndex+1 : row.length;
			// console.log(charCount);

			var leftPos = 0;
			if (textDirection === TextDirection.RightToLeft) {
				leftPos = 24 * 8; // hack -- I think this is correct?
			}

			for(var j = 0; j < charCount; j++) {
				var char = row[j];
				if(char) {
					if (textDirection === TextDirection.RightToLeft) {
						leftPos -= char.spacing;
					}
					// console.log(j + " " + leftPos);

					// handler( char, i /*rowIndex*/, j /*colIndex*/ );
					handler(char, i /*rowIndex*/, j /*colIndex*/, leftPos)

					if (textDirection === TextDirection.LeftToRight) {
						leftPos += char.spacing;
					}
				}
			}
		}
	}

	this.Reset = function() {
		buffer = [[[]]];
		pageIndex = 0;
		rowIndex = 0;
		charIndex = 0;
		isDialogReadyToContinue = false;

		afterManualPagebreak = false;

		activeTextEffects = [];

		onDialogEndCallbacks = [];

		isActive = false;
	};

	this.DoNextChar = function() {
		nextCharTimer = 0; //reset timer

		//time to update characters
		if (charIndex + 1 < this.CurCharCount()) {
			//add char to current row
			charIndex++;
		}
		else if (rowIndex + 1 < this.CurRowCount()) {
			//start next row
			rowIndex++;
			charIndex = 0;
		}
		else {
			//the page is full!
			isDialogReadyToContinue = true;
			didPageFinishThisFrame = true;
		}

		if (this.CurChar() != null) {
			if (this.CurChar().isPageBreak) {
				// special case for page break marker character!
				isDialogReadyToContinue = true;
				didPageFinishThisFrame = true;
			}
			
			this.CurChar().OnPrint(); // make sure we hit the callback before we run out of text
		}
	};

	this.Update = function(dt) {
		didPageFinishThisFrame = false;
		didFlipPageThisFrame = false;
		// this.Draw(dt); // TODO move into a renderer object
		if (isDialogReadyToContinue) {
			return; //waiting for dialog to be advanced by player
		}

		nextCharTimer += dt; //tick timer

		if (nextCharTimer > nextCharMaxTime) {
			this.DoNextChar();
		}
	};

	this.Skip = function() {
		console.log("SKIPPP");
		didPageFinishThisFrame = false;
		didFlipPageThisFrame = false;
		// add new characters until you get to the end of the current line of dialog
		while (rowIndex < this.CurRowCount()) {
			this.DoNextChar();

			if(isDialogReadyToContinue) {
				//make sure to push the rowIndex past the end to break out of the loop
				rowIndex++;
				charIndex = 0;
			}
		}
		rowIndex = this.CurRowCount()-1;
		charIndex = this.CurCharCount()-1;
	};

	this.FlipPage = function() {
		didFlipPageThisFrame = true;
		isDialogReadyToContinue = false;
		pageIndex++;
		rowIndex = 0;
		charIndex = 0;
	}

	this.EndDialog = function() {
		isActive = false; // no more text to show... this should be a sign to stop rendering dialog

		for (var i = 0; i < onDialogEndCallbacks.length; i++) {
			onDialogEndCallbacks[i]();
		}
	}

	var afterManualPagebreak = false; // is it bad to track this state like this?

	this.Continue = function() {
		console.log("CONTINUE");

		// if we used a page break character to continue we need
		// to run whatever is in the script afterwards! // TODO : make this comment better
		if (this.CurChar().isPageBreak) {
			// hacky: always treat a page break as the end of dialog
			// if there's more dialog later we re-activate the dialog buffer
			this.EndDialog();
			afterManualPagebreak = true;
			this.CurChar().OnContinue();
			return false;
		}
		if (pageIndex + 1 < this.CurPageCount()) {
			console.log("FLIP PAGE!");
			//start next page
			this.FlipPage();
			return true; /* hasMoreDialog */
		}
		else {
			console.log("END DIALOG!");
			//end dialog mode
			this.EndDialog();
			return false; /* hasMoreDialog */
		}
	};

	var isActive = false;
	this.IsActive = function() { return isActive; };

	this.OnDialogEnd = function(callback) {
		if (!isActive) {
			callback();
		}
		else {
			onDialogEndCallbacks.push(callback);
		}
	}

	this.CanContinue = function() { return isDialogReadyToContinue; };

	function DialogChar(effectList) {
		this.effectList = effectList.slice(); // clone effect list (since it can change between chars)

		this.color = { r:255, g:255, b:255, a:255 };
		this.offset = { x:0, y:0 }; // in pixels (screen pixels?)

		this.col = 0;
		this.row = 0;

		this.SetPosition = function(row,col) {
			// console.log("SET POS");
			// console.log(this);
			this.row = row;
			this.col = col;
		}

		this.ApplyEffects = function(time) {
			// console.log("APPLY EFFECTS! " + time);
			for(var i = 0; i < this.effectList.length; i++) {
				var effectName = this.effectList[i];
				// console.log("FX " + effectName);
				TextEffects[ effectName ].DoEffect( this, time );
			}
		}

		var printHandler = null; // optional function to be called once on printing character
		this.SetPrintHandler = function(handler) {
			printHandler = handler;
		}
		this.OnPrint = function() {
			if (printHandler != null) {
				// console.log("PRINT HANDLER ---- DIALOG BUFFER");
				printHandler();
				printHandler = null; // only call handler once (hacky)
			}
		}

		this.bitmap = [];
		this.width = 0;
		this.height = 0;
		this.base_offset = { // hacky name
 			x: 0,
			y: 0
		};
		this.spacing = 0;
	}

	function DialogFontChar(font, char, effectList) {
		Object.assign(this, new DialogChar(effectList));

		var charData = font.getChar(char);
		this.bitmap = charData.data;
		this.width = charData.width;
		this.height = charData.height;
		this.base_offset.x = charData.offset.x;
		this.base_offset.y = charData.offset.y;
		this.spacing = charData.spacing;
	}

	function DialogDrawingChar(drawingId, effectList) {
		Object.assign(this, new DialogChar(effectList));

		var imageData = renderer.GetImageSource(drawingId)[0];
		var imageDataFlat = [];
		for (var i = 0; i < imageData.length; i++) {
			// console.log(imageData[i]);
			imageDataFlat = imageDataFlat.concat(imageData[i]);
		}

		this.bitmap = imageDataFlat;
		this.width = 8;
		this.height = 8;
		this.spacing = 8;
	}

	function DialogScriptControlChar() {
		Object.assign(this, new DialogChar([]));

		this.width = 0;
		this.height = 0;
		this.spacing = 0;
	}

	// is a control character really the best way to handle page breaks?
	function DialogPageBreakChar() {
		Object.assign(this, new DialogChar([]));

		this.width = 0;
		this.height = 0;
		this.spacing = 0;

		this.isPageBreak = true;

		var continueHandler = null;

		this.SetContinueHandler = function(handler) {
			continueHandler = handler;
		}

		this.OnContinue = function() {
			if (continueHandler) {
				continueHandler();
			}
		}
	}

	function AddWordToCharArray(charArray,word,effectList) {
		for(var i = 0; i < word.length; i++) {
			charArray.push( new DialogFontChar( font, word[i], effectList ) );
		}
		return charArray;
	}

	function GetCharArrayWidth(charArray) {
		var width = 0;
		for(var i = 0; i < charArray.length; i++) {
			width += charArray[i].spacing;
		}
		return width;
	}

	function GetStringWidth(str) {
		var width = 0;
		for (var i = 0; i < str.length; i++) {
			var charData = font.getChar(str[i]);
			width += charData.spacing;
		}
		return width;
	}

	var pixelsPerRow = 192; // hard-coded fun times!!!

	this.AddScriptReturn = function(onReturnHandler) {
		var curPageIndex = buffer.length - 1;
		var curRowIndex = buffer[curPageIndex].length - 1;
		var curRowArr = buffer[curPageIndex][curRowIndex];

		var controlChar = new DialogScriptControlChar();
		controlChar.SetPrintHandler(onReturnHandler);

		curRowArr.push(controlChar);

		isActive = true;
	}

	this.AddDrawing = function(drawingId) {
		// console.log("DRAWING ID " + drawingId);

		var curPageIndex = buffer.length - 1;
		var curRowIndex = buffer[curPageIndex].length - 1;
		var curRowArr = buffer[curPageIndex][curRowIndex];

		var drawingChar = new DialogDrawingChar(drawingId, activeTextEffects);

		var rowLength = GetCharArrayWidth(curRowArr);

		// TODO : clean up copy-pasted code here :/
		if (afterManualPagebreak) {
			this.FlipPage(); // hacky

			buffer[curPageIndex][curRowIndex] = curRowArr;
			buffer.push([]);
			curPageIndex++;
			buffer[curPageIndex].push([]);
			curRowIndex = 0;
			curRowArr = buffer[curPageIndex][curRowIndex];
			curRowArr.push(drawingChar);

			afterManualPagebreak = false;
		}
		else if (rowLength + drawingChar.spacing  <= pixelsPerRow || rowLength <= 0) {
			//stay on same row
			curRowArr.push(drawingChar);
		}
		else if (curRowIndex == 0) {
			//start next row
			buffer[curPageIndex][curRowIndex] = curRowArr;
			buffer[curPageIndex].push([]);
			curRowIndex++;
			curRowArr = buffer[curPageIndex][curRowIndex];
			curRowArr.push(drawingChar);
		}
		else {
			//start next page
			buffer[curPageIndex][curRowIndex] = curRowArr;
			buffer.push([]);
			curPageIndex++;
			buffer[curPageIndex].push([]);
			curRowIndex = 0;
			curRowArr = buffer[curPageIndex][curRowIndex];
			curRowArr.push(drawingChar);
		}

		isActive = true; // this feels like a bad way to do this???
	}

	// TODO : convert this into something that takes DialogChar arrays
	this.AddText = function(textStr) {
		console.log("ADD TEXT " + textStr);

		//process dialog so it's easier to display
		var words = textStr.split(" ");

		// var curPageIndex = this.CurPageCount() - 1;
		// var curRowIndex = this.CurRowCount() - 1;
		// var curRowArr = this.CurRow();

		var curPageIndex = buffer.length - 1;
		var curRowIndex = buffer[curPageIndex].length - 1;
		var curRowArr = buffer[curPageIndex][curRowIndex];

		for (var i = 0; i < words.length; i++) {
			var word = words[i];
			if (arabicHandler.ContainsArabicCharacters(word)) {
				word = arabicHandler.ShapeArabicCharacters(word);
			}

			var wordWithPrecedingSpace = ((i == 0) ? "" : " ") + word;
			var wordLength = GetStringWidth(wordWithPrecedingSpace);

			var rowLength = GetCharArrayWidth(curRowArr);

			if (afterManualPagebreak) {
				this.FlipPage();

				// hacky copied bit for page breaks
				buffer[curPageIndex][curRowIndex] = curRowArr;
				buffer.push([]);
				curPageIndex++;
				buffer[curPageIndex].push([]);
				curRowIndex = 0;
				curRowArr = buffer[curPageIndex][curRowIndex];
				curRowArr = AddWordToCharArray(curRowArr, word, activeTextEffects);

				afterManualPagebreak = false;
			}
			else if (rowLength + wordLength <= pixelsPerRow || rowLength <= 0) {
				//stay on same row
				curRowArr = AddWordToCharArray(curRowArr, wordWithPrecedingSpace, activeTextEffects);
			}
			else if (curRowIndex == 0) {
				//start next row
				buffer[curPageIndex][curRowIndex] = curRowArr;
				buffer[curPageIndex].push([]);
				curRowIndex++;
				curRowArr = buffer[curPageIndex][curRowIndex];
				curRowArr = AddWordToCharArray(curRowArr, word, activeTextEffects);
			}
			else {
				//start next page
				buffer[curPageIndex][curRowIndex] = curRowArr;
				buffer.push([]);
				curPageIndex++;
				buffer[curPageIndex].push([]);
				curRowIndex = 0;
				curRowArr = buffer[curPageIndex][curRowIndex];
				curRowArr = AddWordToCharArray(curRowArr, word, activeTextEffects);
			}
		}

		//destroy any empty stuff
		var lastPage = buffer[buffer.length-1];
		var lastRow = lastPage[lastPage.length-1];
		if (lastRow.length == 0) {
			lastPage.splice(lastPage.length-1, 1);
		}
		if (lastPage.length == 0) {
			buffer.splice(buffer.length-1, 1);
		}

		//finish up 
		lastPage = buffer[buffer.length-1];
		lastRow = lastPage[lastPage.length-1];
		if (lastRow.length > 0) {
			var lastChar = lastRow[lastRow.length-1];
		}

		// console.log(buffer);

		isActive = true;
	};

	this.AddLinebreak = function() {
		var lastPage = buffer[buffer.length-1];
		if (lastPage.length <= 1) {
			// console.log("LINEBREAK - NEW ROW ");
			// add new row
			lastPage.push([]);
		}
		else {
			// add new page
			buffer.push([[]]);
		}
		// console.log(buffer);

		isActive = true;
	}

	this.AddPagebreak = function(onReturnHandler) {
		var curPageIndex = buffer.length - 1;
		var curRowIndex = buffer[curPageIndex].length - 1;
		var curRowArr = buffer[curPageIndex][curRowIndex];

		// need to actually create a whole new page if following another pagebreak character
		if (this.CurChar() && this.CurChar().isPageBreak) {
			buffer.push([]);
			curPageIndex++;
			buffer[curPageIndex].push([]);
			curRowIndex = 0;
			curRowArr = buffer[curPageIndex][curRowIndex];
		}

		var pagebreakChar = new DialogPageBreakChar();
		pagebreakChar.SetContinueHandler(onReturnHandler);

		curRowArr.push(pagebreakChar);

		isActive = true;		
	}

	/* new text effects */
	this.HasTextEffect = function(name) {
		return activeTextEffects.indexOf( name ) > -1;
	}
	this.AddTextEffect = function(name) {
		activeTextEffects.push( name );
	}
	this.RemoveTextEffect = function(name) {
		activeTextEffects.splice( activeTextEffects.indexOf( name ), 1 );
	}

	/* this is a hook for GIF rendering */
	var didPageFinishThisFrame = false;
	this.DidPageFinishThisFrame = function(){ return didPageFinishThisFrame; };

	var didFlipPageThisFrame = false;
	this.DidFlipPageThisFrame = function(){ return didFlipPageThisFrame; };

	// this.SetCharsPerRow = function(num){ charsPerRow = num; }; // hacky
};

/* ARABIC */
var ArabicHandler = function() {

	var arabicCharStart = 0x0621;
	var arabicCharEnd = 0x064E;

	var CharacterForm = {
		Isolated : 0,
		Final : 1,
		Initial : 2,
		Middle : 3
	};

	// map glyphs to their character forms
	var glyphForms = {
		/*		 Isolated, Final, Initial, Middle Forms	*/
		0x0621: [0xFE80,0xFE80,0xFE80,0xFE80], /*  HAMZA  */ 
		0x0622: [0xFE81,0xFE82,0xFE81,0xFE82], /*  ALEF WITH MADDA ABOVE  */ 
		0x0623: [0xFE83,0xFE84,0xFE83,0xFE84], /*  ALEF WITH HAMZA ABOVE  */ 
		0x0624: [0xFE85,0xFE86,0xFE85,0xFE86], /*  WAW WITH HAMZA ABOVE  */ 
		0x0625: [0xFE87,0xFE88,0xFE87,0xFE88], /*  ALEF WITH HAMZA BELOW  */ 
		0x0626: [0xFE89,0xFE8A,0xFE8B,0xFE8C], /*  YEH WITH HAMZA ABOVE  */ 
		0x0627: [0xFE8D,0xFE8E,0xFE8D,0xFE8E], /*  ALEF  */ 
		0x0628: [0xFE8F,0xFE90,0xFE91,0xFE92], /*  BEH  */ 
		0x0629: [0xFE93,0xFE94,0xFE93,0xFE94], /*  TEH MARBUTA  */ 
		0x062A: [0xFE95,0xFE96,0xFE97,0xFE98], /*  TEH  */ 
		0x062B: [0xFE99,0xFE9A,0xFE9B,0xFE9C], /*  THEH  */ 
		0x062C: [0xFE9D,0xFE9E,0xFE9F,0xFEA0], /*  JEEM  */ 
		0x062D: [0xFEA1,0xFEA2,0xFEA3,0xFEA4], /*  HAH  */ 
		0x062E: [0xFEA5,0xFEA6,0xFEA7,0xFEA8], /*  KHAH  */ 
		0x062F: [0xFEA9,0xFEAA,0xFEA9,0xFEAA], /*  DAL  */ 
		0x0630: [0xFEAB,0xFEAC,0xFEAB,0xFEAC], /*  THAL */ 
		0x0631: [0xFEAD,0xFEAE,0xFEAD,0xFEAE], /*  RAA  */ 
		0x0632: [0xFEAF,0xFEB0,0xFEAF,0xFEB0], /*  ZAIN  */ 
		0x0633: [0xFEB1,0xFEB2,0xFEB3,0xFEB4], /*  SEEN  */ 
		0x0634: [0xFEB5,0xFEB6,0xFEB7,0xFEB8], /*  SHEEN  */ 
		0x0635: [0xFEB9,0xFEBA,0xFEBB,0xFEBC], /*  SAD  */ 
		0x0636: [0xFEBD,0xFEBE,0xFEBF,0xFEC0], /*  DAD  */ 
		0x0637: [0xFEC1,0xFEC2,0xFEC3,0xFEC4], /*  TAH  */ 
		0x0638: [0xFEC5,0xFEC6,0xFEC7,0xFEC8], /*  ZAH  */ 
		0x0639: [0xFEC9,0xFECA,0xFECB,0xFECC], /*  AIN  */ 
		0x063A: [0xFECD,0xFECE,0xFECF,0xFED0], /*  GHAIN  */ 
		0x063B: [0x0000,0x0000,0x0000,0x0000], /*  space */
		0x063C: [0x0000,0x0000,0x0000,0x0000], /*  space */
		0x063D: [0x0000,0x0000,0x0000,0x0000], /*  space */
		0x063E: [0x0000,0x0000,0x0000,0x0000], /*  space */
		0x063F: [0x0000,0x0000,0x0000,0x0000], /*  space */
		0x0640: [0x0640,0x0640,0x0640,0x0640], /*  TATWEEL  */ 
		0x0641: [0xFED1,0xFED2,0xFED3,0xFED4], /*  FAA  */ 
		0x0642: [0xFED5,0xFED6,0xFED7,0xFED8], /*  QAF  */ 
		0x0643: [0xFED9,0xFEDA,0xFEDB,0xFEDC], /*  KAF  */ 
		0x0644: [0xFEDD,0xFEDE,0xFEDF,0xFEE0], /*  LAM  */ 
		0x0645: [0xFEE1,0xFEE2,0xFEE3,0xFEE4], /*  MEEM  */ 
		0x0646: [0xFEE5,0xFEE6,0xFEE7,0xFEE8], /*  NOON  */ 
		0x0647: [0xFEE9,0xFEEA,0xFEEB,0xFEEC], /*  HEH  */ 
		0x0648: [0xFEED,0xFEEE,0xFEED,0xFEEE], /*  WAW  */ 
		0x0649: [0xFEEF,0xFEF0,0xFBE8,0xFBE9], /*  ALEF MAKSURA  */ 
		0x064A: [0xFEF1,0xFEF2,0xFEF3,0xFEF4], /*  YEH  */ 
		0x064B: [0xFEF5,0xFEF6,0xFEF5,0xFEF6], /*  LAM ALEF MADD*/
		0x064C: [0xFEF7,0xFEF8,0xFEF7,0xFEF8], /*  LAM ALEF HAMZA ABOVE*/
		0x064D: [0xFEF9,0xFEFa,0xFEF9,0xFEFa], /*  LAM ALEF HAMZA BELOW*/
		0x064E: [0xFEFb,0xFEFc,0xFEFb,0xFEFc], /*  LAM ALEF */
	};

	var disconnectedCharacters = [0x0621,0x0622,0x0623,0x0624,0x0625,0x0627,0x062f,0x0630,0x0631,0x0632,0x0648,0x0649,0x064b,0x064c,0x064d,0x064e];

	function IsArabicCharacter(char) {
		var code = char.charCodeAt(0);
		return (code >= arabicCharStart && code <= arabicCharEnd);
	}

	function ContainsArabicCharacters(word) {
		for (var i = 0; i < word.length; i++) {
			if (IsArabicCharacter(word[i])) {
				return true;
			}
		}
		return false;
	}

	function IsDisconnectedCharacter(char) {
		var code = char.charCodeAt(0);
		return disconnectedCharacters.indexOf(code) != -1;
	}

	function ShapeArabicCharacters(word) {
		var shapedWord = "";

		for (var i = 0; i < word.length; i++) {
			if (!IsArabicCharacter(word[i])) {
				shapedWord += word[i];
				continue;
			}

			var connectedToPreviousChar = i-1 >= 0 && IsArabicCharacter(word[i-1]) && !IsDisconnectedCharacter(word[i-1]);

			var connectedToNextChar = i+1 < word.length && IsArabicCharacter(word[i+1]) && !IsDisconnectedCharacter(word[i]);

			var form;
			if (!connectedToPreviousChar && !connectedToNextChar) {
				form = CharacterForm.Isolated;
			}
			else if (connectedToPreviousChar && !connectedToNextChar) {
				form = CharacterForm.Final;
			}
			else if (!connectedToPreviousChar && connectedToNextChar) {
				form = CharacterForm.Initial;
			}
			else if (connectedToPreviousChar && connectedToNextChar) {
				form = CharacterForm.Middle;
			}

			var code = word[i].charCodeAt(0);

			// handle lam alef special case
			if (code == 0x0644 && connectedToNextChar) {
				var nextCode = word[i+1].charCodeAt(0);
				var specialCode = null;
				if (nextCode == 0x0622) {
					// alef madd
					specialCode = glyphForms[0x064b][form];
				}
				else if (nextCode == 0x0623) {
					// hamza above
					specialCode = glyphForms[0x064c][form];
				}
				else if (nextCode == 0x0625) {
					// hamza below
					specialCode = glyphForms[0x064d][form];
				}
				else if (nextCode == 0x0627) {
					// alef
					specialCode = glyphForms[0x064e][form];
				}

				if (specialCode != null) {
					shapedWord += String.fromCharCode(specialCode);
					i++; // skip a step
					continue;
				}
			}

			// hacky?
			if (form === CharacterForm.Isolated) {
				shapedWord += word[i];
				continue;
			}

			var shapedCode = glyphForms[code][form];
			shapedWord += String.fromCharCode(shapedCode);
		}

		return shapedWord;
	}

	this.ContainsArabicCharacters = ContainsArabicCharacters;
	this.ShapeArabicCharacters = ShapeArabicCharacters;
}

/* NEW TEXT EFFECTS */
var TextEffects = new Map();

var RainbowEffect = function() { // TODO - should it be an object or just a method?
	this.DoEffect = function(char,time) {
		// console.log("RAINBOW!!!");
		// console.log(char);
		// console.log(char.color);
		// console.log(char.col);

		var h = Math.abs( Math.sin( (time / 600) - (char.col / 8) ) );
		var rgb = hslToRgb( h, 1, 0.5 );
		char.color.r = rgb[0];
		char.color.g = rgb[1];
		char.color.b = rgb[2];
		char.color.a = 255;
	}
};
TextEffects["rbw"] = new RainbowEffect();

var ColorEffect = function(index) {
	this.DoEffect = function(char) {
		var pal = getPal( curPal() );
		var color = pal[ parseInt( index ) ];
		// console.log(color);
		char.color.r = color[0];
		char.color.g = color[1];
		char.color.b = color[2];
		char.color.a = 255;
	}
};
TextEffects["clr1"] = new ColorEffect(0);
TextEffects["clr2"] = new ColorEffect(1); // TODO : should I use parameters instead of special names?
TextEffects["clr3"] = new ColorEffect(2);

var WavyEffect = function() {
	this.DoEffect = function(char,time) {
		char.offset.y += Math.sin( (time / 250) - (char.col / 2) ) * 4;
	}
};
TextEffects["wvy"] = new WavyEffect();

var ShakyEffect = function() {
	function disturb(func,time,offset,mult1,mult2) {
		return func( (time * mult1) - (offset * mult2) );
	}

	this.DoEffect = function(char,time) {
		char.offset.y += 3
						* disturb(Math.sin,time,char.col,0.1,0.5)
						* disturb(Math.cos,time,char.col,0.3,0.2)
						* disturb(Math.sin,time,char.row,2.0,1.0);
		char.offset.x += 3
						* disturb(Math.cos,time,char.row,0.1,1.0)
						* disturb(Math.sin,time,char.col,3.0,0.7)
						* disturb(Math.cos,time,char.col,0.2,0.3);
	}
};
TextEffects["shk"] = new ShakyEffect();

var DebugHighlightEffect = function() {
	this.DoEffect = function(char) {
		char.color.r = 255;
		char.color.g = 255;
		char.color.b = 0;
		char.color.a = 255;
	}
}
TextEffects["_debug_highlight"] = new DebugHighlightEffect();

} // Dialog()
</script>

<script>
/*
TODO
- reset renderer function
- react to changes in: drawings, palettes
- possible future plan: limit size of cache (remove old images)
- change image store path from (pal > col > draw) to (draw > pal > col)
- get rid of old getSpriteImage (etc) methods
- get editor working again [in progress]
- move debug timer class into core (seems useful)
*/

function Renderer(tilesize, scale) {

console.log("!!!!! NEW RENDERER");

var imageStore = { // TODO : rename to imageCache
	source: {},
	render: {}
};

var palettes = null; // TODO : need null checks?
var context = null;

function setPalettes(paletteObj) {
	palettes = paletteObj;

	// TODO : should this really clear out the render cache?
	imageStore.render = {};
}

function getPaletteColor(paletteId, colorIndex) {
	if (palettes[paletteId] === undefined) {
		paletteId = "default";
	}

	var palette = palettes[paletteId];

	if (colorIndex > palette.colors.length) { // do I need this failure case? (seems un-reliable)
		colorIndex = 0;
	}

	var color = palette.colors[colorIndex];

	return {
		r : color[0],
		g : color[1],
		b : color[2]
	};
}

var debugRenderCount = 0;

// TODO : change image store path from (pal > col > draw) to (draw > pal > col)
function renderImage(drawing, paletteId) {
	// debugRenderCount++;
	// console.log("RENDER COUNT " + debugRenderCount);

	var col = drawing.col;
	var colStr = "" + col;
	var pal = paletteId;
	var drwId = drawing.drw;
	var imgSrc = imageStore.source[ drawing.drw ];

	// initialize render cache entry
	if (imageStore.render[drwId] === undefined || imageStore.render[drwId] === null) {
		imageStore.render[drwId] = {};
	}

	if (imageStore.render[drwId][pal] === undefined || imageStore.render[drwId][pal] === null) {
		imageStore.render[drwId][pal] = {};
	}

	// create array of ImageData frames
	imageStore.render[drwId][pal][colStr] = [];

	for (var i = 0; i < imgSrc.length; i++) {
		var frameSrc = imgSrc[i];
		var frameData = imageDataFromImageSource( frameSrc, pal, col );
		imageStore.render[drwId][pal][colStr].push(frameData);
	}
}

function imageDataFromImageSource(imageSource, pal, col) {
	//console.log(imageSource);

	var img = context.createImageData(tilesize*scale,tilesize*scale);

	var backgroundColor = getPaletteColor(pal,0);
	var foregroundColor = getPaletteColor(pal,col);

	for (var y = 0; y < tilesize; y++) {
		for (var x = 0; x < tilesize; x++) {
			var px = imageSource[y][x];
			for (var sy = 0; sy < scale; sy++) {
				for (var sx = 0; sx < scale; sx++) {
					var pxl = (((y * scale) + sy) * tilesize * scale * 4) + (((x*scale) + sx) * 4);
					if ( px === 1 ) {
						img.data[pxl + 0] = foregroundColor.r;
						img.data[pxl + 1] = foregroundColor.g;
						img.data[pxl + 2] = foregroundColor.b;
						img.data[pxl + 3] = 255;
					}
					else { //ch === 0
						img.data[pxl + 0] = backgroundColor.r;
						img.data[pxl + 1] = backgroundColor.g;
						img.data[pxl + 2] = backgroundColor.b;
						img.data[pxl + 3] = 255;
					}
				}
			}
		}
	}

	// convert to canvas: chrome has poor performance when working directly with image data
	var imageCanvas = document.createElement("canvas");
	imageCanvas.width = img.width;
	imageCanvas.height = img.height;
	var imageContext = imageCanvas.getContext("2d");
	imageContext.putImageData(img,0,0);

	return imageCanvas;
}

// TODO : move into core
function undefinedOrNull(x) {
	return x === undefined || x === null;
}

function isImageRendered(drawing, paletteId) {
	var col = drawing.col;
	var colStr = "" + col;
	var pal = paletteId;
	var drwId = drawing.drw;

	if (undefinedOrNull(imageStore.render[drwId]) ||
		undefinedOrNull(imageStore.render[drwId][pal]) ||
		undefinedOrNull(imageStore.render[drwId][pal][colStr])) {
			return false;
	}
	else {
		return true;
	}
}

function getImageSet(drawing, paletteId) {
	return imageStore.render[drawing.drw][paletteId][drawing.col];
}

function getImageFrame(drawing, paletteId, frameOverride) {
	var frameIndex = 0;
	if (drawing.animation.isAnimated) {
		if (frameOverride != undefined && frameOverride != null) {
			frameIndex = frameOverride;
		}
		else {
			frameIndex = drawing.animation.frameIndex;
		}
	}

	return getImageSet(drawing, paletteId)[frameIndex];
}

function getOrRenderImage(drawing, paletteId, frameOverride) {
	if (!isImageRendered(drawing, paletteId)) {
		renderImage(drawing, paletteId);
	}

	return getImageFrame(drawing, paletteId, frameOverride);
}

/* PUBLIC INTERFACE */
this.GetImage = getOrRenderImage;

this.SetPalettes = setPalettes;

this.SetImageSource = function(drawingId, imageSourceData) {
	imageStore.source[drawingId] = imageSourceData;
	imageStore.render[drawingId] = {}; // reset render cache for this image
}

this.GetImageSource = function(drawingId) {
	return imageStore.source[drawingId];
}

this.GetFrameCount = function(drawingId) {
	return imageStore.source[drawingId].length;
}

this.AttachContext = function(ctx) {
	context = ctx;
}

} // Renderer()
</script>

<script>
var xhr; // TODO : remove
var canvas;
var context; // TODO : remove if safe?
var ctx;

var room = {};
var tile = {};
var sprite = {};
var item = {};
var dialog = {};
var palette = { //start off with a default palette
		"default" : {
			name : "default",
			colors : [[0,0,0],[255,255,255],[255,255,255]]
		}
	};
var variable = {}; // these are starting variable values -- they don't update (or I don't think they will)
var playerId = "A";

var titleDialogId = "title";
function getTitle() {
	return dialog[titleDialogId].src;
}
function setTitle(titleSrc) {
	dialog[titleDialogId] = { src:titleSrc, name:null };
}

var defaultFontName = "ascii_small";
var fontName = defaultFontName;
var TextDirection = {
	LeftToRight : "LTR",
	RightToLeft : "RTL"
};
var textDirection = TextDirection.LeftToRight;

var names = {
	room : new Map(),
	tile : new Map(), // Note: Not currently enabled in the UI
	sprite : new Map(),
	item : new Map(),
	dialog : new Map(),
};
function updateNamesFromCurData() {

	function createNameMap(objectStore) {
		var map = new Map();
		for (id in objectStore) {
			if (objectStore[id].name != undefined && objectStore[id].name != null) {
				map.set(objectStore[id].name, id);
			}
		}
		return map;
	}

	names.room = createNameMap(room);
	names.tile = createNameMap(tile);
	names.sprite = createNameMap(sprite);
	names.item = createNameMap(item);
	names.dialog = createNameMap(dialog);
}

var spriteStartLocations = {};

/* VERSION */
var version = {
	major: 7, // major changes
	minor: 2, // smaller changes
	devBuildPhase: "RELEASE",
};
function getEngineVersion() {
	return version.major + "." + version.minor;
}

/* FLAGS */
var flags;
function resetFlags() {
	flags = {
		ROOM_FORMAT : 0 // 0 = non-comma separated, 1 = comma separated
	};
}
resetFlags(); //init flags on load script

// SUPER hacky location... :/
var editorDevFlags = {
	// NONE right now!
};

function clearGameData() {
	room = {};
	tile = {};
	sprite = {};
	item = {};
	dialog = {};
	palette = { //start off with a default palette
		"default" : {
			name : "default",
			colors : [[0,0,0],[255,255,255],[255,255,255]]
		}
	};
	isEnding = false; //todo - correct place for this?
	variable = {};

	// TODO RENDERER : clear data?

	spriteStartLocations = {};

	// hacky to have this multiple times...
	names = {
		room : new Map(),
		tile : new Map(),
		sprite : new Map(),
		item : new Map(),
		dialog : new Map(),
	};

	fontName = defaultFontName; // TODO : reset font manager too?
	textDirection = TextDirection.LeftToRight;
}

var width = 128;
var height = 128;
var scale = 4; //this is stupid but necessary
var tilesize = 8;
var mapsize = 16;

var curRoom = "0";

var key = {
	left : 37,
	right : 39,
	up : 38,
	down : 40,
	space : 32,
	enter : 13,
	w : 87,
	a : 65,
	s : 83,
	d : 68,
	r : 82,
	shift : 16,
	ctrl : 17,
	alt : 18,
	cmd : 224
};

var prevTime = 0;
var deltaTime = 0;

//inventory update UI handles
var onInventoryChanged = null;
var onVariableChanged = null;
var onGameReset = null;

var isPlayerEmbeddedInEditor = false;

var renderer = new Renderer(tilesize, scale);

function getGameNameFromURL() {
	var game = window.location.hash.substring(1);
	// console.log("game name --- " + game);
	return game;
}

function attachCanvas(c) {
	canvas = c;
	canvas.width = width * scale;
	canvas.height = width * scale;
	ctx = canvas.getContext("2d");
	dialogRenderer.AttachContext(ctx);
	renderer.AttachContext(ctx);
}

var curGameData = null;
function load_game(game_data, startWithTitle) {
	curGameData = game_data; //remember the current game (used to reset the game)

	dialogBuffer.Reset();
	scriptInterpreter.ResetEnvironment(); // ensures variables are reset -- is this the best way?

	parseWorld(game_data);

	if (!isPlayerEmbeddedInEditor) {
		// hack to ensure default font is available
		fontManager.AddResource(defaultFontName + fontManager.GetExtension(), document.getElementById(defaultFontName).text.slice(1));
	}

	var font = fontManager.Get( fontName );
	dialogBuffer.SetFont(font);
	dialogRenderer.SetFont(font);

	setInitialVariables();

	// setInterval(updateLoadingScreen, 300); // hack test

	onready(startWithTitle);
}

function reset_cur_game() {
	if (curGameData == null) {
		return; //can't reset if we don't have the game data
	}

	stopGame();
	clearGameData();
	load_game(curGameData);

	if (isPlayerEmbeddedInEditor && onGameReset != null) {
		onGameReset();
	}
}

var update_interval = null;
function onready(startWithTitle) {
	if(startWithTitle === undefined || startWithTitle === null) startWithTitle = true;

	clearInterval(loading_interval);

	input = new InputManager();

	document.addEventListener('keydown', input.onkeydown);
	document.addEventListener('keyup', input.onkeyup);

	if (isPlayerEmbeddedInEditor) {
		canvas.addEventListener('touchstart', input.ontouchstart, {passive:false});
		canvas.addEventListener('touchmove', input.ontouchmove, {passive:false});
		canvas.addEventListener('touchend', input.ontouchend, {passive:false});
	}
	else {
		// creates a 'touchTrigger' element that covers the entire screen and can universally have touch event listeners added w/o issue.

		// we're checking for existing touchTriggers both at game start and end, so it's slightly redundant.
	  	var existingTouchTrigger = document.querySelector('#touchTrigger');
	  	if (existingTouchTrigger === null){
	  	  var touchTrigger = document.createElement("div");
	  	  touchTrigger.setAttribute("id","touchTrigger");

	  	  // afaik css in js is necessary here to force a fullscreen element
	  	  touchTrigger.setAttribute(
	  	    "style","position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden;"
	  	  );
	  	  //document.body.appendChild(touchTrigger);
	  	  document.getElementById("container").appendChild(touchTrigger);

	  	  touchTrigger.addEventListener('touchstart', input.ontouchstart);
	  	  touchTrigger.addEventListener('touchmove', input.ontouchmove);
	  	  touchTrigger.addEventListener('touchend', input.ontouchend);
	  	}
	}

	window.onblur = input.onblur;

	update_interval = setInterval(update,16);

	if(startWithTitle) { // used by editor 
		startNarrating(getTitle());
	}
}

function setInitialVariables() {
	for(id in variable) {
		var value = variable[id]; // default to string
		if(value === "true") {
			value = true;
		}
		else if(value === "false") {
			value = false;
		}
		else if(!isNaN(parseFloat(value))) {
			value = parseFloat(value);
		}
		scriptInterpreter.SetVariable(id,value);
	}
	scriptInterpreter.SetOnVariableChangeHandler( onVariableChanged );
}

function getOffset(evt) {
	var offset = { x:0, y:0 };

	var el = evt.target;
	var rect = el.getBoundingClientRect();

	offset.x += rect.left + el.scrollLeft;
	offset.y += rect.top + el.scrollTop;

	offset.x = evt.clientX - offset.x;
	offset.y = evt.clientY - offset.y;

	return offset;
}

function stopGame() {
	console.log("stop GAME!");

	document.removeEventListener('keydown', input.onkeydown);
	document.removeEventListener('keyup', input.onkeyup);

	if (isPlayerEmbeddedInEditor) {
		canvas.removeEventListener('touchstart', input.ontouchstart);
		canvas.removeEventListener('touchmove', input.ontouchmove);
		canvas.removeEventListener('touchend', input.ontouchend);
	}
	else {
		//check for touchTrigger and removes it

    		var existingTouchTrigger = document.querySelector('#touchTrigger');
    		if (existingTouchTrigger !== null){
    			existingTouchTrigger.removeEventListener('touchstart', input.ontouchstart);
    			existingTouchTrigger.removeEventListener('touchmove', input.ontouchmove);
    			existingTouchTrigger.removeEventListener('touchend', input.ontouchend);

    			existingTouchTrigger.parentElement.removeChild(existingTouchTrigger);
    		}
	}

	window.onblur = null;

	clearInterval(update_interval);
}

/* loading animation */
var loading_anim_data = [
	[
		0,1,1,1,1,1,1,0,
		0,0,1,1,1,1,0,0,
		0,0,1,1,1,1,0,0,
		0,0,0,1,1,0,0,0,
		0,0,0,1,1,0,0,0,
		0,0,1,0,0,1,0,0,
		0,0,1,0,0,1,0,0,
		0,1,1,1,1,1,1,0,
	],
	[
		0,1,1,1,1,1,1,0,
		0,0,1,0,0,1,0,0,
		0,0,1,1,1,1,0,0,
		0,0,0,1,1,0,0,0,
		0,0,0,1,1,0,0,0,
		0,0,1,0,0,1,0,0,
		0,0,1,1,1,1,0,0,
		0,1,1,1,1,1,1,0,
	],
	[
		0,1,1,1,1,1,1,0,
		0,0,1,0,0,1,0,0,
		0,0,1,0,0,1,0,0,
		0,0,0,1,1,0,0,0,
		0,0,0,1,1,0,0,0,
		0,0,1,1,1,1,0,0,
		0,0,1,1,1,1,0,0,
		0,1,1,1,1,1,1,0,
	],
	[
		0,1,1,1,1,1,1,0,
		0,0,1,0,0,1,0,0,
		0,0,1,0,0,1,0,0,
		0,0,0,1,1,0,0,0,
		0,0,0,1,1,0,0,0,
		0,0,1,1,1,1,0,0,
		0,0,1,1,1,1,0,0,
		0,1,1,1,1,1,1,0,
	],
	[
		0,0,0,0,0,0,0,0,
		1,0,0,0,0,0,0,1,
		1,1,1,0,0,1,1,1,
		1,1,1,1,1,0,0,1,
		1,1,1,1,1,0,0,1,
		1,1,1,0,0,1,1,1,
		1,0,0,0,0,0,0,1,
		0,0,0,0,0,0,0,0,
	]
];
var loading_anim_frame = 0;
var loading_anim_speed = 500;
var loading_interval = null;

function loadingAnimation() {
	//create image
	var loadingAnimImg = ctx.createImageData(8*scale, 8*scale);
	//draw image
	for (var y = 0; y < 8; y++) {
		for (var x = 0; x < 8; x++) {
			var i = (y * 8) + x;
			if (loading_anim_data[loading_anim_frame][i] == 1) {
				//scaling nonsense
				for (var sy = 0; sy < scale; sy++) {
					for (var sx = 0; sx < scale; sx++) {
						var pxl = 4 * ( (((y*scale)+sy) * (8*scale)) + ((x*scale)+sx) );
						loadingAnimImg.data[pxl+0] = 255;
						loadingAnimImg.data[pxl+1] = 255;
						loadingAnimImg.data[pxl+2] = 255;
						loadingAnimImg.data[pxl+3] = 255;
					}
				}
			}
		}
	}
	//put image on canvas
	ctx.putImageData(loadingAnimImg,scale*(width/2 - 4),scale*(height/2 - 4));
	//update frame
	loading_anim_frame++;
	if (loading_anim_frame >= 5) loading_anim_frame = 0;
}

function updateLoadingScreen() {
	// TODO : in progress
	ctx.fillStyle = "rgb(0,0,0)";
	ctx.fillRect(0,0,canvas.width,canvas.height);

	loadingAnimation();
	drawSprite( getSpriteImage(sprite["a"],"0",0), 8, 8, ctx );
}

function update() {
	var curTime = Date.now();
	deltaTime = curTime - prevTime;

	if (curRoom == null) {
		// in the special case where there is no valid room, end the game
		startNarrating( "", true /*isEnding*/ );
	}

	if (!transition.IsTransitionActive()) {
		updateInput();
	}

	if (transition.IsTransitionActive()) {
		// transition animation takes over everything!
		transition.UpdateTransition(deltaTime);
	}
	else {
		if (!isNarrating && !isEnding) {
			updateAnimation();
			drawRoom( room[curRoom] ); // draw world if game has begun
		}
		else {
			//make sure to still clear screen
			ctx.fillStyle = "rgb(" + getPal(curPal())[0][0] + "," + getPal(curPal())[0][1] + "," + getPal(curPal())[0][2] + ")";
			ctx.fillRect(0,0,canvas.width,canvas.height);
		}

		// if (isDialogMode) { // dialog mode
		if(dialogBuffer.IsActive()) {
			dialogRenderer.Draw( dialogBuffer, deltaTime );
			dialogBuffer.Update( deltaTime );
		}

		// keep moving avatar if player holds down button
		if( !dialogBuffer.IsActive() && !isEnding )
		{
			if( curPlayerDirection != Direction.None ) {
				playerHoldToMoveTimer -= deltaTime;

				if( playerHoldToMoveTimer <= 0 )
				{
					movePlayer( curPlayerDirection );
					playerHoldToMoveTimer = 150;
				}
			}
		}
	}

	prevTime = curTime;

	input.resetKeyPressed();
	input.resetTapReleased();
}

function updateInput() {
	if( dialogBuffer.IsActive() ) {
		if (input.anyKeyPressed() || input.isTapReleased()) {
			/* CONTINUE DIALOG */
			if (dialogBuffer.CanContinue()) {
				var hasMoreDialog = dialogBuffer.Continue();
				if(!hasMoreDialog) {
					// ignore currently held keys UNTIL they are released (stops player from insta-moving)
					input.ignoreHeldKeys();
				}
			}
			else {
				dialogBuffer.Skip();
			}
		}
	}
	else if ( isEnding ) {
		if (input.anyKeyPressed() || input.isTapReleased()) {
			/* RESTART GAME */
			reset_cur_game();
		}
	}
	else {
		/* WALK */
		var prevPlayerDirection = curPlayerDirection;

		if ( input.isKeyDown( key.left ) || input.isKeyDown( key.a ) || input.swipeLeft() ) {
			curPlayerDirection = Direction.Left;
		}
		else if ( input.isKeyDown( key.right ) || input.isKeyDown( key.d ) || input.swipeRight() ) {
			curPlayerDirection = Direction.Right;
		}
		else if ( input.isKeyDown( key.up ) || input.isKeyDown( key.w ) || input.swipeUp() ) {
			curPlayerDirection = Direction.Up;
		}
		else if ( input.isKeyDown( key.down ) || input.isKeyDown( key.s ) || input.swipeDown() ) {
			curPlayerDirection = Direction.Down;
		}
		else {
			curPlayerDirection = Direction.None;
		}

		if (curPlayerDirection != Direction.None && curPlayerDirection != prevPlayerDirection) {
			movePlayer( curPlayerDirection );
			playerHoldToMoveTimer = 500;
		}
	}
}

var animationCounter = 0;
var animationTime = 400;
function updateAnimation() {
	animationCounter += deltaTime;

	if ( animationCounter >= animationTime ) {

		// animate sprites
		for (id in sprite) {
			var spr = sprite[id];
			if (spr.animation.isAnimated) {
				spr.animation.frameIndex = ( spr.animation.frameIndex + 1 ) % spr.animation.frameCount;
			}
		}

		// animate tiles
		for (id in tile) {
			var til = tile[id];
			if (til.animation.isAnimated) {
				til.animation.frameIndex = ( til.animation.frameIndex + 1 ) % til.animation.frameCount;
			}
		}

		// animate items
		for (id in item) {
			var itm = item[id];
			if (itm.animation.isAnimated) {
				itm.animation.frameIndex = ( itm.animation.frameIndex + 1 ) % itm.animation.frameCount;
			}
		}

		// reset counter
		animationCounter = 0;

	}
}

function resetAllAnimations() {
	for (id in sprite) {
		var spr = sprite[id];
		if (spr.animation.isAnimated) {
			spr.animation.frameIndex = 0;
		}
	}

	for (id in tile) {
		var til = tile[id];
		if (til.animation.isAnimated) {
			til.animation.frameIndex = 0;
		}
	}

	for (id in item) {
		var itm = item[id];
		if (itm.animation.isAnimated) {
			itm.animation.frameIndex = 0;
		}
	}
}

function getSpriteAt(x,y) {
	for (id in sprite) {
		var spr = sprite[id];
		if (spr.room === curRoom) {
			if (spr.x == x && spr.y == y) {
				return id;
			}
		}
	}
	return null;
}

var Direction = {
	None : -1,
	Up : 0,
	Down : 1,
	Left : 2,
	Right : 3
};

var curPlayerDirection = Direction.None;
var playerHoldToMoveTimer = 0;

var InputManager = function() {
	var self = this;

	var pressed;
	var ignored;
	var newKeyPress;
	var touchState;

	function resetAll() {
		pressed = {};
		ignored = {};
		newKeyPress = false;

		touchState = {
			isDown : false,
			startX : 0,
			startY : 0,
			curX : 0,
			curY : 0,
			swipeDistance : 30,
			swipeDirection : Direction.None,
			tapReleased : false
		};
	}
	resetAll();

	function stopWindowScrolling(e) {
		if(e.keyCode == key.left || e.keyCode == key.right || e.keyCode == key.up || e.keyCode == key.down || !isPlayerEmbeddedInEditor)
			e.preventDefault();
	}

	function tryRestartGame(e) {
		/* RESTART GAME */
		if ( e.keyCode === key.r && ( e.getModifierState("Control") || e.getModifierState("Meta") ) ) {
			if ( confirm("Restart the game?") ) {
				reset_cur_game();
			}
		}
	}

	function eventIsModifier(event) {
		return (event.keyCode == key.shift || event.keyCode == key.ctrl || event.keyCode == key.alt || event.keyCode == key.cmd);
	}

	function isModifierKeyDown() {
		return ( self.isKeyDown(key.shift) || self.isKeyDown(key.ctrl) || self.isKeyDown(key.alt) || self.isKeyDown(key.cmd) );
	}

	this.ignoreHeldKeys = function() {
		for (var key in pressed) {
			if (pressed[key]) { // only ignore keys that are actually held
				ignored[key] = true;
				// console.log("IGNORE -- " + key);
			}
		}
	}

	this.onkeydown = function(event) {
		// console.log("KEYDOWN -- " + event.keyCode);

		stopWindowScrolling(event);

		tryRestartGame(event);

		// Special keys being held down can interfere with keyup events and lock movement
		// so just don't collect input when they're held
		{
			if (isModifierKeyDown()) {
				return;
			}

			if (eventIsModifier(event)) {
				resetAll();
			}
		}

		if (ignored[event.keyCode]) {
			return;
		}

		if (!self.isKeyDown(event.keyCode)) {
			newKeyPress = true;
		}

		pressed[event.keyCode] = true;
		ignored[event.keyCode] = false;
	}

	this.onkeyup = function(event) {
		// console.log("KEYUP -- " + event.keyCode);
		pressed[event.keyCode] = false;
		ignored[event.keyCode] = false;
	}

	this.ontouchstart = function(event) {
		event.preventDefault();

		if( event.changedTouches.length > 0 ) {
			touchState.isDown = true;

			touchState.startX = touchState.curX = event.changedTouches[0].clientX;
			touchState.startY = touchState.curY = event.changedTouches[0].clientY;

			touchState.swipeDirection = Direction.None;
		}
	}

	this.ontouchmove = function(event) {
		event.preventDefault();

		if( touchState.isDown && event.changedTouches.length > 0 ) {
			touchState.curX = event.changedTouches[0].clientX;
			touchState.curY = event.changedTouches[0].clientY;

			var prevDirection = touchState.swipeDirection;

			if( touchState.curX - touchState.startX <= -touchState.swipeDistance ) {
				touchState.swipeDirection = Direction.Left;
			}
			else if( touchState.curX - touchState.startX >= touchState.swipeDistance ) {
				touchState.swipeDirection = Direction.Right;
			}
			else if( touchState.curY - touchState.startY <= -touchState.swipeDistance ) {
				touchState.swipeDirection = Direction.Up;
			}
			else if( touchState.curY - touchState.startY >= touchState.swipeDistance ) {
				touchState.swipeDirection = Direction.Down;
			}

			if( touchState.swipeDirection != prevDirection ) {
				// reset center so changing directions is easier
				touchState.startX = touchState.curX;
				touchState.startY = touchState.curY;
			}
		}
	}

	this.ontouchend = function(event) {
		event.preventDefault();

		touchState.isDown = false;

		if( touchState.swipeDirection == Direction.None ) {
			// tap!
			touchState.tapReleased = true;
		}

		touchState.swipeDirection = Direction.None;
	}

	this.isKeyDown = function(keyCode) {
		return pressed[keyCode] != null && pressed[keyCode] == true && (ignored[keyCode] == null || ignored[keyCode] == false);
	}

	this.anyKeyPressed = function() {
		return newKeyPress;
	}

	this.resetKeyPressed = function() {
		newKeyPress = false;
	}

	this.swipeLeft = function() {
		return touchState.swipeDirection == Direction.Left;
	}

	this.swipeRight = function() {
		return touchState.swipeDirection == Direction.Right;
	}

	this.swipeUp = function() {
		return touchState.swipeDirection == Direction.Up;
	}

	this.swipeDown = function() {
		return touchState.swipeDirection == Direction.Down;
	}

	this.isTapReleased = function() {
		return touchState.tapReleased;
	}

	this.resetTapReleased = function() {
		touchState.tapReleased = false;
	}

	this.onblur = function() {
		// console.log("~~~ BLUR ~~");
		resetAll();
	}
}
var input = null;

function movePlayer(direction) {
	if (player().room == null || !Object.keys(room).includes(player().room)) {
		return; // player room is missing or invalid.. can't move them!
	}

	var spr = null;

	if ( curPlayerDirection == Direction.Left && !(spr = getSpriteLeft()) && !isWallLeft()) {
		player().x -= 1;
	}
	else if ( curPlayerDirection == Direction.Right && !(spr = getSpriteRight()) && !isWallRight()) {
		player().x += 1;
	}
	else if ( curPlayerDirection == Direction.Up && !(spr = getSpriteUp()) && !isWallUp()) {
		player().y -= 1;
	}
	else if ( curPlayerDirection == Direction.Down && !(spr = getSpriteDown()) && !isWallDown()) {
		player().y += 1;
	}
	
	var ext = getExit( player().room, player().x, player().y );
	var end = getEnding( player().room, player().x, player().y );
	var itmIndex = getItemIndex( player().room, player().x, player().y );

	// do items first, because you can pick up an item AND go through a door
	if (itmIndex > -1) {
		var itm = room[player().room].items[itmIndex];
		var itemRoom = player().room;

		startItemDialog(itm.id, function() {
			// remove item from room
			room[itemRoom].items.splice(itmIndex, 1);

			// update player inventory
			if (player().inventory[itm.id]) {
				player().inventory[itm.id] += 1;
			}
			else {
				player().inventory[itm.id] = 1;
			}

			// show inventory change in UI
			if (onInventoryChanged != null) {
				onInventoryChanged(itm.id);
			}
		});
	}

	if (end) {
		startEndingDialog(end);
	}
	else if (ext) {
		movePlayerThroughExit(ext);
	}
	else if (spr) {
		startSpriteDialog(spr /*spriteId*/);
	}
}

var transition = new TransitionManager();

function movePlayerThroughExit(ext) {
	var GoToDest = function() {
		if (ext.transition_effect != null) {
			transition.BeginTransition(player().room, player().x, player().y, ext.dest.room, ext.dest.x, ext.dest.y, ext.transition_effect);
			transition.UpdateTransition(0);
		}

		player().room = ext.dest.room;
		player().x = ext.dest.x;
		player().y = ext.dest.y;
		curRoom = ext.dest.room;

		initRoom(curRoom);
	};

	if (ext.dlg != undefined && ext.dlg != null) {
		// TODO : I need to simplify dialog code,
		// so I don't have to get the ID and the source str
		// every time!
		startDialog(
			dialog[ext.dlg].src,
			ext.dlg,
			function(result) {
				var isLocked = ext.property && ext.property.locked === true;
				if (!isLocked) {
					GoToDest();
				}
			},
			ext);
	}
	else {
		GoToDest();
	}
}

function initRoom(roomId) {
	// init exit properties
	for (var i = 0; i < room[roomId].exits.length; i++) {
		room[roomId].exits[i].property = { locked:false };
	}

	// init ending properties
	for (var i = 0; i < room[roomId].endings.length; i++) {
		room[roomId].endings[i].property = { locked:false };
	}
}

function getItemIndex( roomId, x, y ) {
	for( var i = 0; i < room[roomId].items.length; i++ ) {
		var itm = room[roomId].items[i];
		if ( itm.x == x && itm.y == y)
			return i;
	}
	return -1;
}

function getSpriteLeft() { //repetitive?
	return getSpriteAt( player().x - 1, player().y );
}

function getSpriteRight() {
	return getSpriteAt( player().x + 1, player().y );
}

function getSpriteUp() {
	return getSpriteAt( player().x, player().y - 1 );
}

function getSpriteDown() {
	return getSpriteAt( player().x, player().y + 1 );
}

function isWallLeft() {
	return (player().x - 1 < 0) || isWall( player().x - 1, player().y );
}

function isWallRight() {
	return (player().x + 1 >= 16) || isWall( player().x + 1, player().y );
}

function isWallUp() {
	return (player().y - 1 < 0) || isWall( player().x, player().y - 1 );
}

function isWallDown() {
	return (player().y + 1 >= 16) || isWall( player().x, player().y + 1 );
}

function isWall(x,y,roomId) {
	if(roomId == undefined || roomId == null)
		roomId = curRoom;

	var tileId = getTile( x, y );

	if( tileId === '0' )
		return false; // Blank spaces aren't walls, ya doofus

	if( tile[tileId].isWall === undefined || tile[tileId].isWall === null ) {
		// No wall-state defined: check room-specific walls
		var i = room[roomId].walls.indexOf( getTile(x,y) );
		return i > -1;
	}

	// Otherwise, use the tile's own wall-state
	return tile[tileId].isWall;
}

function getItem(roomId,x,y) {
	for (i in room[roomId].items) {
		var item = room[roomId].items[i];
		if (x == item.x && y == item.y) {
			return item;
		}
	}
	return null;
}

function getExit(roomId,x,y) {
	for (i in room[roomId].exits) {
		var e = room[roomId].exits[i];
		if (x == e.x && y == e.y) {
			return e;
		}
	}
	return null;
}

function getEnding(roomId,x,y) {
	for (i in room[roomId].endings) {
		var e = room[roomId].endings[i];
		if (x == e.x && y == e.y) {
			return e;
		}
	}
	return null;
}

function getTile(x,y) {
	// console.log(x + " " + y);
	var t = getRoom().tilemap[y][x];
	return t;
}

function player() {
	return sprite[playerId];
}

// Sort of a hack for legacy palette code (when it was just an array)
function getPal(id) {
	if (palette[id] === undefined) {
		id = "default";
	}

	return palette[ id ].colors;
}

function getRoom() {
	return room[curRoom];
}

function isSpriteOffstage(id) {
	return sprite[id].room == null;
}

function parseWorld(file) {
	spriteStartLocations = {};

	resetFlags();

	var versionNumber = 0;

	// flags to keep track of which compatibility conversions
	// need to be applied to this game data
	var compatibilityFlags = {
		convertSayToPrint : false,
		combineEndingsWithDialog : false,
		convertImplicitSpriteDialogIds : false,
	};

	var lines = file.split("\n");
	var i = 0;
	while (i < lines.length) {
		var curLine = lines[i];

		// console.log(lines[i]);

		if (i == 0) {
			i = parseTitle(lines, i);
		}
		else if (curLine.length <= 0 || curLine.charAt(0) === "#") {
			// collect version number (from a comment.. hacky I know)
			if (curLine.indexOf("# BITSY VERSION ") != -1) {
				versionNumber = parseFloat(curLine.replace("# BITSY VERSION ", ""));

				if (versionNumber < 5.0) {
					compatibilityFlags.convertSayToPrint = true;
				}

				if (versionNumber < 7.0) {
					compatibilityFlags.combineEndingsWithDialog = true;
					compatibilityFlags.convertImplicitSpriteDialogIds = true;
				}
			}

			//skip blank lines & comments
			i++;
		}
		else if (getType(curLine) == "PAL") {
			i = parsePalette(lines, i);
		}
		else if (getType(curLine) === "ROOM" || getType(curLine) === "SET") { //SET for back compat
			i = parseRoom(lines, i, compatibilityFlags);
		}
		else if (getType(curLine) === "TIL") {
			i = parseTile(lines, i);
		}
		else if (getType(curLine) === "SPR") {
			i = parseSprite(lines, i);
		}
		else if (getType(curLine) === "ITM") {
			i = parseItem(lines, i);
		}
		else if (getType(curLine) === "DRW") {
			i = parseDrawing(lines, i);
		}
		else if (getType(curLine) === "DLG") {
			i = parseDialog(lines, i, compatibilityFlags);
		}
		else if (getType(curLine) === "END" && compatibilityFlags.combineEndingsWithDialog) {
			// parse endings for back compat
			i = parseEnding(lines, i, compatibilityFlags);
		}
		else if (getType(curLine) === "VAR") {
			i = parseVariable(lines, i);
		}
		else if (getType(curLine) === "DEFAULT_FONT") {
			i = parseFontName(lines, i);
		}
		else if (getType(curLine) === "TEXT_DIRECTION") {
			i = parseTextDirection(lines, i);
		}
		else if (getType(curLine) === "FONT") {
			i = parseFontData(lines, i);
		}
		else if (getType(curLine) === "!") {
			i = parseFlag(lines, i);
		}
		else {
			i++;
		}
	}

	placeSprites();

	var roomIds = Object.keys(room);
	if (player() != undefined && player().room != null && roomIds.includes(player().room)) {
		// player has valid room
		curRoom = player().room;
	}
	else if (roomIds.length > 0) {
		// player not in any room! what the heck
		curRoom = roomIds[0];
	}
	else {
		// uh oh there are no rooms I guess???
		curRoom = null;
	}

	if (curRoom != null) {
		initRoom(curRoom);
	}

	renderer.SetPalettes(palette);

	scriptCompatibility(compatibilityFlags);

	return versionNumber;
}

function scriptCompatibility(compatibilityFlags) {
	if (compatibilityFlags.convertSayToPrint) {
		console.log("CONVERT SAY TO PRINT!");

		var PrintFunctionVisitor = function() {
			var didChange = false;
			this.DidChange = function() { return didChange; };

			this.Visit = function(node) {
				if (node.type != "function") {
					return;
				}

				if (node.name === "say") {
					node.name = "print";
					didChange = true;
				}
			};
		};

		for (dlgId in dialog) {
			var dialogScript = scriptInterpreter.Parse(dialog[dlgId].src);
			var visitor = new PrintFunctionVisitor();
			dialogScript.VisitAll(visitor);
			if (visitor.DidChange()) {
				var newDialog = dialogScript.Serialize();
				if (newDialog.indexOf("\n") > -1) {
					newDialog = '"""\n' + newDialog + '\n"""';
				}
				dialog[dlgId].src = newDialog;
			}
		}
	}
}

//TODO this is in progress and doesn't support all features
function serializeWorld(skipFonts) {
	if (skipFonts === undefined || skipFonts === null)
		skipFonts = false;

	var worldStr = "";
	/* TITLE */
	worldStr += getTitle() + "\n";
	worldStr += "\n";
	/* VERSION */
	worldStr += "# BITSY VERSION " + getEngineVersion() + "\n"; // add version as a comment for debugging purposes
	if (version.devBuildPhase != "RELEASE") {
		worldStr += "# DEVELOPMENT BUILD -- " + version.devBuildPhase;
	}
	worldStr += "\n";
	/* FLAGS */
	for (f in flags) {
		worldStr += "! " + f + " " + flags[f] + "\n";
	}
	worldStr += "\n"
	/* FONT */
	if (fontName != defaultFontName) {
		worldStr += "DEFAULT_FONT " + fontName + "\n";
		worldStr += "\n"
	}
	if (textDirection != TextDirection.LeftToRight) {
		worldStr += "TEXT_DIRECTION " + textDirection + "\n";
		worldStr += "\n"
	}
	/* PALETTE */
	for (id in palette) {
		if (id != "default") {
			worldStr += "PAL " + id + "\n";
			if( palette[id].name != null )
				worldStr += "NAME " + palette[id].name + "\n";
			for (i in getPal(id)) {
				for (j in getPal(id)[i]) {
					worldStr += getPal(id)[i][j];
					if (j < 2) worldStr += ",";
				}
				worldStr += "\n";
			}
			worldStr += "\n";
		}
	}
	/* ROOM */
	for (id in room) {
		worldStr += "ROOM " + id + "\n";
		if ( flags.ROOM_FORMAT == 0 ) {
			// old non-comma separated format
			for (i in room[id].tilemap) {
				for (j in room[id].tilemap[i]) {
					worldStr += room[id].tilemap[i][j];	
				}
				worldStr += "\n";
			}
		}
		else if ( flags.ROOM_FORMAT == 1 ) {
			// new comma separated format
			for (i in room[id].tilemap) {
				for (j in room[id].tilemap[i]) {
					worldStr += room[id].tilemap[i][j];
					if (j < room[id].tilemap[i].length-1) worldStr += ","
				}
				worldStr += "\n";
			}
		}
		if (room[id].name != null) {
			/* NAME */
			worldStr += "NAME " + room[id].name + "\n";
		}
		if (room[id].walls.length > 0) {
			/* WALLS */
			worldStr += "WAL ";
			for (j in room[id].walls) {
				worldStr += room[id].walls[j];
				if (j < room[id].walls.length-1) {
					worldStr += ",";
				}
			}
			worldStr += "\n";
		}
		if (room[id].items.length > 0) {
			/* ITEMS */
			for (j in room[id].items) {
				var itm = room[id].items[j];
				worldStr += "ITM " + itm.id + " " + itm.x + "," + itm.y;
				worldStr += "\n";
			}
		}
		if (room[id].exits.length > 0) {
			/* EXITS */
			for (j in room[id].exits) {
				var e = room[id].exits[j];
				if ( isExitValid(e) ) {
					worldStr += "EXT " + e.x + "," + e.y + " " + e.dest.room + " " + e.dest.x + "," + e.dest.y;
					if (e.transition_effect != undefined && e.transition_effect != null) {
						worldStr += " FX " + e.transition_effect;
					}
					if (e.dlg != undefined && e.dlg != null) {
						worldStr += " DLG " + e.dlg;
					}
					worldStr += "\n";
				}
			}
		}
		if (room[id].endings.length > 0) {
			/* ENDINGS */
			for (j in room[id].endings) {
				var e = room[id].endings[j];
				// todo isEndingValid
				worldStr += "END " + e.id + " " + e.x + "," + e.y;
				worldStr += "\n";
			}
		}
		if (room[id].pal != null && room[id].pal != "default") {
			/* PALETTE */
			worldStr += "PAL " + room[id].pal + "\n";
		}
		worldStr += "\n";
	}
	/* TILES */
	for (id in tile) {
		worldStr += "TIL " + id + "\n";
		worldStr += serializeDrawing( "TIL_" + id );
		if (tile[id].name != null && tile[id].name != undefined) {
			/* NAME */
			worldStr += "NAME " + tile[id].name + "\n";
		}
		if (tile[id].isWall != null && tile[id].isWall != undefined) {
			/* WALL */
			worldStr += "WAL " + tile[id].isWall + "\n";
		}
		if (tile[id].col != null && tile[id].col != undefined && tile[id].col != 1) {
			/* COLOR OVERRIDE */
			worldStr += "COL " + tile[id].col + "\n";
		}
		worldStr += "\n";
	}
	/* SPRITES */
	for (id in sprite) {
		worldStr += "SPR " + id + "\n";
		worldStr += serializeDrawing( "SPR_" + id );
		if (sprite[id].name != null && sprite[id].name != undefined) {
			/* NAME */
			worldStr += "NAME " + sprite[id].name + "\n";
		}
		if (sprite[id].dlg != null) {
			worldStr += "DLG " + sprite[id].dlg + "\n";
		}
		if (sprite[id].room != null) {
			/* SPRITE POSITION */
			worldStr += "POS " + sprite[id].room + " " + sprite[id].x + "," + sprite[id].y + "\n";
		}
		if (sprite[id].inventory != null) {
			for(itemId in sprite[id].inventory) {
				worldStr += "ITM " + itemId + " " + sprite[id].inventory[itemId] + "\n";
			}
		}
		if (sprite[id].col != null && sprite[id].col != undefined && sprite[id].col != 2) {
			/* COLOR OVERRIDE */
			worldStr += "COL " + sprite[id].col + "\n";
		}
		worldStr += "\n";
	}
	/* ITEMS */
	for (id in item) {
		worldStr += "ITM " + id + "\n";
		worldStr += serializeDrawing( "ITM_" + id );
		if (item[id].name != null && item[id].name != undefined) {
			/* NAME */
			worldStr += "NAME " + item[id].name + "\n";
		}
		if (item[id].dlg != null) {
			worldStr += "DLG " + item[id].dlg + "\n";
		}
		if (item[id].col != null && item[id].col != undefined && item[id].col != 2) {
			/* COLOR OVERRIDE */
			worldStr += "COL " + item[id].col + "\n";
		}
		worldStr += "\n";
	}
	/* DIALOG */
	for (id in dialog) {
		if (id != titleDialogId) {
			worldStr += "DLG " + id + "\n";
			worldStr += dialog[id].src + "\n";
			if (dialog[id].name != null) {
				worldStr += "NAME " + dialog[id].name + "\n";
			}
			worldStr += "\n";
		}
	}
	/* VARIABLES */
	for (id in variable) {
		worldStr += "VAR " + id + "\n";
		worldStr += variable[id] + "\n";
		worldStr += "\n";
	}
	/* FONT */
	// TODO : support multiple fonts
	if (fontName != defaultFontName && !skipFonts) {
		worldStr += fontManager.GetData(fontName);
	}

	return worldStr;
}

function serializeDrawing(drwId) {
	var imageSource = renderer.GetImageSource(drwId);
	var drwStr = "";
	for (f in imageSource) {
		for (y in imageSource[f]) {
			var rowStr = "";
			for (x in imageSource[f][y]) {
				rowStr += imageSource[f][y][x];
			}
			drwStr += rowStr + "\n";
		}
		if (f < (imageSource.length-1)) drwStr += ">\n";
	}
	return drwStr;
}

function isExitValid(e) {
	var hasValidStartPos = e.x >= 0 && e.x < 16 && e.y >= 0 && e.y < 16;
	var hasDest = e.dest != null;
	var hasValidRoomDest = (e.dest.room != null && e.dest.x >= 0 && e.dest.x < 16 && e.dest.y >= 0 && e.dest.y < 16);
	return hasValidStartPos && hasDest && hasValidRoomDest;
}

function placeSprites() {
	for (id in spriteStartLocations) {
		//console.log(id);
		//console.log( spriteStartLocations[id] );
		//console.log(sprite[id]);
		sprite[id].room = spriteStartLocations[id].room;
		sprite[id].x = spriteStartLocations[id].x;
		sprite[id].y = spriteStartLocations[id].y;
		//console.log(sprite[id]);
	}
}

/* ARGUMENT GETTERS */
function getType(line) {
	return getArg(line,0);
}

function getId(line) {
	return getArg(line,1);
}

function getArg(line,arg) {
	return line.split(" ")[arg];
}

function getCoord(line,arg) {
	return getArg(line,arg).split(",");
}

function parseTitle(lines, i) {
	var results = scriptUtils.ReadDialogScript(lines,i);
	setTitle(results.script);
	i = results.index;

	i++;

	return i;
}

function parseRoom(lines, i, compatibilityFlags) {
	var id = getId(lines[i]);
	room[id] = {
		id : id,
		tilemap : [],
		walls : [],
		exits : [],
		endings : [],
		items : [],
		pal : null,
		name : null
	};
	i++;

	// create tile map
	if ( flags.ROOM_FORMAT == 0 ) {
		// old way: no commas, single char tile ids
		var end = i + mapsize;
		var y = 0;
		for (; i<end; i++) {
			room[id].tilemap.push( [] );
			for (x = 0; x<mapsize; x++) {
				room[id].tilemap[y].push( lines[i].charAt(x) );
			}
			y++;
		}
	}
	else if ( flags.ROOM_FORMAT == 1 ) {
		// new way: comma separated, multiple char tile ids
		var end = i + mapsize;
		var y = 0;
		for (; i<end; i++) {
			room[id].tilemap.push( [] );
			var lineSep = lines[i].split(",");
			for (x = 0; x<mapsize; x++) {
				room[id].tilemap[y].push( lineSep[x] );
			}
			y++;
		}
	}

	while (i < lines.length && lines[i].length > 0) { //look for empty line
		// console.log(getType(lines[i]));
		if (getType(lines[i]) === "SPR") {
			/* NOTE SPRITE START LOCATIONS */
			var sprId = getId(lines[i]);
			if (sprId.indexOf(",") == -1 && lines[i].split(" ").length >= 3) { //second conditional checks for coords
				/* PLACE A SINGLE SPRITE */
				var sprCoord = lines[i].split(" ")[2].split(",");
				spriteStartLocations[sprId] = {
					room : id,
					x : parseInt(sprCoord[0]),
					y : parseInt(sprCoord[1])
				};
			}
			else if ( flags.ROOM_FORMAT == 0 ) { // TODO: right now this shortcut only works w/ the old comma separate format
				/* PLACE MULTIPLE SPRITES*/ 
				//Does find and replace in the tilemap (may be hacky, but its convenient)
				var sprList = sprId.split(",");
				for (row in room[id].tilemap) {
					for (s in sprList) {
						var col = room[id].tilemap[row].indexOf( sprList[s] );
						//if the sprite is in this row, replace it with the "null tile" and set its starting position
						if (col != -1) {
							room[id].tilemap[row][col] = "0";
							spriteStartLocations[ sprList[s] ] = {
								room : id,
								x : parseInt(col),
								y : parseInt(row)
							};
						}
					}
				}
			}
		}
		else if (getType(lines[i]) === "ITM") {
			var itmId = getId(lines[i]);
			var itmCoord = lines[i].split(" ")[2].split(",");
			var itm = {
				id: itmId,
				x : parseInt(itmCoord[0]),
				y : parseInt(itmCoord[1])
			};
			room[id].items.push( itm );
		}
		else if (getType(lines[i]) === "WAL") {
			/* DEFINE COLLISIONS (WALLS) */
			room[id].walls = getId(lines[i]).split(",");
		}
		else if (getType(lines[i]) === "EXT") {
			/* ADD EXIT */
			var exitArgs = lines[i].split(" ");
			//arg format: EXT 10,5 M 3,2 [AVA:7 LCK:a,9] [AVA 7 LCK a 9]
			var exitCoords = exitArgs[1].split(",");
			var destName = exitArgs[2];
			var destCoords = exitArgs[3].split(",");
			var ext = {
				x : parseInt(exitCoords[0]),
				y : parseInt(exitCoords[1]),
				dest : {
					room : destName,
					x : parseInt(destCoords[0]),
					y : parseInt(destCoords[1])
				},
				transition_effect : null,
				dlg: null,
			};

			// optional arguments
			var exitArgIndex = 4;
			while (exitArgIndex < exitArgs.length) {
				if (exitArgs[exitArgIndex] == "FX") {
					ext.transition_effect = exitArgs[exitArgIndex+1];
					exitArgIndex += 2;
				}
				else if (exitArgs[exitArgIndex] == "DLG") {
					ext.dlg = exitArgs[exitArgIndex+1];
					exitArgIndex += 2;
				}
				else {
					exitArgIndex += 1;
				}
			}

			room[id].exits.push(ext);
		}
		else if (getType(lines[i]) === "END") {
			/* ADD ENDING */
			var endId = getId(lines[i]);

			// compatibility with when endings were stored separate from other dialog
			if (compatibilityFlags.combineEndingsWithDialog) {
				endId = "end_" + endId;
			}

			var endCoords = getCoord(lines[i], 2);
			var end = {
				id : endId,
				x : parseInt(endCoords[0]),
				y : parseInt(endCoords[1])
			};

			room[id].endings.push(end);
		}
		else if (getType(lines[i]) === "PAL") {
			/* CHOOSE PALETTE (that's not default) */
			room[id].pal = getId(lines[i]);
		}
		else if (getType(lines[i]) === "NAME") {
			var name = lines[i].split(/\s(.+)/)[1];
			room[id].name = name;
			names.room.set(name, id);
		}

		i++;
	}

	return i;
}

function parsePalette(lines,i) { //todo this has to go first right now :(
	var id = getId(lines[i]);
	i++;
	var colors = [];
	var name = null;
	while (i < lines.length && lines[i].length > 0) { //look for empty line
		var args = lines[i].split(" ");
		if (args[0] === "NAME") {
			name = lines[i].split(/\s(.+)/)[1];
		}
		else {
			var col = [];
			lines[i].split(",").forEach(function(i) {
				col.push(parseInt(i));
			});
			colors.push(col);
		}
		i++;
	}
	palette[id] = {
		id : id,
		name : name,
		colors : colors
	};
	return i;
}

function parseTile(lines, i) {
	var id = getId(lines[i]);
	var drwId = null;
	var name = null;

	i++;

	if (getType(lines[i]) === "DRW") { //load existing drawing
		drwId = getId(lines[i]);
		i++;
	}
	else {
		// store tile source
		drwId = "TIL_" + id;
		i = parseDrawingCore( lines, i, drwId );
	}

	//other properties
	var colorIndex = 1; // default palette color index is 1
	var isWall = null; // null indicates it can vary from room to room (original version)
	while (i < lines.length && lines[i].length > 0) { //look for empty line
		if (getType(lines[i]) === "COL") {
			colorIndex = parseInt( getId(lines[i]) );
		}
		else if (getType(lines[i]) === "NAME") {
			/* NAME */
			name = lines[i].split(/\s(.+)/)[1];
			names.tile.set( name, id );
		}
		else if (getType(lines[i]) === "WAL") {
			var wallArg = getArg( lines[i], 1 );
			if( wallArg === "true" ) {
				isWall = true;
			}
			else if( wallArg === "false" ) {
				isWall = false;
			}
		}
		i++;
	}

	//tile data
	tile[id] = {
		id : id,
		drw : drwId, //drawing id
		col : colorIndex,
		animation : {
			isAnimated : (renderer.GetFrameCount(drwId) > 1),
			frameIndex : 0,
			frameCount : renderer.GetFrameCount(drwId)
		},
		name : name,
		isWall : isWall
	};

	return i;
}

function parseSprite(lines, i) {
	var id = getId(lines[i]);
	var drwId = null;
	var name = null;

	i++;

	if (getType(lines[i]) === "DRW") { //load existing drawing
		drwId = getId(lines[i]);
		i++;
	}
	else {
		// store sprite source
		drwId = "SPR_" + id;
		i = parseDrawingCore( lines, i, drwId );
	}

	//other properties
	var colorIndex = 2; //default palette color index is 2
	var dialogId = null;
	var startingInventory = {};
	while (i < lines.length && lines[i].length > 0) { //look for empty line
		if (getType(lines[i]) === "COL") {
			/* COLOR OFFSET INDEX */
			colorIndex = parseInt( getId(lines[i]) );
		}
		else if (getType(lines[i]) === "POS") {
			/* STARTING POSITION */
			var posArgs = lines[i].split(" ");
			var roomId = posArgs[1];
			var coordArgs = posArgs[2].split(",");
			spriteStartLocations[id] = {
				room : roomId,
				x : parseInt(coordArgs[0]),
				y : parseInt(coordArgs[1])
			};
		}
		else if(getType(lines[i]) === "DLG") {
			dialogId = getId(lines[i]);
		}
		else if (getType(lines[i]) === "NAME") {
			/* NAME */
			name = lines[i].split(/\s(.+)/)[1];
			names.sprite.set( name, id );
		}
		else if (getType(lines[i]) === "ITM") {
			/* ITEM STARTING INVENTORY */
			var itemId = getId(lines[i]);
			var itemCount = parseFloat( getArg(lines[i], 2) );
			startingInventory[itemId] = itemCount;
		}
		i++;
	}

	//sprite data
	sprite[id] = {
		id : id,
		drw : drwId, //drawing id
		col : colorIndex,
		dlg : dialogId,
		room : null, //default location is "offstage"
		x : -1,
		y : -1,
		animation : {
			isAnimated : (renderer.GetFrameCount(drwId) > 1),
			frameIndex : 0,
			frameCount : renderer.GetFrameCount(drwId)
		},
		inventory : startingInventory,
		name : name
	};
	return i;
}

function parseItem(lines, i) {
	var id = getId(lines[i]);
	var drwId = null;
	var name = null;

	i++;

	if (getType(lines[i]) === "DRW") { //load existing drawing
		drwId = getId(lines[i]);
		i++;
	}
	else {
		// store item source
		drwId = "ITM_" + id; // these prefixes are maybe a terrible way to differentiate drawing tyepes :/
		i = parseDrawingCore( lines, i, drwId );
	}

	//other properties
	var colorIndex = 2; //default palette color index is 2
	var dialogId = null;
	while (i < lines.length && lines[i].length > 0) { //look for empty line
		if (getType(lines[i]) === "COL") {
			/* COLOR OFFSET INDEX */
			colorIndex = parseInt( getArg( lines[i], 1 ) );
		}
		// else if (getType(lines[i]) === "POS") {
		// 	/* STARTING POSITION */
		// 	var posArgs = lines[i].split(" ");
		// 	var roomId = posArgs[1];
		// 	var coordArgs = posArgs[2].split(",");
		// 	spriteStartLocations[id] = {
		// 		room : roomId,
		// 		x : parseInt(coordArgs[0]),
		// 		y : parseInt(coordArgs[1])
		// 	};
		// }
		else if(getType(lines[i]) === "DLG") {
			dialogId = getId(lines[i]);
		}
		else if (getType(lines[i]) === "NAME") {
			/* NAME */
			name = lines[i].split(/\s(.+)/)[1];
			names.item.set( name, id );
		}
		i++;
	}

	//item data
	item[id] = {
		id : id,
		drw : drwId, //drawing id
		col : colorIndex,
		dlg : dialogId,
		// room : null, //default location is "offstage"
		// x : -1,
		// y : -1,
		animation : {
			isAnimated : (renderer.GetFrameCount(drwId) > 1),
			frameIndex : 0,
			frameCount : renderer.GetFrameCount(drwId)
		},
		name : name
	};

	// console.log("ITM " + id);
	// console.log(item[id]);

	return i;
}

function parseDrawing(lines, i) {
	// store drawing source
	var drwId = getId( lines[i] );
	return parseDrawingCore( lines, i, drwId );
}

function parseDrawingCore(lines, i, drwId) {
	var frameList = []; //init list of frames
	frameList.push( [] ); //init first frame
	var frameIndex = 0;
	var y = 0;
	while ( y < tilesize ) {
		var l = lines[i+y];
		var row = [];
		for (x = 0; x < tilesize; x++) {
			row.push( parseInt( l.charAt(x) ) );
		}
		frameList[frameIndex].push( row );
		y++;

		if (y === tilesize) {
			i = i + y;
			if ( lines[i] != undefined && lines[i].charAt(0) === ">" ) {
				// start next frame!
				frameList.push( [] );
				frameIndex++;
				//start the count over again for the next frame
				i++;
				y = 0;
			}
		}
	}

	renderer.SetImageSource(drwId, frameList);

	return i;
}

function parseScript(lines, i, backCompatPrefix, compatibilityFlags) {
	var id = getId(lines[i]);
	id = backCompatPrefix + id;
	i++;

	var results = scriptUtils.ReadDialogScript(lines,i);

	dialog[id] = { src:results.script, name:null };

	if (compatibilityFlags.convertImplicitSpriteDialogIds) {
		// explicitly hook up dialog that used to be implicitly
		// connected by sharing sprite and dialog IDs in old versions
		if (sprite[id]) {
			if (sprite[id].dlg === undefined || sprite[id].dlg === null) {
				sprite[id].dlg = id;
			}
		}
	}

	i = results.index;

	return i;
}

function parseDialog(lines, i, compatibilityFlags) {
	// hacky but I need to store this so I can set the name below
	var id = getId(lines[i]);

	i = parseScript(lines, i, "", compatibilityFlags);

	if (lines[i].length > 0 && getType(lines[i]) === "NAME") {
		dialog[id].name = lines[i].split(/\s(.+)/)[1]; // TODO : hacky to keep copying this regex around...
		names.dialog.set(dialog[id].name, id);
		i++;
	}

	return i;
}

// keeping this around to parse old files where endings were separate from dialogs
function parseEnding(lines, i, compatibilityFlags) {
	return parseScript(lines, i, "end_", compatibilityFlags);
}

function parseVariable(lines, i) {
	var id = getId(lines[i]);
	i++;
	var value = lines[i];
	i++;
	variable[id] = value;
	return i;
}

function parseFontName(lines, i) {
	fontName = getArg(lines[i], 1);
	i++;
	return i;
}

function parseTextDirection(lines, i) {
	textDirection = getArg(lines[i], 1);
	i++;
	return i;
}

function parseFontData(lines, i) {
	// NOTE : we're not doing the actual parsing here --
	// just grabbing the block of text that represents the font
	// and giving it to the font manager to use later

	var localFontName = getId(lines[i]);
	var localFontData = lines[i];
	i++;

	while (i < lines.length && lines[i] != "") {
		localFontData += "\n" + lines[i];
		i++;
	}

	var localFontFilename = localFontName + fontManager.GetExtension();
	fontManager.AddResource( localFontFilename, localFontData );

	return i;
}

function parseFlag(lines, i) {
	var id = getId(lines[i]);
	var valStr = lines[i].split(" ")[2];
	flags[id] = parseInt( valStr );
	i++;
	return i;
}

function drawTile(img,x,y,context) {
	if (!context) { //optional pass in context; otherwise, use default
		context = ctx;
	}
	// NOTE: images are now canvases, instead of raw image data (for chrome performance reasons)
	context.drawImage(img,x*tilesize*scale,y*tilesize*scale,tilesize*scale,tilesize*scale);
}

function drawSprite(img,x,y,context) { //this may differ later (or not haha)
	drawTile(img,x,y,context);
}

function drawItem(img,x,y,context) {
	drawTile(img,x,y,context); //TODO these methods are dumb and repetitive
}

// var debugLastRoomDrawn = "0";

function drawRoom(room,context,frameIndex) { // context & frameIndex are optional
	if (!context) { //optional pass in context; otherwise, use default (ok this is REAL hacky isn't it)
		context = ctx;
	}

	// if (room.id != debugLastRoomDrawn) {
	// 	debugLastRoomDrawn = room.id;
	// 	console.log("DRAW ROOM " + debugLastRoomDrawn);
	// }

	var paletteId = "default";

	if (room === undefined) {
		// protect against invalid rooms
		context.fillStyle = "rgb(" + getPal(paletteId)[0][0] + "," + getPal(paletteId)[0][1] + "," + getPal(paletteId)[0][2] + ")";
		context.fillRect(0,0,canvas.width,canvas.height);
		return;
	}

	//clear screen
	if (room.pal != null && palette[paletteId] != undefined) {
		paletteId = room.pal;
	}
	context.fillStyle = "rgb(" + getPal(paletteId)[0][0] + "," + getPal(paletteId)[0][1] + "," + getPal(paletteId)[0][2] + ")";
	context.fillRect(0,0,canvas.width,canvas.height);

	//draw tiles
	for (i in room.tilemap) {
		for (j in room.tilemap[i]) {
			var id = room.tilemap[i][j];
			if (id != "0") {
				//console.log(id);
				if (tile[id] == null) { // hack-around to avoid corrupting files (not a solution though!)
					id = "0";
					room.tilemap[i][j] = id;
				}
				else {
					// console.log(id);
					drawTile( getTileImage(tile[id],paletteId,frameIndex), j, i, context );
				}
			}
		}
	}

	//draw items
	for (var i = 0; i < room.items.length; i++) {
		var itm = room.items[i];
		drawItem( getItemImage(item[itm.id],paletteId,frameIndex), itm.x, itm.y, context );
	}

	//draw sprites
	for (id in sprite) {
		var spr = sprite[id];
		if (spr.room === room.id) {
			drawSprite( getSpriteImage(spr,paletteId,frameIndex), spr.x, spr.y, context );
		}
	}
}

// TODO : remove these get*Image methods
function getTileImage(t,palId,frameIndex) {
	return renderer.GetImage(t,palId,frameIndex);
}

function getSpriteImage(s,palId,frameIndex) {
	return renderer.GetImage(s,palId,frameIndex);
}

function getItemImage(itm,palId,frameIndex) {
	return renderer.GetImage(itm,palId,frameIndex);
}

function curPal() {
	return getRoomPal(curRoom);
}

function getRoomPal(roomId) {
	var defaultId = "default";

	if (roomId == null) {
		return defaultId;
	}
	else if (room[roomId].pal != null) {
		//a specific palette was chosen
		return room[roomId].pal;
	}
	else {
		if (roomId in palette) {
			//there is a palette matching the name of the room
			return roomId;
		}
		else {
			//use the default palette
			return defaultId;
		}
	}
	return defaultId;
}

var isDialogMode = false;
var isNarrating = false;
var isEnding = false;
var dialogModule = new Dialog();
var dialogRenderer = dialogModule.CreateRenderer();
var dialogBuffer = dialogModule.CreateBuffer();
var fontManager = new FontManager();

// TODO : is this scriptResult thing being used anywhere???
function onExitDialog(scriptResult, dialogCallback) {
	console.log("EXIT DIALOG!");

	isDialogMode = false;

	if (isNarrating) {
		isNarrating = false;
	}

	if (isDialogPreview) {
		isDialogPreview = false;

		if (onDialogPreviewEnd != null) {
			onDialogPreviewEnd();
		}
	}

	if (dialogCallback != undefined && dialogCallback != null) {
		dialogCallback(scriptResult);
	}
}

/*
TODO
- titles and endings should also take advantage of the script pre-compilation if possible??
- could there be a namespace collision?
- what about dialog NAMEs vs IDs?
- what about a special script block separate from DLG?
*/
function startNarrating(dialogStr,end) {
	console.log("NARRATE " + dialogStr);

	if(end === undefined) {
		end = false;
	}

	isNarrating = true;
	isEnding = end;

	startDialog(dialogStr);
}

function startEndingDialog(ending) {
	isNarrating = true;
	isEnding = true;

	startDialog(
		dialog[ending.id].src,
		ending.id,
		function() {
			var isLocked = ending.property && ending.property.locked === true;
			if (isLocked) {
				isEnding = false;
			}
		},
		ending);
}

function startItemDialog(itemId, dialogCallback) {
	var dialogId = item[itemId].dlg;
	// console.log("START ITEM DIALOG " + dialogId);
	if (dialog[dialogId]) {
		var dialogStr = dialog[dialogId].src;
		startDialog(dialogStr, dialogId, dialogCallback);
	}
	else {
		dialogCallback();
	}
}

function startSpriteDialog(spriteId) {
	var spr = sprite[spriteId];
	var dialogId = spr.dlg;
	// console.log("START SPRITE DIALOG " + dialogId);
	if (dialog[dialogId]){
		var dialogStr = dialog[dialogId].src;
		startDialog(dialogStr,dialogId);
	}
}

function startDialog(dialogStr, scriptId, dialogCallback, objectContext) {
	// console.log("START DIALOG ");
	if (dialogStr.length <= 0) {
		// console.log("ON EXIT DIALOG -- startDialog 1");
		onExitDialog(null, dialogCallback);
		return;
	}

	isDialogMode = true;

	dialogRenderer.Reset();
	dialogRenderer.SetCentered(isNarrating /*centered*/);
	dialogBuffer.Reset();
	scriptInterpreter.SetDialogBuffer(dialogBuffer);

	var onScriptEnd = function(scriptResult) {
		dialogBuffer.OnDialogEnd(function() {
			onExitDialog(scriptResult, dialogCallback);
		});
	};

	if (scriptId === undefined) { // TODO : what's this for again?
		scriptInterpreter.Interpret(dialogStr, onScriptEnd);
	}
	else {
		if (!scriptInterpreter.HasScript(scriptId)) {
			scriptInterpreter.Compile(scriptId, dialogStr);
		}
		// scriptInterpreter.DebugVisualizeScript(scriptId);
		scriptInterpreter.Run(scriptId, onScriptEnd, objectContext);
	}

}

var isDialogPreview = false;
function startPreviewDialog(script, dialogCallback) {
	isNarrating = true;

	isDialogMode = true;

	isDialogPreview = true;

	dialogRenderer.Reset();
	dialogRenderer.SetCentered(true);
	dialogBuffer.Reset();
	scriptInterpreter.SetDialogBuffer(dialogBuffer);

	// TODO : do I really need a seperate callback for this debug mode??
	onDialogPreviewEnd = dialogCallback;

	var onScriptEndCallback = function(scriptResult) {
		dialogBuffer.OnDialogEnd(function() {
			onExitDialog(scriptResult, null);
		});
	};

	scriptInterpreter.Eval(script, onScriptEndCallback);
}

/* NEW SCRIPT STUFF */
var scriptModule = new Script();
var scriptInterpreter = scriptModule.CreateInterpreter();
var scriptUtils = scriptModule.CreateUtils(); // TODO: move to editor.js?
// scriptInterpreter.SetDialogBuffer( dialogBuffer );

</script>

<!-- store default font in separate script tag for back compat-->
<!-- Borksy modification: uses better encoded default font. -->
<script type="text/bitsyFontData" id="ascii_small">
FONT ascii_small
SIZE 6 8
CHAR 0
000000
000000
000000
000000
000000
000000
000000
000000
CHAR 32
000000
000000
000000
000000
000000
000000
000000
000000
CHAR 33
000100
001110
001110
000100
000100
000000
000100
000000
CHAR 34
011011
011011
010010
000000
000000
000000
000000
000000
CHAR 35
000000
001010
011111
001010
001010
011111
001010
000000
CHAR 36
001000
001110
010000
001100
000010
011100
000100
000000
CHAR 37
011001
011001
000010
000100
001000
010011
010011
000000
CHAR 38
001000
010100
010100
001000
010101
010010
001101
000000
CHAR 39
001100
001100
001000
000000
000000
000000
000000
000000
CHAR 40
000100
001000
001000
001000
001000
001000
000100
000000
CHAR 41
001000
000100
000100
000100
000100
000100
001000
000000
CHAR 42
000000
001010
001110
011111
001110
001010
000000
000000
CHAR 43
000000
000100
000100
011111
000100
000100
000000
000000
CHAR 44
000000
000000
000000
000000
000000
001100
001100
001000
CHAR 45
000000
000000
000000
011111
000000
000000
000000
000000
CHAR 46
000000
000000
000000
000000
000000
001100
001100
000000
CHAR 47
000000
000001
000010
000100
001000
010000
000000
000000
CHAR 48
001110
010001
010011
010101
011001
010001
001110
000000
CHAR 49
000100
001100
000100
000100
000100
000100
001110
000000
CHAR 50
001110
010001
000001
000110
001000
010000
011111
000000
CHAR 51
001110
010001
000001
001110
000001
010001
001110
000000
CHAR 52
000010
000110
001010
010010
011111
000010
000010
000000
CHAR 53
011111
010000
010000
011110
000001
010001
001110
000000
CHAR 54
000110
001000
010000
011110
010001
010001
001110
000000
CHAR 55
011111
000001
000010
000100
001000
001000
001000
000000
CHAR 56
001110
010001
010001
001110
010001
010001
001110
000000
CHAR 57
001110
010001
010001
001111
000001
000010
001100
000000
CHAR 58
000000
000000
001100
001100
000000
001100
001100
000000
CHAR 59
000000
000000
001100
001100
000000
001100
001100
001000
CHAR 60
000010
000100
001000
010000
001000
000100
000010
000000
CHAR 61
000000
000000
011111
000000
000000
011111
000000
000000
CHAR 62
001000
000100
000010
000001
000010
000100
001000
000000
CHAR 63
001110
010001
000001
000110
000100
000000
000100
000000
CHAR 64
001110
010001
010111
010101
010111
010000
001110
000000
CHAR 65
001110
010001
010001
010001
011111
010001
010001
000000
CHAR 66
011110
010001
010001
011110
010001
010001
011110
000000
CHAR 67
001110
010001
010000
010000
010000
010001
001110
000000
CHAR 68
011110
010001
010001
010001
010001
010001
011110
000000
CHAR 69
011111
010000
010000
011110
010000
010000
011111
000000
CHAR 70
011111
010000
010000
011110
010000
010000
010000
000000
CHAR 71
001110
010001
010000
010111
010001
010001
001111
000000
CHAR 72
010001
010001
010001
011111
010001
010001
010001
000000
CHAR 73
001110
000100
000100
000100
000100
000100
001110
000000
CHAR 74
000001
000001
000001
000001
010001
010001
001110
000000
CHAR 75
010001
010010
010100
011000
010100
010010
010001
000000
CHAR 76
010000
010000
010000
010000
010000
010000
011111
000000
CHAR 77
010001
011011
010101
010001
010001
010001
010001
000000
CHAR 78
010001
011001
010101
010011
010001
010001
010001
000000
CHAR 79
001110
010001
010001
010001
010001
010001
001110
000000
CHAR 80
011110
010001
010001
011110
010000
010000
010000
000000
CHAR 81
001110
010001
010001
010001
010101
010010
001101
000000
CHAR 82
011110
010001
010001
011110
010010
010001
010001
000000
CHAR 83
001110
010001
010000
001110
000001
010001
001110
000000
CHAR 84
011111
000100
000100
000100
000100
000100
000100
000000
CHAR 85
010001
010001
010001
010001
010001
010001
001110
000000
CHAR 86
010001
010001
010001
010001
010001
001010
000100
000000
CHAR 87
010001
010001
010101
010101
010101
010101
001010
000000
CHAR 88
010001
010001
001010
000100
001010
010001
010001
000000
CHAR 89
010001
010001
010001
001010
000100
000100
000100
000000
CHAR 90
011110
000010
000100
001000
010000
010000
011110
000000
CHAR 91
001110
001000
001000
001000
001000
001000
001110
000000
CHAR 92
000000
010000
001000
000100
000010
000001
000000
000000
CHAR 93
001110
000010
000010
000010
000010
000010
001110
000000
CHAR 94
000100
001010
010001
000000
000000
000000
000000
000000
CHAR 95
000000
000000
000000
000000
000000
000000
000000
111111
CHAR 96
001100
001100
000100
000000
000000
000000
000000
000000
CHAR 97
000000
000000
001110
000001
001111
010001
001111
000000
CHAR 98
010000
010000
011110
010001
010001
010001
011110
000000
CHAR 99
000000
000000
001110
010001
010000
010001
001110
000000
CHAR 100
000001
000001
001111
010001
010001
010001
001111
000000
CHAR 101
000000
000000
001110
010001
011110
010000
001110
000000
CHAR 102
000110
001000
001000
011110
001000
001000
001000
000000
CHAR 103
000000
000000
001111
010001
010001
001111
000001
001110
CHAR 104
010000
010000
011100
010010
010010
010010
010010
000000
CHAR 105
000100
000000
000100
000100
000100
000100
000110
000000
CHAR 106
000010
000000
000110
000010
000010
000010
010010
001100
CHAR 107
010000
010000
010010
010100
011000
010100
010010
000000
CHAR 108
000100
000100
000100
000100
000100
000100
000110
000000
CHAR 109
000000
000000
011010
010101
010101
010001
010001
000000
CHAR 110
000000
000000
011100
010010
010010
010010
010010
000000
CHAR 111
000000
000000
001110
010001
010001
010001
001110
000000
CHAR 112
000000
000000
011110
010001
010001
010001
011110
010000
CHAR 113
000000
000000
001111
010001
010001
010001
001111
000001
CHAR 114
000000
000000
010110
001001
001000
001000
011100
000000
CHAR 115
000000
000000
001110
010000
001110
000001
001110
000000
CHAR 116
000000
001000
011110
001000
001000
001010
000100
000000
CHAR 117
000000
000000
010010
010010
010010
010110
001010
000000
CHAR 118
000000
000000
010001
010001
010001
001010
000100
000000
CHAR 119
000000
000000
010001
010001
010101
011111
001010
000000
CHAR 120
000000
000000
010010
010010
001100
010010
010010
000000
CHAR 121
000000
000000
010010
010010
010010
001110
000100
011000
CHAR 122
000000
000000
011110
000010
001100
010000
011110
000000
CHAR 123
000110
001000
001000
011000
001000
001000
000110
000000
CHAR 124
000100
000100
000100
000100
000100
000100
000100
000100
CHAR 125
001100
000010
000010
000011
000010
000010
001100
000000
CHAR 126
000000
000000
000000
001010
010100
000000
000000
000000
CHAR 160
000000
000000
000000
000000
000000
000000
000000
000000
CHAR 161
000100
000000
000100
000100
001110
001110
000100
000000
CHAR 162
000000
000100
001110
010000
010000
001110
000100
000000
CHAR 163
000110
001001
001000
011110
001000
001001
010111
000000
CHAR 165
010001
001010
000100
011111
000100
011111
000100
000000
CHAR 167
001110
010001
001100
001010
000110
010001
001110
000000
CHAR 171
000000
000000
001001
010010
001001
000000
000000
000000
CHAR 172
000000
000000
111111
000001
000001
000000
000000
000000
CHAR 177
000000
000100
001110
000100
000000
001110
000000
000000
CHAR 178
011000
000100
001000
011100
000000
000000
000000
000000
CHAR 181
000000
000000
010010
010010
010010
011100
010000
010000
CHAR 182
001111
010101
010101
001101
000101
000101
000101
000000
CHAR 187
000000
000000
010010
001001
010010
000000
000000
000000
CHAR 188
010000
010010
010100
001011
010101
000111
000001
000000
CHAR 189
010000
010010
010100
001110
010001
000010
000111
000000
CHAR 191
000100
000000
000100
001100
010000
010001
001110
000000
CHAR 196
001010
000000
000100
001010
010001
011111
010001
000000
CHAR 197
001110
001010
001110
011011
010001
011111
010001
000000
CHAR 198
001111
010100
010100
011111
010100
010100
010111
000000
CHAR 199
001110
010001
010000
010000
010001
001110
000100
001100
CHAR 201
000011
000000
011111
010000
011110
010000
011111
000000
CHAR 209
001010
010100
000000
010010
011010
010110
010010
000000
CHAR 214
010010
001100
010010
010010
010010
010010
001100
000000
CHAR 220
001010
000000
010010
010010
010010
010010
001100
000000
CHAR 223
000000
011100
010010
011100
010010
010010
011100
010000
CHAR 224
001100
000000
001110
000001
001111
010001
001111
000000
CHAR 225
000110
000000
001110
000001
001111
010001
001111
000000
CHAR 226
001110
000000
001110
000001
001111
010001
001111
000000
CHAR 228
001010
000000
001110
000001
001111
010001
001111
000000
CHAR 229
001110
001010
001110
000001
001111
010001
001111
000000
CHAR 230
000000
000000
011110
000101
011111
010100
001111
000000
CHAR 231
000000
001110
010001
010000
010001
001110
000100
001100
CHAR 232
001100
000000
001110
010001
011110
010000
001110
000000
CHAR 233
000011
000000
001110
010001
011110
010000
001110
000000
CHAR 234
001110
000000
001110
010001
011110
010000
001110
000000
CHAR 235
001010
000000
001110
010001
011110
010000
001110
000000
CHAR 236
001000
000000
000100
000100
000100
000100
000110
000000
CHAR 237
000110
000000
000100
000100
000100
000100
000110
000000
CHAR 238
000100
001010
000000
000100
000100
000100
000110
000000
CHAR 239
001010
000000
000100
000100
000100
000100
000110
000000
CHAR 241
001010
010100
000000
011100
010010
010010
010010
000000
CHAR 242
011000
000000
001100
010010
010010
010010
001100
000000
CHAR 243
000110
000000
001100
010010
010010
010010
001100
000000
CHAR 244
001110
000000
001100
010010
010010
010010
001100
000000
CHAR 246
001010
000000
001100
010010
010010
010010
001100
000000
CHAR 247
001010
000000
001110
010001
010001
010001
001110
000000
CHAR 249
011000
000000
010010
010010
010010
010110
001010
000000
CHAR 250
000110
000000
010010
010010
010010
010110
001010
000000
CHAR 251
001110
000000
010010
010010
010010
010110
001010
000000
CHAR 252
010010
000000
010010
010010
010010
010110
001010
000000
CHAR 255
001010
000000
010010
010010
010010
001110
000100
011000
CHAR 402
000010
000101
000100
001110
000100
000100
010100
001000
CHAR 915
011110
010010
010000
010000
010000
010000
010000
000000
CHAR 920
001100
010010
010010
011110
010010
010010
001100
000000
CHAR 931
011111
010000
001000
000100
001000
010000
011111
000000
CHAR 934
001110
000100
001110
010001
001110
000100
001110
000000
CHAR 937
000000
001110
010001
010001
001010
001010
011011
000000
CHAR 948
001100
010000
001000
000100
001110
010010
001100
000000
CHAR 949
000000
001110
010000
011110
010000
001110
000000
000000
CHAR 960
000000
011111
001010
001010
001010
001010
001010
000000
CHAR 963
000000
000000
001111
010010
010010
001100
000000
000000
CHAR 964
000000
000000
001010
010100
000100
000100
000100
000000
CHAR 966
000000
000100
001110
010101
010101
001110
000100
000000
CHAR 8226
000000
000000
000000
001100
001100
000000
000000
000000
CHAR 8252
001010
001010
001010
001010
001010
000000
001010
000000
CHAR 8592
000000
000100
001100
011111
001100
000100
000000
000000
CHAR 8593
000100
001110
011111
000100
000100
000100
000100
000000
CHAR 8594
000000
000100
000110
011111
000110
000100
000000
000000
CHAR 8595
000100
000100
000100
000100
011111
001110
000100
000000
CHAR 8734
000000
000000
001010
010101
010101
001010
000000
000000
CHAR 8735
000000
000000
000000
010000
010000
010000
011111
000000
CHAR 8801
000000
011110
000000
011110
000000
011110
000000
000000
CHAR 8804
000010
001100
010000
001100
000010
000000
011110
000000
CHAR 8805
010000
001100
000010
001100
010000
000000
011110
000000
CHAR 8962
000100
001110
011011
010001
010001
011111
000000
000000
CHAR 8976
000000
000000
011111
010000
010000
010000
000000
000000
CHAR 9472
000000
000000
000000
111111
000000
000000
000000
000000
CHAR 9474
000100
000100
000100
000100
000100
000100
000100
000100
CHAR 9488
000000
000000
000000
111100
000100
000100
000100
000100
CHAR 9492
000100
000100
000100
000111
000000
000000
000000
000000
CHAR 9500
000100
000100
000100
000111
000100
000100
000100
000100
CHAR 9508
000100
000100
000100
111100
000100
000100
000100
000100
CHAR 9516
000000
000000
000000
111111
000100
000100
000100
000100
CHAR 9524
000100
000100
000100
111111
000000
000000
000000
000000
CHAR 9532
000100
000100
000100
111111
000100
000100
000100
000100
CHAR 9552
000000
111111
000000
111111
000000
000000
000000
000000
CHAR 9553
010100
010100
010100
010100
010100
010100
010100
010100
CHAR 9556
000000
011111
010000
010111
010100
010100
010100
010100
CHAR 9557
000000
111100
000100
111100
000100
000100
000100
000100
CHAR 9558
000000
000000
000000
111100
010100
010100
010100
010100
CHAR 9559
000000
111100
000100
110100
010100
010100
010100
010100
CHAR 9561
010100
010100
010100
011111
000000
000000
000000
000000
CHAR 9562
010100
010111
010000
011111
000000
000000
000000
000000
CHAR 9563
000100
111100
000100
111100
000000
000000
000000
000000
CHAR 9564
010100
010100
010100
111100
000000
000000
000000
000000
CHAR 9565
010100
110100
000100
111100
000000
000000
000000
000000
CHAR 9566
000100
000111
000100
000111
000100
000100
000100
000100
CHAR 9567
010100
010100
010100
010111
010100
010100
010100
010100
CHAR 9568
010100
010111
010000
010111
010100
010100
010100
010100
CHAR 9569
000000
000000
010010
010010
010010
011100
010000
010000
CHAR 9570
010100
010100
010100
110100
010100
010100
010100
010100
CHAR 9571
010100
110100
000100
110100
010100
010100
010100
010100
CHAR 9572
000000
111111
000000
111111
000100
000100
000100
000100
CHAR 9573
000000
000000
000000
111111
010100
010100
010100
010100
CHAR 9574
000000
111111
000000
110111
010100
010100
010100
010100
CHAR 9575
000100
111111
000000
111111
000000
000000
000000
000000
CHAR 9576
010100
010100
010100
111111
000000
000000
000000
000000
CHAR 9577
010100
110111
000000
111111
000000
000000
000000
000000
CHAR 9580
010100
110111
000000
110111
010100
010100
010100
010100
CHAR 9601
000000
000000
000000
000000
000000
000000
000000
111111
CHAR 9602
000000
000000
000000
000000
000000
000000
111111
111111
CHAR 9603
000000
000000
000000
000000
000000
111111
111111
111111
CHAR 9604
000000
000000
000000
000000
111111
111111
111111
111111
CHAR 9605
000000
000000
000000
111111
111111
111111
111111
111111
CHAR 9606
000000
000000
111111
111111
111111
111111
111111
111111
CHAR 9607
000000
111111
111111
111111
111111
111111
111111
111111
CHAR 9608
111111
111111
111111
111111
111111
111111
111111
111111
CHAR 9609
111100
111100
111100
111100
111100
111100
111100
111100
CHAR 9610
111100
111100
111100
111100
111100
111100
111100
111100
CHAR 9611
111000
111000
111000
111000
111000
111000
111000
111000
CHAR 9613
110000
110000
110000
110000
110000
110000
110000
110000
CHAR 9615
100000
100000
100000
100000
100000
100000
100000
100000
CHAR 9617
010101
000000
101010
000000
010101
000000
101010
000000
CHAR 9618
010101
101010
010101
101010
010101
101010
010101
101010
CHAR 9619
101010
111111
010101
111111
101010
111111
010101
111111
CHAR 9644
000000
000000
000000
000000
000000
011110
011110
000000
CHAR 9650
000100
000100
001110
001110
011111
011111
000000
000000
CHAR 9658
001000
001100
001110
001111
001110
001100
001000
000000
CHAR 9660
011111
011111
001110
001110
000100
000100
000000
000000
CHAR 9668
000010
000110
001110
011110
001110
000110
000010
000000
CHAR 9675
000000
000000
011110
010010
010010
011110
000000
000000
CHAR 9688
111111
111111
111111
110011
110011
111111
111111
111111
CHAR 9689
111111
111111
100001
101101
101101
100001
111111
111111
CHAR 9786
001110
010001
011011
010001
010101
010001
001110
000000
CHAR 9787
001110
011111
010101
011111
010001
011111
001110
000000
CHAR 9788
000000
010101
001110
011011
001110
010101
000000
000000
CHAR 9792
001110
010001
010001
001110
000100
001110
000100
000000
CHAR 9794
000000
000111
000011
001101
010010
010010
001100
000000
CHAR 9824
000000
000100
001110
011111
011111
000100
001110
000000
CHAR 9827
000100
001110
001110
000100
011111
011111
000100
000000
CHAR 9829
000000
001010
011111
011111
011111
001110
000100
000000
CHAR 9830
000000
000100
001110
011111
011111
001110
000100
000000
CHAR 9834
000100
000110
000101
000100
001100
011100
011000
000000
CHAR 9835
000011
001101
001011
001101
001011
011011
011000
000000
</script>

<!-- BORKSY HACKS -->
<script type="text/javascript" id="borksyHacks">
//borksy uses dist versions of hacks from the bitsy hacks repo now

/**
📜
@file long dialog
@summary put more words onscreen
@license MIT
@version 15.4.3
@requires 7.0
@author Sean S. LeBlanc

@description
Makes the dialog box variable in height, allowing it to expand as needed.

Minimum and maximum size are configurable.
Cheat sheet:
	2: bitsy default
	8: reaches just below the halfway mark
	16: roughly the max of the original bitsy margins
	19: max before cutting off text

Note: this hack also includes the paragraph break hack
A common pattern in bitsy is using intentional whitespace to force new dialog pages,
but the long dialog hack makes that look awkward since the text box expands.
The paragraph break hack lets you get around this by using a (p) tag to immediately end the current page.

HOW TO USE:
	1. Copy-paste this script into a new script tag after the Bitsy source code.
	2. edit hackOptions below as needed
*/
this.hacks = this.hacks || {};
(function (exports, bitsy) {
'use strict';
var hackOptions =  {
minRows: 2,
maxRows: 8,
} ;

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

bitsy = bitsy || /*#__PURE__*/_interopDefaultLegacy(bitsy);

/**
@file utils
@summary miscellaneous bitsy utilities
@author Sean S. LeBlanc
*/

/*
Helper used to replace code in a script tag based on a search regex
To inject code without erasing original string, using capturing groups; e.g.
	inject(/(some string)/,'injected before $1 injected after')
*/
function inject$1(searchRegex, replaceString) {
	// find the relevant script tag
	var scriptTags = document.getElementsByTagName('script');
	var scriptTag;
	var code;
	for (var i = 0; i < scriptTags.length; ++i) {
		scriptTag = scriptTags[i];
		var matchesSearch = scriptTag.textContent.search(searchRegex) !== -1;
		var isCurrentScript = scriptTag === document.currentScript;
		if (matchesSearch && !isCurrentScript) {
			code = scriptTag.textContent;
			break;
		}
	}

	// error-handling
	if (!code) {
		throw new Error('Couldn\'t find "' + searchRegex + '" in script tags');
	}

	// modify the content
	code = code.replace(searchRegex, replaceString);

	// replace the old script tag with a new one using our modified code
	var newScriptTag = document.createElement('script');
	newScriptTag.textContent = code;
	scriptTag.insertAdjacentElement('afterend', newScriptTag);
	scriptTag.remove();
}

/**
 * Helper for getting an array with unique elements
 * @param  {Array} array Original array
 * @return {Array}       Copy of array, excluding duplicates
 */
function unique(array) {
	return array.filter(function (item, idx) {
		return array.indexOf(item) === idx;
	});
}

/**

@file kitsy-script-toolkit
@summary makes it easier and cleaner to run code before and after Bitsy functions or to inject new code into Bitsy script tags
@license WTFPL (do WTF you want)
@requires Bitsy Version: 4.5, 4.6
@author @mildmojo

@description
HOW TO USE:
  import {before, after, inject, addDialogTag, addDeferredDialogTag} from "./helpers/kitsy-script-toolkit";

  before(targetFuncName, beforeFn);
  after(targetFuncName, afterFn);
  inject(searchRegex, replaceString);
  addDialogTag(tagName, dialogFn);
  addDeferredDialogTag(tagName, dialogFn);

  For more info, see the documentation at:
  https://github.com/seleb/bitsy-hacks/wiki/Coding-with-kitsy
*/

// Ex: inject(/(names.sprite.set\( name, id \);)/, '$1console.dir(names)');
function inject(searchRegex, replaceString) {
	var kitsy = kitsyInit();
	if (
		!kitsy.queuedInjectScripts.some(function (script) {
			return searchRegex.toString() === script.searchRegex.toString() && replaceString === script.replaceString;
		})
	) {
		kitsy.queuedInjectScripts.push({
			searchRegex: searchRegex,
			replaceString: replaceString,
		});
	} else {
		console.warn('Ignored duplicate inject');
	}
}

// Ex: before('load_game', function run() { alert('Loading!'); });
//     before('show_text', function run(text) { return text.toUpperCase(); });
//     before('show_text', function run(text, done) { done(text.toUpperCase()); });
function before(targetFuncName, beforeFn) {
	var kitsy = kitsyInit();
	kitsy.queuedBeforeScripts[targetFuncName] = kitsy.queuedBeforeScripts[targetFuncName] || [];
	kitsy.queuedBeforeScripts[targetFuncName].push(beforeFn);
}

function kitsyInit() {
	// return already-initialized kitsy
	if (bitsy.kitsy) {
		return bitsy.kitsy;
	}

	// Initialize kitsy
	bitsy.kitsy = {
		queuedInjectScripts: [],
		queuedBeforeScripts: {},
		queuedAfterScripts: {},
	};

	var oldStartFunc = bitsy.startExportedGame;
	bitsy.startExportedGame = function doAllInjections() {
		// Only do this once.
		bitsy.startExportedGame = oldStartFunc;

		// Rewrite scripts and hook everything up.
		doInjects();
		applyAllHooks();

		// Start the game
		bitsy.startExportedGame.apply(this, arguments);
	};

	return bitsy.kitsy;
}

function doInjects() {
	bitsy.kitsy.queuedInjectScripts.forEach(function (injectScript) {
		inject$1(injectScript.searchRegex, injectScript.replaceString);
	});
	reinitEngine();
}

function applyAllHooks() {
	var allHooks = unique(Object.keys(bitsy.kitsy.queuedBeforeScripts).concat(Object.keys(bitsy.kitsy.queuedAfterScripts)));
	allHooks.forEach(applyHook);
}

function applyHook(functionName) {
	var functionNameSegments = functionName.split('.');
	var obj = bitsy;
	while (functionNameSegments.length > 1) {
		obj = obj[functionNameSegments.shift()];
	}
	var lastSegment = functionNameSegments[0];
	var superFn = obj[lastSegment];
	var superFnLength = superFn ? superFn.length : 0;
	var functions = [];
	// start with befores
	functions = functions.concat(bitsy.kitsy.queuedBeforeScripts[functionName] || []);
	// then original
	if (superFn) {
		functions.push(superFn);
	}
	// then afters
	functions = functions.concat(bitsy.kitsy.queuedAfterScripts[functionName] || []);

	// overwrite original with one which will call each in order
	obj[lastSegment] = function () {
		var returnVal;
		var args = [].slice.call(arguments);
		var i = 0;

		function runBefore() {
			// All outta functions? Finish
			if (i === functions.length) {
				return returnVal;
			}

			// Update args if provided.
			if (arguments.length > 0) {
				args = [].slice.call(arguments);
			}

			if (functions[i].length > superFnLength) {
				// Assume funcs that accept more args than the original are
				// async and accept a callback as an additional argument.
				return functions[i++].apply(this, args.concat(runBefore.bind(this)));
			}
			// run synchronously
			returnVal = functions[i++].apply(this, args);
			if (returnVal && returnVal.length) {
				args = returnVal;
			}
			return runBefore.apply(this, args);
		}

		return runBefore.apply(this, arguments);
	};
}

function reinitEngine() {
	// recreate the script and dialog objects so that they'll be
	// referencing the code with injections instead of the original
	bitsy.scriptModule = new bitsy.Script();
	bitsy.scriptInterpreter = bitsy.scriptModule.CreateInterpreter();

	bitsy.dialogModule = new bitsy.Dialog();
	bitsy.dialogRenderer = bitsy.dialogModule.CreateRenderer();
	bitsy.dialogBuffer = bitsy.dialogModule.CreateBuffer();
}

// Rewrite custom functions' parentheses to curly braces for Bitsy's
// interpreter. Unescape escaped parentheticals, too.
function convertDialogTags(input, tag) {
	return input
		.replace(new RegExp('\\\\?\\((' + tag + '(\\s+(".*?"|.+?))?)\\\\?\\)', 'g'), function (match, group) {
			if (match.substr(0, 1) === '\\') {
				return '(' + group + ')'; // Rewrite \(tag "..."|...\) to (tag "..."|...)
			}
			return '{' + group + '}'; // Rewrite (tag "..."|...) to {tag "..."|...}
		});
}

function addDialogFunction(tag, fn) {
	var kitsy = kitsyInit();
	kitsy.dialogFunctions = kitsy.dialogFunctions || {};
	if (kitsy.dialogFunctions[tag]) {
		console.warn('The dialog function "' + tag + '" already exists.');
		return;
	}

	// Hook into game load and rewrite custom functions in game data to Bitsy format.
	before('parseWorld', function (gameData) {
		return [convertDialogTags(gameData, tag)];
	});

	kitsy.dialogFunctions[tag] = fn;
}

function injectDialogTag(tag, code) {
	inject(
		/(var functionMap = new Map\(\);[^]*?)(this.HasFunction)/m,
		'$1\nfunctionMap.set("' + tag + '", ' + code + ');\n$2',
	);
}

/**
 * Adds a custom dialog tag which executes the provided function.
 * For ease-of-use with the bitsy editor, tags can be written as
 * (tagname "parameters") in addition to the standard {tagname "parameters"}
 *
 * Function is executed immediately when the tag is reached.
 *
 * @param {string}   tag Name of tag
 * @param {Function} fn  Function to execute, with signature `function(environment, parameters, onReturn){}`
 *                       environment: provides access to SetVariable/GetVariable (among other things, see Environment in the bitsy source for more info)
 *                       parameters: array containing parameters as string in first element (i.e. `parameters[0]`)
 *                       onReturn: function to call with return value (just call `onReturn(null);` at the end of your function if your tag doesn't interact with the logic system)
 */
function addDialogTag(tag, fn) {
	addDialogFunction(tag, fn);
	injectDialogTag(tag, 'kitsy.dialogFunctions["' + tag + '"]');
}

/**
 * Helper for printing a paragraph break inside of a dialog function.
 * Adds the function `AddParagraphBreak` to `DialogBuffer`
 */

inject(/(this\.AddLinebreak = )/, 'this.AddParagraphBreak = function() { buffer.push( [[]] ); isActive = true; };\n$1');

/**
📃
@file paragraph-break
@summary Adds paragraph breaks to the dialogue parser
@license WTFPL (do WTF you want)
@version auto
@requires Bitsy Version: 5.0, 5.1
@author Sean S. LeBlanc, David Mowatt

@description
Adds a (p) tag to the dialogue parser that forces the following text to
start on a fresh dialogue screen, eliminating the need to spend hours testing
line lengths or adding multiple line breaks that then have to be reviewed
when you make edits or change the font size.

Note: Bitsy has a built-in implementation of paragraph-break as of 7.0;
before using this, you may want to check if it fulfills your needs.

Usage: (p)

Example: I am a cat(p)and my dialogue contains multitudes

HOW TO USE:
  1. Copy-paste this script into a new script tag after the Bitsy source code.
     It should appear *before* any other mods that handle loading your game
     data so it executes *after* them (last-in first-out).

NOTE: This uses parentheses "()" instead of curly braces "{}" around function
      calls because the Bitsy editor's fancy dialog window strips unrecognized
      curly-brace functions from dialog text. To keep from losing data, write
      these function calls with parentheses like the examples above.

      For full editor integration, you'd *probably* also need to paste this
      code at the end of the editor's `bitsy.js` file. Untested.
*/

// Adds the actual dialogue tag. No deferred version is required.
addDialogTag('p', function (environment, parameters, onReturn) {
	environment.GetDialogBuffer().AddParagraphBreak();
	onReturn(null);
});
// End of (p) paragraph break mod





// override textbox height
inject(/textboxInfo\.height = .+;/,
	`Object.defineProperty(textboxInfo, 'height', {
	get() { return textboxInfo.padding_vert + (textboxInfo.padding_vert + relativeFontHeight()) * Math.max(${hackOptions.minRows}, dialogBuffer.CurPage().indexOf(dialogBuffer.CurRow())+Math.sign(dialogBuffer.CurCharCount())) + textboxInfo.arrow_height; }
})`);
// prevent textbox from caching
inject(/(if\(textboxInfo\.img == null\))/, '// $1');
// rewrite hard-coded row limit
inject(/(else if \(curRowIndex )== 0/g, '$1< ' + hackOptions.maxRows + ' - 1');
inject(/(if \(lastPage\.length) <= 1/, '$1 < ' + hackOptions.maxRows);

exports.hackOptions = hackOptions;

Object.defineProperty(exports, '__esModule', { value: true });

}(this.hacks.long_dialog = this.hacks.long_dialog || {}, window));

/**
⏳
@file permanent items
@summary prevent some items from being picked up
@license MIT
@version 15.4.3
@requires 7.0
@author Sean S. LeBlanc

@description
Prevents certain items from being picked up, but allows them to be walked over and triggers their dialog.

HOW TO USE:
1. Copy-paste this script into a script tag after the bitsy source
2. Update the `itemIsPermanent` function below to match your needs
*/
this.hacks = this.hacks || {};
(function (exports, bitsy) {
'use strict';
var hackOptions =  {
itemIsPermanent: function (item) {
  // specific permanent item
  //return item.name == 'tea';

  // specific permanent item list
  return ['zoom1e', 'zoom1f', 'zoom6e', 'zoom5c', 'zoom5f'].indexOf(item.name) !== -1;

  // permanent item flag in name
  return item.name.indexOf('PERMANENT') !== -1;
  
  // all items are permanent
  //return true;
}
} ;

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

bitsy = bitsy || /*#__PURE__*/_interopDefaultLegacy(bitsy);

/**
@file utils
@summary miscellaneous bitsy utilities
@author Sean S. LeBlanc
*/

/*
Helper used to replace code in a script tag based on a search regex
To inject code without erasing original string, using capturing groups; e.g.
	inject(/(some string)/,'injected before $1 injected after')
*/
function inject(searchRegex, replaceString) {
	// find the relevant script tag
	var scriptTags = document.getElementsByTagName('script');
	var scriptTag;
	var code;
	for (var i = 0; i < scriptTags.length; ++i) {
		scriptTag = scriptTags[i];
		var matchesSearch = scriptTag.textContent.search(searchRegex) !== -1;
		var isCurrentScript = scriptTag === document.currentScript;
		if (matchesSearch && !isCurrentScript) {
			code = scriptTag.textContent;
			break;
		}
	}

	// error-handling
	if (!code) {
		throw new Error('Couldn\'t find "' + searchRegex + '" in script tags');
	}

	// modify the content
	code = code.replace(searchRegex, replaceString);

	// replace the old script tag with a new one using our modified code
	var newScriptTag = document.createElement('script');
	newScriptTag.textContent = code;
	scriptTag.insertAdjacentElement('afterend', newScriptTag);
	scriptTag.remove();
}

/**
 * Helper for getting an array with unique elements
 * @param  {Array} array Original array
 * @return {Array}       Copy of array, excluding duplicates
 */
function unique(array) {
	return array.filter(function (item, idx) {
		return array.indexOf(item) === idx;
	});
}

/**

@file kitsy-script-toolkit
@summary makes it easier and cleaner to run code before and after Bitsy functions or to inject new code into Bitsy script tags
@license WTFPL (do WTF you want)
@requires Bitsy Version: 4.5, 4.6
@author @mildmojo

@description
HOW TO USE:
  import {before, after, inject, addDialogTag, addDeferredDialogTag} from "./helpers/kitsy-script-toolkit";

  before(targetFuncName, beforeFn);
  after(targetFuncName, afterFn);
  inject(searchRegex, replaceString);
  addDialogTag(tagName, dialogFn);
  addDeferredDialogTag(tagName, dialogFn);

  For more info, see the documentation at:
  https://github.com/seleb/bitsy-hacks/wiki/Coding-with-kitsy
*/

// Ex: before('load_game', function run() { alert('Loading!'); });
//     before('show_text', function run(text) { return text.toUpperCase(); });
//     before('show_text', function run(text, done) { done(text.toUpperCase()); });
function before(targetFuncName, beforeFn) {
	var kitsy = kitsyInit();
	kitsy.queuedBeforeScripts[targetFuncName] = kitsy.queuedBeforeScripts[targetFuncName] || [];
	kitsy.queuedBeforeScripts[targetFuncName].push(beforeFn);
}

function kitsyInit() {
	// return already-initialized kitsy
	if (bitsy.kitsy) {
		return bitsy.kitsy;
	}

	// Initialize kitsy
	bitsy.kitsy = {
		queuedInjectScripts: [],
		queuedBeforeScripts: {},
		queuedAfterScripts: {},
	};

	var oldStartFunc = bitsy.startExportedGame;
	bitsy.startExportedGame = function doAllInjections() {
		// Only do this once.
		bitsy.startExportedGame = oldStartFunc;

		// Rewrite scripts and hook everything up.
		doInjects();
		applyAllHooks();

		// Start the game
		bitsy.startExportedGame.apply(this, arguments);
	};

	return bitsy.kitsy;
}

function doInjects() {
	bitsy.kitsy.queuedInjectScripts.forEach(function (injectScript) {
		inject(injectScript.searchRegex, injectScript.replaceString);
	});
	reinitEngine();
}

function applyAllHooks() {
	var allHooks = unique(Object.keys(bitsy.kitsy.queuedBeforeScripts).concat(Object.keys(bitsy.kitsy.queuedAfterScripts)));
	allHooks.forEach(applyHook);
}

function applyHook(functionName) {
	var functionNameSegments = functionName.split('.');
	var obj = bitsy;
	while (functionNameSegments.length > 1) {
		obj = obj[functionNameSegments.shift()];
	}
	var lastSegment = functionNameSegments[0];
	var superFn = obj[lastSegment];
	var superFnLength = superFn ? superFn.length : 0;
	var functions = [];
	// start with befores
	functions = functions.concat(bitsy.kitsy.queuedBeforeScripts[functionName] || []);
	// then original
	if (superFn) {
		functions.push(superFn);
	}
	// then afters
	functions = functions.concat(bitsy.kitsy.queuedAfterScripts[functionName] || []);

	// overwrite original with one which will call each in order
	obj[lastSegment] = function () {
		var returnVal;
		var args = [].slice.call(arguments);
		var i = 0;

		function runBefore() {
			// All outta functions? Finish
			if (i === functions.length) {
				return returnVal;
			}

			// Update args if provided.
			if (arguments.length > 0) {
				args = [].slice.call(arguments);
			}

			if (functions[i].length > superFnLength) {
				// Assume funcs that accept more args than the original are
				// async and accept a callback as an additional argument.
				return functions[i++].apply(this, args.concat(runBefore.bind(this)));
			}
			// run synchronously
			returnVal = functions[i++].apply(this, args);
			if (returnVal && returnVal.length) {
				args = returnVal;
			}
			return runBefore.apply(this, args);
		}

		return runBefore.apply(this, arguments);
	};
}

function reinitEngine() {
	// recreate the script and dialog objects so that they'll be
	// referencing the code with injections instead of the original
	bitsy.scriptModule = new bitsy.Script();
	bitsy.scriptInterpreter = bitsy.scriptModule.CreateInterpreter();

	bitsy.dialogModule = new bitsy.Dialog();
	bitsy.dialogRenderer = bitsy.dialogModule.CreateRenderer();
	bitsy.dialogBuffer = bitsy.dialogModule.CreateBuffer();
}





var room;
var oldItems;
before('movePlayer', function () {
	room = bitsy.room[bitsy.curRoom];
	oldItems = room.items.slice();
});
before('startItemDialog', function (itemId, dialogCallback) {
	// something changed
	if (!hackOptions.itemIsPermanent(bitsy.item[itemId])) {
		return undefined;
	}
	room = bitsy.room[bitsy.curRoom];
	oldItems = room.items.slice();
	return [itemId, function () {
		var newItems = room.items;
		if (newItems.length === oldItems.length) {
			return; // nothing changed
		}

		// check for changes
		for (var i = 0; i < oldItems.length; ++i) {
			if (!newItems[i]
				|| oldItems[i].x !== newItems[i].x
				|| oldItems[i].y !== newItems[i].y
				|| oldItems[i].id !== newItems[i].id
			) {
				// something changed
				if (hackOptions.itemIsPermanent(bitsy.item[oldItems[i].id])) {
					// put that back!
					newItems.splice(i, 0, oldItems[i]);
				} else {
					// add an empty entry for now to keep the arrays aligned
					newItems.splice(i, 0, null);
				}
			}
		}
		// clear out those empty entries
		room.items = newItems.filter(function (item) {
			return !!item;
		});

		// run the actual callback
		if (dialogCallback) {
			dialogCallback();
		}
	}];
});

exports.hackOptions = hackOptions;

Object.defineProperty(exports, '__esModule', { value: true });

}(this.hacks.permanent_items = this.hacks.permanent_items || {}, window));

/**
👥
@file avatar by room
@summary change the avatar in certain rooms
@license MIT
@version 15.4.3
@requires 5.3
@author Sean S. LeBlanc

@description
Simple hack for changing avatar to another sprite as you move between rooms.

HOW TO USE:
1. Copy-paste into a script tag after the bitsy source
2. Edit hackOptions below to set up the avatar list for rooms you move through.

By default, the avatar will reset to the default if you enter a room without a sprite defined.
This can also be changed in the hackOptions below to instead apply avatar changes permanently.
*/
this.hacks = this.hacks || {};
(function (exports, bitsy) {
'use strict';
var hackOptions =  {
permanent: false, // If true, avatar changes will persist across rooms without sprites defined
  // You need to put an entry in this list for every room ID or name that you want to change the avatar,
  // and then specify the sprite ID or name of what to change to. Expand this list to as many rooms as you need.
  
avatarByRoom: {
  'titlescreen': 'transparent',
  'zoom': 'avatarcursor',
  'surveyyes': 'avatarcursor',
  'surveyno': 'avatarcursor',
  'space': 'transparent',
  'space1': 'transparent',
  'space2': 'transparent',
  'space3': 'transparent',
  'space4': 'transparent',
  'space5': 'transparent',
  'space6': 'transparent',
  'space7': 'transparent',
  'space8': 'transparent',
  'space9': 'transparent',
  'space10': 'transparent',
  'space11': 'transparent',
  'space12': 'transparent',
  'space13': 'transparent',
  'space14': 'transparent',
  'space15': 'transparent',
  'space16': 'transparent',
  'space17': 'transparent',
  'chords': 'uke',
  'penultimate': 'transparent',
  'outro': 'transparent'
},
} ;

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

bitsy = bitsy || /*#__PURE__*/_interopDefaultLegacy(bitsy);

/**
@file utils
@summary miscellaneous bitsy utilities
@author Sean S. LeBlanc
*/

/*
Helper used to replace code in a script tag based on a search regex
To inject code without erasing original string, using capturing groups; e.g.
	inject(/(some string)/,'injected before $1 injected after')
*/
function inject(searchRegex, replaceString) {
	// find the relevant script tag
	var scriptTags = document.getElementsByTagName('script');
	var scriptTag;
	var code;
	for (var i = 0; i < scriptTags.length; ++i) {
		scriptTag = scriptTags[i];
		var matchesSearch = scriptTag.textContent.search(searchRegex) !== -1;
		var isCurrentScript = scriptTag === document.currentScript;
		if (matchesSearch && !isCurrentScript) {
			code = scriptTag.textContent;
			break;
		}
	}

	// error-handling
	if (!code) {
		throw new Error('Couldn\'t find "' + searchRegex + '" in script tags');
	}

	// modify the content
	code = code.replace(searchRegex, replaceString);

	// replace the old script tag with a new one using our modified code
	var newScriptTag = document.createElement('script');
	newScriptTag.textContent = code;
	scriptTag.insertAdjacentElement('afterend', newScriptTag);
	scriptTag.remove();
}

/*
Helper for getting image by name or id

Args:
	name: id or name of image to return
	 map: map of images (e.g. `sprite`, `tile`, `item`)

Returns: the image in the given map with the given name/id
 */
function getImage(name, map) {
	var id = Object.prototype.hasOwnProperty.call(map, name) ? name : Object.keys(map).find(function (e) {
		return map[e].name === name;
	});
	return map[id];
}

/**
 * Helper for getting room by name or id
 * @param {string} name id or name of room to return
 * @return {string} room, or undefined if it doesn't exist
 */
function getRoom(name) {
	var id = Object.prototype.hasOwnProperty.call(bitsy.room, name) ? name : bitsy.names.room.get(name);
	return bitsy.room[id];
}

/**
 * Helper for getting an array with unique elements
 * @param  {Array} array Original array
 * @return {Array}       Copy of array, excluding duplicates
 */
function unique(array) {
	return array.filter(function (item, idx) {
		return array.indexOf(item) === idx;
	});
}

/**

@file kitsy-script-toolkit
@summary makes it easier and cleaner to run code before and after Bitsy functions or to inject new code into Bitsy script tags
@license WTFPL (do WTF you want)
@requires Bitsy Version: 4.5, 4.6
@author @mildmojo

@description
HOW TO USE:
  import {before, after, inject, addDialogTag, addDeferredDialogTag} from "./helpers/kitsy-script-toolkit";

  before(targetFuncName, beforeFn);
  after(targetFuncName, afterFn);
  inject(searchRegex, replaceString);
  addDialogTag(tagName, dialogFn);
  addDeferredDialogTag(tagName, dialogFn);

  For more info, see the documentation at:
  https://github.com/seleb/bitsy-hacks/wiki/Coding-with-kitsy
*/

// Ex: before('load_game', function run() { alert('Loading!'); });
//     before('show_text', function run(text) { return text.toUpperCase(); });
//     before('show_text', function run(text, done) { done(text.toUpperCase()); });
function before(targetFuncName, beforeFn) {
	var kitsy = kitsyInit();
	kitsy.queuedBeforeScripts[targetFuncName] = kitsy.queuedBeforeScripts[targetFuncName] || [];
	kitsy.queuedBeforeScripts[targetFuncName].push(beforeFn);
}

// Ex: after('load_game', function run() { alert('Loaded!'); });
function after(targetFuncName, afterFn) {
	var kitsy = kitsyInit();
	kitsy.queuedAfterScripts[targetFuncName] = kitsy.queuedAfterScripts[targetFuncName] || [];
	kitsy.queuedAfterScripts[targetFuncName].push(afterFn);
}

function kitsyInit() {
	// return already-initialized kitsy
	if (bitsy.kitsy) {
		return bitsy.kitsy;
	}

	// Initialize kitsy
	bitsy.kitsy = {
		queuedInjectScripts: [],
		queuedBeforeScripts: {},
		queuedAfterScripts: {},
	};

	var oldStartFunc = bitsy.startExportedGame;
	bitsy.startExportedGame = function doAllInjections() {
		// Only do this once.
		bitsy.startExportedGame = oldStartFunc;

		// Rewrite scripts and hook everything up.
		doInjects();
		applyAllHooks();

		// Start the game
		bitsy.startExportedGame.apply(this, arguments);
	};

	return bitsy.kitsy;
}

function doInjects() {
	bitsy.kitsy.queuedInjectScripts.forEach(function (injectScript) {
		inject(injectScript.searchRegex, injectScript.replaceString);
	});
	reinitEngine();
}

function applyAllHooks() {
	var allHooks = unique(Object.keys(bitsy.kitsy.queuedBeforeScripts).concat(Object.keys(bitsy.kitsy.queuedAfterScripts)));
	allHooks.forEach(applyHook);
}

function applyHook(functionName) {
	var functionNameSegments = functionName.split('.');
	var obj = bitsy;
	while (functionNameSegments.length > 1) {
		obj = obj[functionNameSegments.shift()];
	}
	var lastSegment = functionNameSegments[0];
	var superFn = obj[lastSegment];
	var superFnLength = superFn ? superFn.length : 0;
	var functions = [];
	// start with befores
	functions = functions.concat(bitsy.kitsy.queuedBeforeScripts[functionName] || []);
	// then original
	if (superFn) {
		functions.push(superFn);
	}
	// then afters
	functions = functions.concat(bitsy.kitsy.queuedAfterScripts[functionName] || []);

	// overwrite original with one which will call each in order
	obj[lastSegment] = function () {
		var returnVal;
		var args = [].slice.call(arguments);
		var i = 0;

		function runBefore() {
			// All outta functions? Finish
			if (i === functions.length) {
				return returnVal;
			}

			// Update args if provided.
			if (arguments.length > 0) {
				args = [].slice.call(arguments);
			}

			if (functions[i].length > superFnLength) {
				// Assume funcs that accept more args than the original are
				// async and accept a callback as an additional argument.
				return functions[i++].apply(this, args.concat(runBefore.bind(this)));
			}
			// run synchronously
			returnVal = functions[i++].apply(this, args);
			if (returnVal && returnVal.length) {
				args = returnVal;
			}
			return runBefore.apply(this, args);
		}

		return runBefore.apply(this, arguments);
	};
}

function reinitEngine() {
	// recreate the script and dialog objects so that they'll be
	// referencing the code with injections instead of the original
	bitsy.scriptModule = new bitsy.Script();
	bitsy.scriptInterpreter = bitsy.scriptModule.CreateInterpreter();

	bitsy.dialogModule = new bitsy.Dialog();
	bitsy.dialogRenderer = bitsy.dialogModule.CreateRenderer();
	bitsy.dialogBuffer = bitsy.dialogModule.CreateBuffer();
}





// expand the map to include ids of rooms listed by name
// and store the original player sprite
var originalDrw;
var originalAnimation;
after('load_game', function () {
	var room;
	Object.keys(hackOptions.avatarByRoom).forEach(function (i) {
		room = getRoom(i);
		if (room) {
			hackOptions.avatarByRoom[room.id] = hackOptions.avatarByRoom[i];
		}
	});
	originalDrw = bitsy.player().drw;
	originalAnimation = bitsy.player().animation;
});

var currentRoom;
before('drawRoom', function () {
	var player = bitsy.player();
	if (bitsy.player().room === currentRoom) {
		return;
	}
	currentRoom = player.room;
	var newAvatarId = hackOptions.avatarByRoom[currentRoom];
	if (
		(!newAvatarId && !hackOptions.permanent) // if no sprite defined + not permanent, reset
		|| (newAvatarId === player.id) // manual reset
	) {
		player.drw = originalDrw;
		player.animation = originalAnimation;
		return;
	}
	var newAvatar = getImage(newAvatarId, bitsy.sprite);
	if (!newAvatar) {
		throw new Error('Could not find sprite "' + newAvatarId + '" for room "' + currentRoom + '"');
	}
	player.drw = newAvatar.drw;
	player.animation = Object.assign({}, newAvatar.animation);
});

exports.hackOptions = hackOptions;

Object.defineProperty(exports, '__esModule', { value: true });

}(this.hacks.avatar_by_room = this.hacks.avatar_by_room || {}, window));

/**
😌
@file bitsymuse
@summary A variety of Bitsy sound and music handlers
@license MIT
@version 15.4.3
@requires 4.8, 4.9
@author David Mowatt

@description
A hack that adds a variety of audio controls, including music that changes as you move between rooms.
If the same song is played as you move between rooms, the audio file will continue playing.

Check out https://kool.tools/bitsy/tools/bitsymuse-ui for a tool to help configure this hack

HOW TO USE:
1. Place your audio files somewhere relative to your bitsy html file (in the zip if you're uploading to itch.io)
2. Copy-paste this script into a script tag after the bitsy source.
3. Edit hackOptions below to set up the track list for rooms you move through.

In addition to the track list, which will play audio based on the room id/name,
you have access to the following commands you can add to dialogue:

1. (soundeffectNow "<audio ID>") will play a sound without interrupting the music as soon as it is called in the dialogue
2. (soundeffect "<audio ID>") will play a sound without interrupting the music once the dialogue box closes
3. (musicNow "<audio ID>") will change the music as soon as it is called in the dialogue
4. (music "<audio ID>") will change the music once the dialogue box closes

You can call both musicNow and music in the same dialogue, to e.g. change the music while you speak to a character
and then restart the regular room music once you stop speaking to them.
You can also use a special ID ("S" by default) to Silence the music.

By default, music tracks automatically restart from the beginning if you go back to a previous track.
This can also be changed in the hackOptions below.
*/
this.hacks = this.hacks || {};
(function (exports, bitsy) {
'use strict';
var hackOptions =  {
// Put entries in this list for each audio file you want to use.
// The key will be the id needed to play it in dialog tags and 
// the musicByRoom options below, and the value will be the 
// properties of the corresponding <audio> tag (e.g. src, loop, volume)
// Note: you can add <audio> tags to the html manually if you prefer

audio: {
	// Note: the entries below are examples that should be removed and replaced with your own audio files
	'main': { src: './pathways-desire-lines.mp3', loop: true },
	'amin': { src: './amin.mp3', volume: 0.5 },
        'c': { src: './c.mp3', volume: 0.5 },
        'f': { src: './f.mp3', volume: 0.5 },
        'g': { src: './g.mp3', volume: 0.5 },
},
	
// Put entries in this list for every room ID or name that will 
// change the music. If the player moves between rooms with the 
// same audio ID, the music keeps playing seamlessly.

// Undefined rooms will keep playing whatever music they were last playing.

musicByRoom: {
	// Note: the entries below are examples that should be removed and replaced with your own room -> audio id mappings
	'titlescreen': 'S',
	'myflat 0': 'main',
	'newsflash': 'S',
        'zoom': 'main',
        'chords': 'S',
},

silenceId: 'S', // Use this song ID to make a room fall silent.
resume: false, // If true, songs will pause/resume on change; otherwise, they'll stop/play (doesn't affect sound effect
} ;

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

bitsy = bitsy || /*#__PURE__*/_interopDefaultLegacy(bitsy);

/**
@file utils
@summary miscellaneous bitsy utilities
@author Sean S. LeBlanc
*/

/*
Helper used to replace code in a script tag based on a search regex
To inject code without erasing original string, using capturing groups; e.g.
	inject(/(some string)/,'injected before $1 injected after')
*/
function inject$1(searchRegex, replaceString) {
	// find the relevant script tag
	var scriptTags = document.getElementsByTagName('script');
	var scriptTag;
	var code;
	for (var i = 0; i < scriptTags.length; ++i) {
		scriptTag = scriptTags[i];
		var matchesSearch = scriptTag.textContent.search(searchRegex) !== -1;
		var isCurrentScript = scriptTag === document.currentScript;
		if (matchesSearch && !isCurrentScript) {
			code = scriptTag.textContent;
			break;
		}
	}

	// error-handling
	if (!code) {
		throw new Error('Couldn\'t find "' + searchRegex + '" in script tags');
	}

	// modify the content
	code = code.replace(searchRegex, replaceString);

	// replace the old script tag with a new one using our modified code
	var newScriptTag = document.createElement('script');
	newScriptTag.textContent = code;
	scriptTag.insertAdjacentElement('afterend', newScriptTag);
	scriptTag.remove();
}

/**
 * Helper for getting room by name or id
 * @param {string} name id or name of room to return
 * @return {string} room, or undefined if it doesn't exist
 */
function getRoom(name) {
	var id = Object.prototype.hasOwnProperty.call(bitsy.room, name) ? name : bitsy.names.room.get(name);
	return bitsy.room[id];
}

/**
 * Helper for getting an array with unique elements
 * @param  {Array} array Original array
 * @return {Array}       Copy of array, excluding duplicates
 */
function unique(array) {
	return array.filter(function (item, idx) {
		return array.indexOf(item) === idx;
	});
}

/**

@file kitsy-script-toolkit
@summary makes it easier and cleaner to run code before and after Bitsy functions or to inject new code into Bitsy script tags
@license WTFPL (do WTF you want)
@requires Bitsy Version: 4.5, 4.6
@author @mildmojo

@description
HOW TO USE:
  import {before, after, inject, addDialogTag, addDeferredDialogTag} from "./helpers/kitsy-script-toolkit";

  before(targetFuncName, beforeFn);
  after(targetFuncName, afterFn);
  inject(searchRegex, replaceString);
  addDialogTag(tagName, dialogFn);
  addDeferredDialogTag(tagName, dialogFn);

  For more info, see the documentation at:
  https://github.com/seleb/bitsy-hacks/wiki/Coding-with-kitsy
*/

// Ex: inject(/(names.sprite.set\( name, id \);)/, '$1console.dir(names)');
function inject(searchRegex, replaceString) {
	var kitsy = kitsyInit();
	if (
		!kitsy.queuedInjectScripts.some(function (script) {
			return searchRegex.toString() === script.searchRegex.toString() && replaceString === script.replaceString;
		})
	) {
		kitsy.queuedInjectScripts.push({
			searchRegex: searchRegex,
			replaceString: replaceString,
		});
	} else {
		console.warn('Ignored duplicate inject');
	}
}

// Ex: before('load_game', function run() { alert('Loading!'); });
//     before('show_text', function run(text) { return text.toUpperCase(); });
//     before('show_text', function run(text, done) { done(text.toUpperCase()); });
function before(targetFuncName, beforeFn) {
	var kitsy = kitsyInit();
	kitsy.queuedBeforeScripts[targetFuncName] = kitsy.queuedBeforeScripts[targetFuncName] || [];
	kitsy.queuedBeforeScripts[targetFuncName].push(beforeFn);
}

// Ex: after('load_game', function run() { alert('Loaded!'); });
function after(targetFuncName, afterFn) {
	var kitsy = kitsyInit();
	kitsy.queuedAfterScripts[targetFuncName] = kitsy.queuedAfterScripts[targetFuncName] || [];
	kitsy.queuedAfterScripts[targetFuncName].push(afterFn);
}

function kitsyInit() {
	// return already-initialized kitsy
	if (bitsy.kitsy) {
		return bitsy.kitsy;
	}

	// Initialize kitsy
	bitsy.kitsy = {
		queuedInjectScripts: [],
		queuedBeforeScripts: {},
		queuedAfterScripts: {},
	};

	var oldStartFunc = bitsy.startExportedGame;
	bitsy.startExportedGame = function doAllInjections() {
		// Only do this once.
		bitsy.startExportedGame = oldStartFunc;

		// Rewrite scripts and hook everything up.
		doInjects();
		applyAllHooks();

		// Start the game
		bitsy.startExportedGame.apply(this, arguments);
	};

	return bitsy.kitsy;
}

function doInjects() {
	bitsy.kitsy.queuedInjectScripts.forEach(function (injectScript) {
		inject$1(injectScript.searchRegex, injectScript.replaceString);
	});
	reinitEngine();
}

function applyAllHooks() {
	var allHooks = unique(Object.keys(bitsy.kitsy.queuedBeforeScripts).concat(Object.keys(bitsy.kitsy.queuedAfterScripts)));
	allHooks.forEach(applyHook);
}

function applyHook(functionName) {
	var functionNameSegments = functionName.split('.');
	var obj = bitsy;
	while (functionNameSegments.length > 1) {
		obj = obj[functionNameSegments.shift()];
	}
	var lastSegment = functionNameSegments[0];
	var superFn = obj[lastSegment];
	var superFnLength = superFn ? superFn.length : 0;
	var functions = [];
	// start with befores
	functions = functions.concat(bitsy.kitsy.queuedBeforeScripts[functionName] || []);
	// then original
	if (superFn) {
		functions.push(superFn);
	}
	// then afters
	functions = functions.concat(bitsy.kitsy.queuedAfterScripts[functionName] || []);

	// overwrite original with one which will call each in order
	obj[lastSegment] = function () {
		var returnVal;
		var args = [].slice.call(arguments);
		var i = 0;

		function runBefore() {
			// All outta functions? Finish
			if (i === functions.length) {
				return returnVal;
			}

			// Update args if provided.
			if (arguments.length > 0) {
				args = [].slice.call(arguments);
			}

			if (functions[i].length > superFnLength) {
				// Assume funcs that accept more args than the original are
				// async and accept a callback as an additional argument.
				return functions[i++].apply(this, args.concat(runBefore.bind(this)));
			}
			// run synchronously
			returnVal = functions[i++].apply(this, args);
			if (returnVal && returnVal.length) {
				args = returnVal;
			}
			return runBefore.apply(this, args);
		}

		return runBefore.apply(this, arguments);
	};
}

function reinitEngine() {
	// recreate the script and dialog objects so that they'll be
	// referencing the code with injections instead of the original
	bitsy.scriptModule = new bitsy.Script();
	bitsy.scriptInterpreter = bitsy.scriptModule.CreateInterpreter();

	bitsy.dialogModule = new bitsy.Dialog();
	bitsy.dialogRenderer = bitsy.dialogModule.CreateRenderer();
	bitsy.dialogBuffer = bitsy.dialogModule.CreateBuffer();
}

// Rewrite custom functions' parentheses to curly braces for Bitsy's
// interpreter. Unescape escaped parentheticals, too.
function convertDialogTags(input, tag) {
	return input
		.replace(new RegExp('\\\\?\\((' + tag + '(\\s+(".*?"|.+?))?)\\\\?\\)', 'g'), function (match, group) {
			if (match.substr(0, 1) === '\\') {
				return '(' + group + ')'; // Rewrite \(tag "..."|...\) to (tag "..."|...)
			}
			return '{' + group + '}'; // Rewrite (tag "..."|...) to {tag "..."|...}
		});
}

function addDialogFunction(tag, fn) {
	var kitsy = kitsyInit();
	kitsy.dialogFunctions = kitsy.dialogFunctions || {};
	if (kitsy.dialogFunctions[tag]) {
		console.warn('The dialog function "' + tag + '" already exists.');
		return;
	}

	// Hook into game load and rewrite custom functions in game data to Bitsy format.
	before('parseWorld', function (gameData) {
		return [convertDialogTags(gameData, tag)];
	});

	kitsy.dialogFunctions[tag] = fn;
}

function injectDialogTag(tag, code) {
	inject(
		/(var functionMap = new Map\(\);[^]*?)(this.HasFunction)/m,
		'$1\nfunctionMap.set("' + tag + '", ' + code + ');\n$2',
	);
}

/**
 * Adds a custom dialog tag which executes the provided function.
 * For ease-of-use with the bitsy editor, tags can be written as
 * (tagname "parameters") in addition to the standard {tagname "parameters"}
 *
 * Function is executed immediately when the tag is reached.
 *
 * @param {string}   tag Name of tag
 * @param {Function} fn  Function to execute, with signature `function(environment, parameters, onReturn){}`
 *                       environment: provides access to SetVariable/GetVariable (among other things, see Environment in the bitsy source for more info)
 *                       parameters: array containing parameters as string in first element (i.e. `parameters[0]`)
 *                       onReturn: function to call with return value (just call `onReturn(null);` at the end of your function if your tag doesn't interact with the logic system)
 */
function addDialogTag(tag, fn) {
	addDialogFunction(tag, fn);
	injectDialogTag(tag, 'kitsy.dialogFunctions["' + tag + '"]');
}

/**
 * Adds a custom dialog tag which executes the provided function.
 * For ease-of-use with the bitsy editor, tags can be written as
 * (tagname "parameters") in addition to the standard {tagname "parameters"}
 *
 * Function is executed after the dialog box.
 *
 * @param {string}   tag Name of tag
 * @param {Function} fn  Function to execute, with signature `function(environment, parameters){}`
 *                       environment: provides access to SetVariable/GetVariable (among other things, see Environment in the bitsy source for more info)
 *                       parameters: array containing parameters as string in first element (i.e. `parameters[0]`)
 */
function addDeferredDialogTag(tag, fn) {
	addDialogFunction(tag, fn);
	bitsy.kitsy.deferredDialogFunctions = bitsy.kitsy.deferredDialogFunctions || {};
	var deferred = bitsy.kitsy.deferredDialogFunctions[tag] = [];
	injectDialogTag(tag, 'function(e, p, o){ kitsy.deferredDialogFunctions["' + tag + '"].push({e:e,p:p}); o(null); }');
	// Hook into the dialog finish event and execute the actual function
	after('onExitDialog', function () {
		while (deferred.length) {
			var args = deferred.shift();
			bitsy.kitsy.dialogFunctions[tag](args.e, args.p, args.o);
		}
	});
	// Hook into the game reset and make sure data gets cleared
	after('clearGameData', function () {
		deferred.length = 0;
	});
}

/**
 * Adds two custom dialog tags which execute the provided function,
 * one with the provided tagname executed after the dialog box,
 * and one suffixed with 'Now' executed immediately when the tag is reached.
 *
 * i.e. helper for the (exit)/(exitNow) pattern.
 *
 * @param {string}   tag Name of tag
 * @param {Function} fn  Function to execute, with signature `function(environment, parameters){}`
 *                       environment: provides access to SetVariable/GetVariable (among other things, see Environment in the bitsy source for more info)
 *                       parameters: array containing parameters as string in first element (i.e. `parameters[0]`)
 */
function addDualDialogTag(tag, fn) {
	addDialogTag(tag + 'Now', function (environment, parameters, onReturn) {
		fn(environment, parameters);
		onReturn(null);
	});
	addDeferredDialogTag(tag, fn);
}





var audioElementsById = {};
var currentMusic;
var roomMusicFlag = null;

// cleanup old audio tags if any are present (e.g. on restart)
before('load_game', function () {
	Object.entries(hackOptions.audio).forEach(function (entry) {
		var el = document.getElementById(entry[0]);
		if (el) {
			el.remove();
		}
		delete audioElementsById[entry[0]];
	});
});

after('load_game', function () {
	var room;
	// expand the map to include ids of rooms listed by name
	Object.entries(hackOptions.musicByRoom).forEach(function (entry) {
		room = getRoom(entry[0]);
		if (room) {
			hackOptions.musicByRoom[room.id] = entry[1];
		}
	});
	// add audio tags from options
	Object.entries(hackOptions.audio).forEach(function (entry) {
		var el = document.createElement('audio');
		var src = entry[1].src;
		el.id = entry[0];
		Object.assign(el, entry[1]);
		if (typeof src !== 'string') {
			el.src = null;
			src.forEach(function (s) {
				var sourceEl = document.createElement('source');
				sourceEl.src = s;
				sourceEl.type = 'audio/' + s.split('.').pop();
				el.appendChild(sourceEl);
			});
		}
		document.body.appendChild(el);
		audioElementsById[el.id] = el;
	});

	// handle autoplay restrictions by playing then pausing
	// every audio element on the first user interaction
	function handleAutoPlayRestrictions() {
		Object.values(audioElementsById).forEach(function (audio) {
			audio.play();
			// let the current song play
			if (currentMusic === audio.id) {
				return;
			}
			audio.pause();
			audio.currentTime = 0;
		});
		document.body.removeEventListener('pointerup', handleAutoPlayRestrictions);
		document.body.removeEventListener('keydown', handleAutoPlayRestrictions);
	}

	document.body.addEventListener('pointerup', handleAutoPlayRestrictions);
	document.body.addEventListener('keydown', handleAutoPlayRestrictions);
});

function getAudio(id) {
	var el = audioElementsById[id] || (audioElementsById[id] = document.getElementById(id));
	if (!el) {
		throw new Error("bitsymuse tried to use audio with id '" + id + "' but couldn't find one on the page!");
	}
	return el;
}

function playSound(soundParam) {
	if (!soundParam) {
		return;
	}
	getAudio(soundParam).play();
}

function changeMusic(newMusic) {
	var audio;
	// if we didn't get new music,
	// or the music didn't change,
	// there's no work to be done
	if (!newMusic || newMusic === currentMusic) {
		return;
	}

	// stop old music
	if (currentMusic && currentMusic !== hackOptions.silenceId) {
		audio = getAudio(currentMusic);
		audio.pause();
		if (!hackOptions.resume) {
			audio.currentTime = 0.0;
		}
	}

	// start new music
	currentMusic = newMusic;
	// special case: don't start anything new
	if (newMusic === hackOptions.silenceId) {
		return;
	}
	getAudio(newMusic).play();
}

after('drawRoom', function () {
	if (roomMusicFlag !== bitsy.curRoom) {
		changeMusic(hackOptions.musicByRoom[bitsy.curRoom]);
		roomMusicFlag = bitsy.curRoom;
	}
});

// Implement the dialog functions
addDualDialogTag('music', function (environment, parameters) {
	if (!parameters[0]) {
		throw new Error('{music/musicNow} was missing parameters! Usage: {music/musicNow "track name"}');
	}
	changeMusic(parameters[0]);
});

addDualDialogTag('soundeffect', function (environment, parameters) {
	if (!parameters[0]) {
		throw new Error('{soundeffect/soundeffectNow} was missing parameters! Usage: {soundeffect/soundeffectNow "track name"}');
	}
	playSound(parameters[0]);
});
// End of (music) dialog function mod

exports.hackOptions = hackOptions;

Object.defineProperty(exports, '__esModule', { value: true });

}(this.hacks.bitsymuse = this.hacks.bitsymuse || {}, window));

/**
🖌
@file edit image from dialog
@summary edit sprites, items, and tiles from dialog
@license MIT
@version 15.4.3
@requires 5.3
@author Sean S. LeBlanc

@description
You can use this to edit the image data of sprites (including the player avatar), items, and tiles through dialog.
Image data can be replaced with data from another image, and the palette index can be set.

(image "map, target, source")
Parameters:
  map:    Type of image (SPR, TIL, or ITM)
  target: id/name of image to edit
  source: id/name of image to copy

(imageNow "map, target, source")
Same as (image), but applied immediately instead of after dialog is closed.

(imagePal "map, target, palette")
Parameters:
  map:    Type of image (SPR, TIL, or ITM)
  target: id/name of image to edit
  source: palette index (0 is bg, 1 is tiles, 2 is sprites/items, anything higher requires editing your game data to include more)

(imagePalNow "map, target, palette")
Same as (imagePal), but applied immediately instead of after dialog is closed.

Examples:
  (image "SPR, A, a")
  (imageNow "TIL, a, floor")
  (image "ITM, a, b")
  (imagePal "SPR, A, 1")
  (imagePalNow "TIL, floor, 2")

HOW TO USE:
  1. Copy-paste this script into a new script tag after the Bitsy source code.
     It should appear *before* any other mods that handle loading your game
     data so it executes *after* them (last-in first-out).

TIPS:
  - The player avatar is always a sprite with id "A"; you can edit your gamedata to give them a name for clarity
  - You can use the full names or shorthand of image types (e.g. "SPR" and "sprite" will both work)
  - The "source" images don't have to be placed anywhere; so long as they exist in the gamedata they'll work
  - This is a destructive operation! Unless you have a copy of an overwritten image, you won't be able to get it back during that run

NOTE: This uses parentheses "()" instead of curly braces "{}" around function
      calls because the Bitsy editor's fancy dialog window strips unrecognized
      curly-brace functions from dialog text. To keep from losing data, write
      these function calls with parentheses like the examples above.

      For full editor integration, you'd *probably* also need to paste this
      code at the end of the editor's `bitsy.js` file. Untested.
*/
(function (bitsy) {
'use strict';

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

bitsy = bitsy || /*#__PURE__*/_interopDefaultLegacy(bitsy);

/**
@file utils
@summary miscellaneous bitsy utilities
@author Sean S. LeBlanc
*/

/*
Helper used to replace code in a script tag based on a search regex
To inject code without erasing original string, using capturing groups; e.g.
	inject(/(some string)/,'injected before $1 injected after')
*/
function inject$1(searchRegex, replaceString) {
	// find the relevant script tag
	var scriptTags = document.getElementsByTagName('script');
	var scriptTag;
	var code;
	for (var i = 0; i < scriptTags.length; ++i) {
		scriptTag = scriptTags[i];
		var matchesSearch = scriptTag.textContent.search(searchRegex) !== -1;
		var isCurrentScript = scriptTag === document.currentScript;
		if (matchesSearch && !isCurrentScript) {
			code = scriptTag.textContent;
			break;
		}
	}

	// error-handling
	if (!code) {
		throw new Error('Couldn\'t find "' + searchRegex + '" in script tags');
	}

	// modify the content
	code = code.replace(searchRegex, replaceString);

	// replace the old script tag with a new one using our modified code
	var newScriptTag = document.createElement('script');
	newScriptTag.textContent = code;
	scriptTag.insertAdjacentElement('afterend', newScriptTag);
	scriptTag.remove();
}

/*
Helper for getting image by name or id

Args:
	name: id or name of image to return
	 map: map of images (e.g. `sprite`, `tile`, `item`)

Returns: the image in the given map with the given name/id
 */
function getImage(name, map) {
	var id = Object.prototype.hasOwnProperty.call(map, name) ? name : Object.keys(map).find(function (e) {
		return map[e].name === name;
	});
	return map[id];
}

/**
 * Helper for getting an array with unique elements
 * @param  {Array} array Original array
 * @return {Array}       Copy of array, excluding duplicates
 */
function unique(array) {
	return array.filter(function (item, idx) {
		return array.indexOf(item) === idx;
	});
}

/**

@file kitsy-script-toolkit
@summary makes it easier and cleaner to run code before and after Bitsy functions or to inject new code into Bitsy script tags
@license WTFPL (do WTF you want)
@requires Bitsy Version: 4.5, 4.6
@author @mildmojo

@description
HOW TO USE:
  import {before, after, inject, addDialogTag, addDeferredDialogTag} from "./helpers/kitsy-script-toolkit";

  before(targetFuncName, beforeFn);
  after(targetFuncName, afterFn);
  inject(searchRegex, replaceString);
  addDialogTag(tagName, dialogFn);
  addDeferredDialogTag(tagName, dialogFn);

  For more info, see the documentation at:
  https://github.com/seleb/bitsy-hacks/wiki/Coding-with-kitsy
*/

// Ex: inject(/(names.sprite.set\( name, id \);)/, '$1console.dir(names)');
function inject(searchRegex, replaceString) {
	var kitsy = kitsyInit();
	if (
		!kitsy.queuedInjectScripts.some(function (script) {
			return searchRegex.toString() === script.searchRegex.toString() && replaceString === script.replaceString;
		})
	) {
		kitsy.queuedInjectScripts.push({
			searchRegex: searchRegex,
			replaceString: replaceString,
		});
	} else {
		console.warn('Ignored duplicate inject');
	}
}

// Ex: before('load_game', function run() { alert('Loading!'); });
//     before('show_text', function run(text) { return text.toUpperCase(); });
//     before('show_text', function run(text, done) { done(text.toUpperCase()); });
function before(targetFuncName, beforeFn) {
	var kitsy = kitsyInit();
	kitsy.queuedBeforeScripts[targetFuncName] = kitsy.queuedBeforeScripts[targetFuncName] || [];
	kitsy.queuedBeforeScripts[targetFuncName].push(beforeFn);
}

// Ex: after('load_game', function run() { alert('Loaded!'); });
function after(targetFuncName, afterFn) {
	var kitsy = kitsyInit();
	kitsy.queuedAfterScripts[targetFuncName] = kitsy.queuedAfterScripts[targetFuncName] || [];
	kitsy.queuedAfterScripts[targetFuncName].push(afterFn);
}

function kitsyInit() {
	// return already-initialized kitsy
	if (bitsy.kitsy) {
		return bitsy.kitsy;
	}

	// Initialize kitsy
	bitsy.kitsy = {
		queuedInjectScripts: [],
		queuedBeforeScripts: {},
		queuedAfterScripts: {},
	};

	var oldStartFunc = bitsy.startExportedGame;
	bitsy.startExportedGame = function doAllInjections() {
		// Only do this once.
		bitsy.startExportedGame = oldStartFunc;

		// Rewrite scripts and hook everything up.
		doInjects();
		applyAllHooks();

		// Start the game
		bitsy.startExportedGame.apply(this, arguments);
	};

	return bitsy.kitsy;
}

function doInjects() {
	bitsy.kitsy.queuedInjectScripts.forEach(function (injectScript) {
		inject$1(injectScript.searchRegex, injectScript.replaceString);
	});
	reinitEngine();
}

function applyAllHooks() {
	var allHooks = unique(Object.keys(bitsy.kitsy.queuedBeforeScripts).concat(Object.keys(bitsy.kitsy.queuedAfterScripts)));
	allHooks.forEach(applyHook);
}

function applyHook(functionName) {
	var functionNameSegments = functionName.split('.');
	var obj = bitsy;
	while (functionNameSegments.length > 1) {
		obj = obj[functionNameSegments.shift()];
	}
	var lastSegment = functionNameSegments[0];
	var superFn = obj[lastSegment];
	var superFnLength = superFn ? superFn.length : 0;
	var functions = [];
	// start with befores
	functions = functions.concat(bitsy.kitsy.queuedBeforeScripts[functionName] || []);
	// then original
	if (superFn) {
		functions.push(superFn);
	}
	// then afters
	functions = functions.concat(bitsy.kitsy.queuedAfterScripts[functionName] || []);

	// overwrite original with one which will call each in order
	obj[lastSegment] = function () {
		var returnVal;
		var args = [].slice.call(arguments);
		var i = 0;

		function runBefore() {
			// All outta functions? Finish
			if (i === functions.length) {
				return returnVal;
			}

			// Update args if provided.
			if (arguments.length > 0) {
				args = [].slice.call(arguments);
			}

			if (functions[i].length > superFnLength) {
				// Assume funcs that accept more args than the original are
				// async and accept a callback as an additional argument.
				return functions[i++].apply(this, args.concat(runBefore.bind(this)));
			}
			// run synchronously
			returnVal = functions[i++].apply(this, args);
			if (returnVal && returnVal.length) {
				args = returnVal;
			}
			return runBefore.apply(this, args);
		}

		return runBefore.apply(this, arguments);
	};
}

function reinitEngine() {
	// recreate the script and dialog objects so that they'll be
	// referencing the code with injections instead of the original
	bitsy.scriptModule = new bitsy.Script();
	bitsy.scriptInterpreter = bitsy.scriptModule.CreateInterpreter();

	bitsy.dialogModule = new bitsy.Dialog();
	bitsy.dialogRenderer = bitsy.dialogModule.CreateRenderer();
	bitsy.dialogBuffer = bitsy.dialogModule.CreateBuffer();
}

// Rewrite custom functions' parentheses to curly braces for Bitsy's
// interpreter. Unescape escaped parentheticals, too.
function convertDialogTags(input, tag) {
	return input
		.replace(new RegExp('\\\\?\\((' + tag + '(\\s+(".*?"|.+?))?)\\\\?\\)', 'g'), function (match, group) {
			if (match.substr(0, 1) === '\\') {
				return '(' + group + ')'; // Rewrite \(tag "..."|...\) to (tag "..."|...)
			}
			return '{' + group + '}'; // Rewrite (tag "..."|...) to {tag "..."|...}
		});
}

function addDialogFunction(tag, fn) {
	var kitsy = kitsyInit();
	kitsy.dialogFunctions = kitsy.dialogFunctions || {};
	if (kitsy.dialogFunctions[tag]) {
		console.warn('The dialog function "' + tag + '" already exists.');
		return;
	}

	// Hook into game load and rewrite custom functions in game data to Bitsy format.
	before('parseWorld', function (gameData) {
		return [convertDialogTags(gameData, tag)];
	});

	kitsy.dialogFunctions[tag] = fn;
}

function injectDialogTag(tag, code) {
	inject(
		/(var functionMap = new Map\(\);[^]*?)(this.HasFunction)/m,
		'$1\nfunctionMap.set("' + tag + '", ' + code + ');\n$2',
	);
}

/**
 * Adds a custom dialog tag which executes the provided function.
 * For ease-of-use with the bitsy editor, tags can be written as
 * (tagname "parameters") in addition to the standard {tagname "parameters"}
 *
 * Function is executed immediately when the tag is reached.
 *
 * @param {string}   tag Name of tag
 * @param {Function} fn  Function to execute, with signature `function(environment, parameters, onReturn){}`
 *                       environment: provides access to SetVariable/GetVariable (among other things, see Environment in the bitsy source for more info)
 *                       parameters: array containing parameters as string in first element (i.e. `parameters[0]`)
 *                       onReturn: function to call with return value (just call `onReturn(null);` at the end of your function if your tag doesn't interact with the logic system)
 */
function addDialogTag(tag, fn) {
	addDialogFunction(tag, fn);
	injectDialogTag(tag, 'kitsy.dialogFunctions["' + tag + '"]');
}

/**
 * Adds a custom dialog tag which executes the provided function.
 * For ease-of-use with the bitsy editor, tags can be written as
 * (tagname "parameters") in addition to the standard {tagname "parameters"}
 *
 * Function is executed after the dialog box.
 *
 * @param {string}   tag Name of tag
 * @param {Function} fn  Function to execute, with signature `function(environment, parameters){}`
 *                       environment: provides access to SetVariable/GetVariable (among other things, see Environment in the bitsy source for more info)
 *                       parameters: array containing parameters as string in first element (i.e. `parameters[0]`)
 */
function addDeferredDialogTag(tag, fn) {
	addDialogFunction(tag, fn);
	bitsy.kitsy.deferredDialogFunctions = bitsy.kitsy.deferredDialogFunctions || {};
	var deferred = bitsy.kitsy.deferredDialogFunctions[tag] = [];
	injectDialogTag(tag, 'function(e, p, o){ kitsy.deferredDialogFunctions["' + tag + '"].push({e:e,p:p}); o(null); }');
	// Hook into the dialog finish event and execute the actual function
	after('onExitDialog', function () {
		while (deferred.length) {
			var args = deferred.shift();
			bitsy.kitsy.dialogFunctions[tag](args.e, args.p, args.o);
		}
	});
	// Hook into the game reset and make sure data gets cleared
	after('clearGameData', function () {
		deferred.length = 0;
	});
}

/**
 * Adds two custom dialog tags which execute the provided function,
 * one with the provided tagname executed after the dialog box,
 * and one suffixed with 'Now' executed immediately when the tag is reached.
 *
 * i.e. helper for the (exit)/(exitNow) pattern.
 *
 * @param {string}   tag Name of tag
 * @param {Function} fn  Function to execute, with signature `function(environment, parameters){}`
 *                       environment: provides access to SetVariable/GetVariable (among other things, see Environment in the bitsy source for more info)
 *                       parameters: array containing parameters as string in first element (i.e. `parameters[0]`)
 */
function addDualDialogTag(tag, fn) {
	addDialogTag(tag + 'Now', function (environment, parameters, onReturn) {
		fn(environment, parameters);
		onReturn(null);
	});
	addDeferredDialogTag(tag, fn);
}

/**
@file edit image at runtime
@summary API for updating image data at runtime.
@author Sean S. LeBlanc
@description
Adds API for updating sprite, tile, and item data at runtime.

Individual frames of image data in bitsy are 8x8 1-bit 2D arrays in yx order
e.g. the default player is:
[
	[0,0,0,1,1,0,0,0],
	[0,0,0,1,1,0,0,0],
	[0,0,0,1,1,0,0,0],
	[0,0,1,1,1,1,0,0],
	[0,1,1,1,1,1,1,0],
	[1,0,1,1,1,1,0,1],
	[0,0,1,0,0,1,0,0],
	[0,0,1,0,0,1,0,0]
]
*/

/*
Args:
	   id: string id or name
	frame: animation frame (0 or 1)
	  map: map of images (e.g. `sprite`, `tile`, `item`)

Returns: a single frame of a image data
*/
function getImageData(id, frame, map) {
	return bitsy.renderer.GetImageSource(getImage(id, map).drw)[frame];
}

/*
Updates a single frame of image data

Args:
	     id: string id or name
	  frame: animation frame (0 or 1)
	    map: map of images (e.g. `sprite`, `tile`, `item`)
	newData: new data to write to the image data
*/
function setImageData(id, frame, map, newData) {
	var drawing = getImage(id, map);
	var drw = drawing.drw;
	var img = bitsy.renderer.GetImageSource(drw).slice();
	img[frame] = newData;
	bitsy.renderer.SetImageSource(drw, img);
}



// map of maps
var maps;
after('load_game', function () {
	maps = {
		spr: bitsy.sprite,
		sprite: bitsy.sprite,
		til: bitsy.tile,
		tile: bitsy.tile,
		itm: bitsy.item,
		item: bitsy.item,
	};
});

function editImage(environment, parameters) {
	var i;

	// parse parameters
	var params = parameters[0].split(/,\s?/);
	params[0] = (params[0] || '').toLowerCase();
	var mapId = params[0];
	var tgtId = params[1];
	var srcId = params[2];

	if (!mapId || !tgtId || !srcId) {
		throw new Error('Image expects three parameters: "map, target, source", but received: "' + params.join(', ') + '"');
	}

	// get objects
	var mapObj = maps[mapId];
	if (!mapObj) {
		throw new Error('Invalid map "' + mapId + '". Try "SPR", "TIL", or "ITM" instead.');
	}
	var tgtObj = getImage(tgtId, mapObj);
	if (!tgtObj) {
		throw new Error('Target "' + tgtId + '" was not the id/name of a ' + mapId + '.');
	}
	var srcObj = getImage(srcId, mapObj);
	if (!srcObj) {
		throw new Error('Source "' + srcId + '" was not the id/name of a ' + mapId + '.');
	}

	// copy animation from target to source
	tgtObj.animation = {
		frameCount: srcObj.animation.frameCount,
		isAnimated: srcObj.animation.isAnimated,
		frameIndex: srcObj.animation.frameIndex,
	};
	for (i = 0; i < srcObj.animation.frameCount; ++i) {
		setImageData(tgtId, i, mapObj, getImageData(srcId, i, mapObj));
	}
}

function editPalette(environment, parameters) {
	// parse parameters
	var params = parameters[0].split(/,\s?/);
	params[0] = (params[0] || '').toLowerCase();
	var mapId = params[0];
	var tgtId = params[1];
	var palId = params[2];

	if (!mapId || !tgtId || !palId) {
		throw new Error('Image expects three parameters: "map, target, palette", but received: "' + params.join(', ') + '"');
	}

	// get objects
	var mapObj = maps[mapId];
	if (!mapObj) {
		throw new Error('Invalid map "' + mapId + '". Try "SPR", "TIL", or "ITM" instead.');
	}
	var tgtObj = getImage(tgtId, mapObj);
	if (!tgtObj) {
		throw new Error('Target "' + tgtId + '" was not the id/name of a ' + mapId + '.');
	}
	var palObj = parseInt(palId, 10);
	if (Number.isNaN(Number(palObj))) {
		throw new Error('Palette "' + palId + '" was not a number.');
	}

	// set palette
	tgtObj.col = palObj;
}

// hook up the dialog tags
addDualDialogTag('image', editImage);
addDualDialogTag('imagePal', editPalette);

}(window));

/**
🏁
@file transparent sprites
@summary makes all sprites have transparent backgrounds
@license MIT
@version 15.4.3
@requires Bitsy Version: 6.1
@author Sean S. LeBlanc

@description
Makes all sprites have transparent backgrounds.
i.e. tiles can be seen underneath the player, sprites, and items.

HOW TO USE:
1. Copy-paste this script into a script tag after the bitsy source
2. Edit hackOptions below as needed
*/
this.hacks = this.hacks || {};
(function (exports, bitsy) {
'use strict';
var hackOptions =  {
isTransparent: function (drawing) {
	// return drawing.name == 'tea'; // specific transparent drawing
	// return ['tea', 'flower', 'hat'].indexOf(drawing.name) !== -1; // specific transparent drawing list
	// return drawing.name && drawing.name.indexOf('TRANSPARENT') !== -1; // transparent drawing flag in name
	return true; // all drawings are transparent
},
} ;

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

bitsy = bitsy || /*#__PURE__*/_interopDefaultLegacy(bitsy);

/**
@file utils
@summary miscellaneous bitsy utilities
@author Sean S. LeBlanc
*/

/*
Helper used to replace code in a script tag based on a search regex
To inject code without erasing original string, using capturing groups; e.g.
	inject(/(some string)/,'injected before $1 injected after')
*/
function inject(searchRegex, replaceString) {
	// find the relevant script tag
	var scriptTags = document.getElementsByTagName('script');
	var scriptTag;
	var code;
	for (var i = 0; i < scriptTags.length; ++i) {
		scriptTag = scriptTags[i];
		var matchesSearch = scriptTag.textContent.search(searchRegex) !== -1;
		var isCurrentScript = scriptTag === document.currentScript;
		if (matchesSearch && !isCurrentScript) {
			code = scriptTag.textContent;
			break;
		}
	}

	// error-handling
	if (!code) {
		throw new Error('Couldn\'t find "' + searchRegex + '" in script tags');
	}

	// modify the content
	code = code.replace(searchRegex, replaceString);

	// replace the old script tag with a new one using our modified code
	var newScriptTag = document.createElement('script');
	newScriptTag.textContent = code;
	scriptTag.insertAdjacentElement('afterend', newScriptTag);
	scriptTag.remove();
}

/**
 * Helper for getting an array with unique elements
 * @param  {Array} array Original array
 * @return {Array}       Copy of array, excluding duplicates
 */
function unique(array) {
	return array.filter(function (item, idx) {
		return array.indexOf(item) === idx;
	});
}

/**

@file kitsy-script-toolkit
@summary makes it easier and cleaner to run code before and after Bitsy functions or to inject new code into Bitsy script tags
@license WTFPL (do WTF you want)
@requires Bitsy Version: 4.5, 4.6
@author @mildmojo

@description
HOW TO USE:
  import {before, after, inject, addDialogTag, addDeferredDialogTag} from "./helpers/kitsy-script-toolkit";

  before(targetFuncName, beforeFn);
  after(targetFuncName, afterFn);
  inject(searchRegex, replaceString);
  addDialogTag(tagName, dialogFn);
  addDeferredDialogTag(tagName, dialogFn);

  For more info, see the documentation at:
  https://github.com/seleb/bitsy-hacks/wiki/Coding-with-kitsy
*/

// Ex: before('load_game', function run() { alert('Loading!'); });
//     before('show_text', function run(text) { return text.toUpperCase(); });
//     before('show_text', function run(text, done) { done(text.toUpperCase()); });
function before(targetFuncName, beforeFn) {
	var kitsy = kitsyInit();
	kitsy.queuedBeforeScripts[targetFuncName] = kitsy.queuedBeforeScripts[targetFuncName] || [];
	kitsy.queuedBeforeScripts[targetFuncName].push(beforeFn);
}

function kitsyInit() {
	// return already-initialized kitsy
	if (bitsy.kitsy) {
		return bitsy.kitsy;
	}

	// Initialize kitsy
	bitsy.kitsy = {
		queuedInjectScripts: [],
		queuedBeforeScripts: {},
		queuedAfterScripts: {},
	};

	var oldStartFunc = bitsy.startExportedGame;
	bitsy.startExportedGame = function doAllInjections() {
		// Only do this once.
		bitsy.startExportedGame = oldStartFunc;

		// Rewrite scripts and hook everything up.
		doInjects();
		applyAllHooks();

		// Start the game
		bitsy.startExportedGame.apply(this, arguments);
	};

	return bitsy.kitsy;
}

function doInjects() {
	bitsy.kitsy.queuedInjectScripts.forEach(function (injectScript) {
		inject(injectScript.searchRegex, injectScript.replaceString);
	});
	reinitEngine();
}

function applyAllHooks() {
	var allHooks = unique(Object.keys(bitsy.kitsy.queuedBeforeScripts).concat(Object.keys(bitsy.kitsy.queuedAfterScripts)));
	allHooks.forEach(applyHook);
}

function applyHook(functionName) {
	var functionNameSegments = functionName.split('.');
	var obj = bitsy;
	while (functionNameSegments.length > 1) {
		obj = obj[functionNameSegments.shift()];
	}
	var lastSegment = functionNameSegments[0];
	var superFn = obj[lastSegment];
	var superFnLength = superFn ? superFn.length : 0;
	var functions = [];
	// start with befores
	functions = functions.concat(bitsy.kitsy.queuedBeforeScripts[functionName] || []);
	// then original
	if (superFn) {
		functions.push(superFn);
	}
	// then afters
	functions = functions.concat(bitsy.kitsy.queuedAfterScripts[functionName] || []);

	// overwrite original with one which will call each in order
	obj[lastSegment] = function () {
		var returnVal;
		var args = [].slice.call(arguments);
		var i = 0;

		function runBefore() {
			// All outta functions? Finish
			if (i === functions.length) {
				return returnVal;
			}

			// Update args if provided.
			if (arguments.length > 0) {
				args = [].slice.call(arguments);
			}

			if (functions[i].length > superFnLength) {
				// Assume funcs that accept more args than the original are
				// async and accept a callback as an additional argument.
				return functions[i++].apply(this, args.concat(runBefore.bind(this)));
			}
			// run synchronously
			returnVal = functions[i++].apply(this, args);
			if (returnVal && returnVal.length) {
				args = returnVal;
			}
			return runBefore.apply(this, args);
		}

		return runBefore.apply(this, arguments);
	};
}

function reinitEngine() {
	// recreate the script and dialog objects so that they'll be
	// referencing the code with injections instead of the original
	bitsy.scriptModule = new bitsy.Script();
	bitsy.scriptInterpreter = bitsy.scriptModule.CreateInterpreter();

	bitsy.dialogModule = new bitsy.Dialog();
	bitsy.dialogRenderer = bitsy.dialogModule.CreateRenderer();
	bitsy.dialogBuffer = bitsy.dialogModule.CreateBuffer();
}





var madeTransparent;
var makeTransparent;
before('onready', function () {
	madeTransparent = {};
	makeTransparent = false;
});
before('renderer.GetImage', function (drawing, paletteId, frameOverride) {
	// check cache first
	var cache = madeTransparent[drawing.drw] = madeTransparent[drawing.drw] || {};
	var p = cache[paletteId] = cache[paletteId] || {};
	var frameIndex = frameOverride || drawing.animation.frameIndex;
	var source = bitsy.renderer.GetImageSource(drawing.drw);
	if (p[frameIndex] === source) {
		// already made this transparent
		return;
	}

	// flag the next draw as needing to be made transparent
	p[frameIndex] = source;
	makeTransparent = hackOptions.isTransparent(drawing);
});

before('drawTile', function (canvas) {
	if (makeTransparent) {
		// redraw with all bg pixels transparent
		var ctx = canvas.getContext('2d');
		var data = ctx.getImageData(0, 0, canvas.width, canvas.height);
		var bg = bitsy.getPal(bitsy.getRoomPal(bitsy.player().room))[0];
		for (let i = 0; i < data.data.length; i += 4) {
			var r = data.data[i];
			var g = data.data[i + 1];
			var b = data.data[i + 2];
			if (r === bg[0] && g === bg[1] && b === bg[2]) {
				data.data[i + 3] = 0;
			}
		}
		ctx.putImageData(data, 0, 0);
		// clear the flag
		makeTransparent = false;
	}
});

exports.hackOptions = hackOptions;

Object.defineProperty(exports, '__esModule', { value: true });

}(this.hacks.transparent_sprites = this.hacks.transparent_sprites || {}, window));



</script>

<script type="text/javascript" id="borksyAdditionalJS">

</script>

</head>


<!-- DOCUMENT BODY -->
<body onload='startExportedGame()'>
<!-- GAME CANVAS -->
<div id="container">
<div id="innercontainer">
<canvas id='game'></canvas>
</div>
</div>
<div id="caption">If the game does not respond to keyboard/touch, you may need to click or tap in the box above first. On a touchscreen device, swipe in any direction to start.</div>
<div id="maintext">
<div id="description">
	<h1>Pathways, Desire Lines</h1>
	<h2>Emma Winston (e.winston@gold.ac.uk | <a href="https://emmawinston.me">emmawinston.me</a>)</h2>
	<p>"Pathways, Desire Lines" is an early prototype, and represents an attempt to condense some of the core findings and literature of my doctoral thesis into a minimalist and accessible multimedia form. I am in the final phases of researching the ukulele's "third wave" of popularity in the United Kingdom beginning at the turn of the new millennium. Many of my participants are, understandably, interested in my research -- as Barbara Kathleen Dennis (2014) puts it, "participants' praxis needs (are) not met when the loop of information or knowledge (is) not closed" -- but at times I find myself feeling overwhelmed at the task of trying to translate the ideas and narratives I am wrestling with into an accessible form. Translating everyday life into academic language is one thing; translating it back again is another.</p>
	<p>The game (really more of a series of spaces to explore; there are no high scores, and no competitive element, much like the musical pathways it describes) is, by its very nature, a reductive and incomplete meditation on my thesis findings, but I nonetheless hope it captures both some of my central ideas, and the sense of play and finding-out that has been present for me as a researcher throughout the project.</p>
	<p>This project does not reproduce any of my data as it will appear in the final thesis, both for reasons of participants' privacy, and to sidestep issues of data publication. In this piece I lean heavily on Annette Markham's method of "fabrication", which involves "creative, bricolage-style transfiguration of original data into composite accounts or representational interactions". Real experiences and findings have been combined, conflated, fictionalised and representatively adapted. This is also rather helpful in transforming the content of a 100,000 word document into a sub-5-minute game!</p>
	<p>Pathways, Desire Lines is built using the <a href="https://ledoux.itch.io/bitsy">Bitsy game engine</a>, a web application by Adam LeDoux designed for minimalist storytelling and exploration. Bitsy's constraints are, at times, extreme (by default, for instance, it allows only three colours per game -- I have hacked it here to introduce a fourth!), but its simplicity and limitations are often conducive to idea generation, and also mean that it does not require an understanding of coding or programming logic. In this respect, it seemed a fitting medium to convey some of the feel of a musical world in which accessibility is a primary affordance, and skill is often entirely decoupled from worth and meaning.</p>
	<p>If you experience any difficulties running the game on your device, try <a href="https://deerful.itch.io/pathways-desire-lines">this mirrored version.</p>
</div>
</body>


</html>